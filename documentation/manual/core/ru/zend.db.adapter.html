<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Zend_Db_Adapter - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.db.html">Zend_Db</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.db.html">Zend_Db</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.db.statement.html">Zend_Db_Statement</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.db.adapter" class="section"><div class="info"><h1 class="title">Zend_Db_Adapter</h1></div>

    

    <p class="para">
        Zend_Db и его родственные классы предоставляют простой интерфейс к базам
        данных SQL в Zend Framework. Zend_Db_Adapter является базовым классом,
        который должен использоваться для подключения приложения PHP
        к СУРБД. Существуют различные классы адаптеров для наиболее часто
        используемых СУРБД.
    </p>

    <p class="para">
        Адаптеры Zend_Db создают мост между общим интерфейсом и расширениями
        PHP от конкретных поставщиков для того, чтобы можно
        было единовременно писать приложения на PHP и затем переключаться между
        различными СУРБД с наименьшими усилиями.
    </p>

    <p class="para">
        Интерфейс класса адаптера подобен интерфейсу расширения
        <a href="http://www.php.net/pdo" class="link external">&raquo; PHP Data Objects (PDO)</a>.
        Zend_Db предоставляет классы адаптеров к драйверам PDO для следующих
        популярных СУРБД:
    </p>

    <ul class="itemizedlist">
        <li class="listitem">
            <p class="para">
                IBM DB2 и Informix Dynamic Server (IDS), с использованием
                расширения <a href="http://www.php.net/pdo-ibm" class="link external">&raquo; pdo_ibm</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                MySQL, с использованием расширения <a href="http://www.php.net/pdo-mysql" class="link external">&raquo; pdo_mysql</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Microsoft SQL Server, с использованием расширения <a href="http://www.php.net/pdo-mssql" class="link external">&raquo; pdo_mssql</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Oracle, с использованием расширения <a href="http://www.php.net/pdo-oci" class="link external">&raquo; pdo_oci</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                PostgreSQL, с использованием расширения <a href="http://www.php.net/pdo-pgsql" class="link external">&raquo; pdo_pgsql</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                SQLite, с использованием расширения <a href="http://www.php.net/pdo-sqlite" class="link external">&raquo; pdo_sqlite</a>
            </p>
        </li>
    </ul>

    <p class="para">
        Кроме этого, Zend_Db предоставляет классы адаптеров, использующие расширения PHP для следующих распространенных СУРБД:
    </p>

    <ul class="itemizedlist">
        <li class="listitem">
            <p class="para">
                MySQL, с использованием расширения <a href="http://www.php.net/mysqli" class="link external">&raquo; mysqli</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Oracle, с использованием расширения <a href="http://www.php.net/oci8" class="link external">&raquo; oci8</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                IBM DB2, с использованием расширения <a href="http://www.php.net/ibm_db2" class="link external">&raquo; ibm_db2</a>
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Firebird/Interbase, с использованием расширения <a href="http://www.php.net/ibase" class="link external">&raquo; php_interbase</a>
            </p>
        </li>
    </ul>

    <blockquote><p><b class="note">Note</b>: 
        
            Все адаптеры Zend_Db используют расширения PHP. Вы должны иметь
            включенным соответствующее расширение в вашей среде PHP для
            использования адаптера Zend_Db. Например, если вы используете
            какой-либо из адаптеров PDO Zend_Db, то нужно включить как
            расширение PDO, так и драйвер PDO для используемой вами СУРБД.
        <br />
    </p></blockquote>

    <div class="section" id="zend.db.adapter.connecting" name="zend.db.adapter.connecting"><div class="info"><h1 class="title">Соединение с БД с использованием адаптера</h1></div>

        

        <p class="para">
            Этот раздел описывает, как создавать экземпляр адаптера БД. Это
            соответствует созданию соединения с сервером СУРБД из вашего
            приложения PHP.
        </p>

        <div class="section" id="zend.db.adapter.connecting.constructor" name="zend.db.adapter.connecting.constructor"><div class="info"><h1 class="title">Использование конструктора адаптера Zend_Db</h1></div>

            

            <p class="para">
                Вы можете создавать экземпляр адаптера с помощью его
                конструктора. Конструктор адаптера принимает единственный
                аргумент, который является массивом параметров, использующихся
                для описания соединения.
            </p>

            <div class="example"><div class="info"><p><b>Example #1 Использование конструктора адаптера</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Db_Adapter_Pdo_Mysql<span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.connecting.factory" name="zend.db.adapter.connecting.factory"><div class="info"><h1 class="title">Использование фабрики Zend_Db</h1></div>

            

            <p class="para">
                Вместо непосредственного использования конструктора
                адаптера можно создавать экземпляры адаптера, применяя
                статический метод <code class="code">Zend_Db::factory()</code>. Этот метод
                динамически загружает файл класса адаптера, используя
                <a href="zend.loader.load.html#zend.loader.load.class" class="link">Zend_Loader::loadClass()</a>.
            </p>

            <p class="para">
                Первым аргументом является строка с базовым именем класса
                адаптера. Например, строка &#039;Pdo_Mysql&#039; соответствует классу
                Zend_Db_Adapter_Pdo_Mysql. Вторым аргументом является тот же
                массив параметров, который вы должны были бы передать
                конструктору адаптера.
            </p>

            <div class="example"><div class="info"><p><b>Example #2 Использование метода-фабрики адаптеров</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Нам не нужно использовать следующее предложение, поскольку</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// файл Zend_Db_Adapter_Pdo_Mysql будет загружен через</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// метод-фабрику Zend_Db</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// require_once 'Zend/Db/Adapter/Pdo/Mysql.php';</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Автоматически загружает класс Zend_Db_Adapter_Pdo_Mysql</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// и создает его экземпляр.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Если вы создали собственный класс, расширяющий
                Zend_Db_Adapter_Abstract, но не дали ему имя, начинающееся с
                префикса &quot;Zend_Db_Adapter&quot;, то можете использовать метод
                <code class="code">factory()</code> для загрузки своего адаптера, указав
                ведущую часть имени класса адаптера с помощью ключа
                &#039;adapterNamespace&#039; в массиве параметров.
            </p>

            <div class="example"><div class="info"><p><b>Example #3 Использование метода-фабрики для пользовательского класса адаптера</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Нам не нужно загружать файл с классом адаптера,</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// поскольку он будет загружен через метод-фабрику Zend_Db</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Автоматически загружает класс MyProject_Db_Adapter_Pdo_Mysql</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// и создает его экземпляр.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'adapterNamespace'</span> =&gt; <span style="color: #ff0000;">'MyProject_Db_Adapter'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.connecting.factory-config" name="zend.db.adapter.connecting.factory-config"><div class="info"><h1 class="title">Использование Zend_Config с фабрикой Zend_Db</h1></div>

            

            <p class="para">
                Опционально вы можете заменить оба аргумента метода
                <code class="code">factory()</code> объектом типа
                <a href="zend.config.html" class="link">Zend_Config</a>.
            </p>

            <p class="para">
                Если первым аргументом является объект конфигурации, то
                ожидается, что он имеет свойство с именем <code class="code">adapter</code>,
                содержащее строку с базовой частью имени класса адаптера.
                Опционально объект может содержать свойство с именем
                <code class="code">params</code> и &quot;подсвойствами&quot;, соответствующими
                параметрам адаптера.
            </p>

            <div class="example"><div class="info"><p><b>Example #4 Использование метода-фабрики адаптеров с объектом Zend_Config</b></p></div>
                
                <div class="example-contents"><p>
                    В примере ниже объект Zend_Config создан из массива. Вы
                    можете также загружать данные из внешнего файла с помощью
                    <a href="zend.config.adapters.ini.html" class="link">Zend_Config_Ini</a>
                    или <a href="zend.config.adapters.xml.html" class="link">Zend_Config_Xml</a>.
                </p></div>
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$config</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Config<span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'database'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'adapter'</span> =&gt; <span style="color: #ff0000;">'Mysqli'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'params'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span> =&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'secret'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$config</span>-&gt;<span style="color: #006600;">database</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Второй аргумент метода <code class="code">factory()</code> может быть
                ассоциативным массивом, содержащим элементы, которые
                соответствуют параметрам адаптера. Этот аргумент является
                опциональным. Если первым аргументом является объект типа
                Zend_Config, то предполагается, что он содержит все необходимые
                параметры, и второй аргумент игнорируется.
            </p>

        </div>

        <div class="section" id="zend.db.adapter.connecting.parameters" name="zend.db.adapter.connecting.parameters"><div class="info"><h1 class="title">Параметры адаптера</h1></div>

            

            <p class="para">
                Список ниже описывает общие параметры, которые распознаются
                классами адаптеров Zend_Db.
            </p>

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">host</em>:
                        строка, содержащая имя хоста или IP сервера БД. Если
                        база данных размещается на том же хосте, что и
                        приложение PHP, то вы можете использовать &#039;localhost&#039;
                        или &#039;127.0.0.1&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">username</em>:
                        идентификатор учетной записи для аутентификации подключения к серверу СУРБД.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">password</em>:
                        пароль  учетной записи для аутентификации подключения к
                        серверу СУРБД.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">dbname</em>:
                        имя экземпляра БД на сервере СУРБД.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">port</em>:
                        некоторые сервера СУРБД поддерживают сетевые соединения
                        через указанный администратором порт. Данный параметр
                        дает возможность задать порт, с которым приложение PHP
                        будет устанавливать соединение, он должен
                        соответствовать порту, установленному в сервере СУРБД.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">options</em>:
                        этот параметр является ассоциативным массивом опций,
                        общих для всех классов Zend_Db_Adapter.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">driver_options</em>:
                        этот параметр является ассоциативным массивом
                        дополнительных опций, специфических для данного
                        расширения. Одним из типичных случаев использования
                        этого параметра является установка атрибутов для
                        драйвера PDO.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">adapterNamespace</em>:
                        имя начальной части имени класса для адаптера вместо
                        &#039;Zend_Db_Adapter&#039;. Используйте его, если нужно
                        использовать метод <code class="code">factory()</code> для загрузки
                        &quot;неZend&#039;овского&quot; класса адаптера БД.
                    </p>
                </li>
            </ul>

            <div class="example"><div class="info"><p><b>Example #5 Передача фабрике опции перевода регистра (case-folding)</b></p></div>
                
                <div class="example-contents"><p>
                    Вы можете установить эту опцию посредством константы
                    <code class="code">Zend_Db::CASE_FOLDING</code>. Она соответствует
                    атрибуту <code class="code">ATTR_CASE</code> в драйверах PDO и IBM DB2, и
                    переводит строковые ключи в результатах запроса в требуемый
                    регистр. Эта опция принимает значения
                    <code class="code">Zend_Db::CASE_NATURAL</code> (значение по умолчанию),
                    <code class="code">Zend_Db::CASE_UPPER</code> и
                    <code class="code">Zend_Db::CASE_LOWER</code>.
                </p></div>
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$options</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Db::<span style="color: #006600;">CASE_FOLDING</span> =&gt; Zend_Db::<span style="color: #006600;">CASE_UPPER</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'options'</span>&nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #0000ff;">$options</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Db2'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <div class="example"><div class="info"><p><b>Example #6 Передача фабрике опции автоматического заключения в кавычки</b></p></div>
                
                <div class="example-contents"><p>
                    Вы можете задавать эту опцию через константу
                    <code class="code">Zend_Db::AUTO_QUOTE_IDENTIFIERS</code>. Если ее
                    значение установлено в <b><tt>TRUE</tt></b> (по умолчанию), то
                    идентификаторы, такие, как имена таблиц, имена столбцов и
                    даже псевдонимы, разграничиваются во всем генерируемом
                    объектом адаптера синтаксисе SQL. Это делает возможным
                    использование идентификаторов, содержащих ключевые слова SQL
                    и специальные символы. Если его значение равно
                    <b><tt>FALSE</tt></b>, то автоматическое заключение в кавычки
                    не производится. Если требуется заключение идентификаторов в
                    кавычки, то оно должно производиться самостоятельно с
                    использованием метода <code class="code">quoteIdentifier()</code>.
                </p></div>
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$options</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Db::<span style="color: #006600;">AUTO_QUOTE_IDENTIFIERS</span> =&gt; <span style="color: #000000; font-weight: bold;">false</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'options'</span>&nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #0000ff;">$options</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <div class="example"><div class="info"><p><b>Example #7 Передача фабрике опций драйвера PDO</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$pdoParams</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; PDO::<span style="color: #006600;">MYSQL_ATTR_USE_BUFFERED_QUERY</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'driver_options'</span> =&gt; <span style="color: #0000ff;">$pdoParams</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">getAttribute</span><span style="color: #66cc66;">&#40;</span>PDO::<span style="color: #006600;">MYSQL_ATTR_USE_BUFFERED_QUERY</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.connecting.getconnection" name="zend.db.adapter.connecting.getconnection"><div class="info"><h1 class="title">Управление отложенными соединениями</h1></div>
            

            <p class="para">
                Создание экземпляра класса адаптера не приведет к немедленному
                соединению с сервером СУРБД. Адаптер сохраняет параметры
                соединения и производит подключение, когда нужно произвести
                первый запрос к БД. Это значит, что само по себе создание
                объекта адаптера производится быстро и занимает мало ресурсов.
                Вы можете создавать экземпляр адаптера даже в том случае, если
                не уверены в том, что текущий запрос к вашему приложению
                требует каких-либо действий с БД.
            </p>

            <p class="para">
                Если нужно принудительно создать соединение с СУРБД, то
                используйте метод <code class="code">getConnection()</code>. Этот метод
                возвращает объект соединения в представлении соответствующего
                расширения PHP для баз данных. Например, если вы используете
                какой-либо класс адаптера для драйверов PDO, то
                <code class="code">getConnection()</code> возвращает объект PDO после того,
                как он будет инициирован им в качестве &quot;живого&quot; соединения с
                определенной БД.
            </p>

            <p class="para">
                Принудительное создание соединения может быть полезным, когда вы
                хотите отлавливать все исключения, которые бросаются из-за
                неправильных параметров доступа или других ошибок соединения с
                сервером СУРБД. Эти исключения не бросаются до тех пор, пока не
                создается соединение, поэтому можно упростить
                код приложения, обрабатывая исключения в одном
                месте вместо того, чтобы делать это каждый раз, когда
                производится первый запрос к БД.
            </p>

            <div class="example"><div class="info"><p><b>Example #8 Обработка исключений при соединении</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">try <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$parameters</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> catch <span style="color: #66cc66;">&#40;</span>Zend_Db_Adapter_Exception <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// возможно, неправильные параметры соединения или СУРБД не запущена</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> catch <span style="color: #66cc66;">&#40;</span>Zend_Exception <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// возможно, попытка загрузки требуемого класса адаптера потерпела неудачу</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

            </div>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.example-database" name="zend.db.adapter.example-database"><div class="info"><h1 class="title">Пример базы данных</h1></div>

        

        <p class="para">
            В документации к классам Zend_Db мы использовали набор простых
            таблиц для того, чтобы проиллюстрировать использование классов и их
            методов. Эти таблицы должны были хранить информацию для отслеживания
            ошибок в проекте разработки ПО. База данных содержит четыре таблицы:
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">accounts</em> (учетные записи)
                    хранит информацию о всех пользователях системы отслеживания
                    ошибок.
                </p>
            </li>
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">products</em> (продукты)
                    хранит информацию обо всех программных продуктах, для
                    которых могут отслеживаться ошибки.
                </p>
            </li>
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">bugs</em> (ошибки) хранит
                    информацию об ошибках, включая текущее состояние ошибки,
                    лицо, сообщившее об ошибке, лицо, которому назначено
                    устранение ошибки и лицо, которому назначена проверка
                    устранения ошибки.
                </p>
            </li>
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">bugs_products</em> хранит
                    связи между ошибками и продуктами. Она реализует связь
                    &quot;многие-ко-многим&quot;, потому что одна ошибка может относиться
                    к нескольким продуктам, и один продукт может иметь множество
                    ошибок.
                </p>
            </li>
        </ul>

        <p class="para">
            Следующий псевдокод для определения данных SQL описывает таблицы в
            этой базе данных. Это таблицы интенсивно используются в unit-тестах
            для Zend_Db.
        </p>

        <div class="programlisting sql"><div class="sqlcode"><div class="sql" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> accounts <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; account_name&nbsp; &nbsp; &nbsp; VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> products <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; product_id&nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; product_name&nbsp; &nbsp; &nbsp; VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> bugs <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_description&nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_status&nbsp; &nbsp; &nbsp; &nbsp; VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">20</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; reported_by&nbsp; &nbsp; &nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> accounts<span style="color: #66cc66;">&#40;</span>account_name<span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; assigned_to&nbsp; &nbsp; &nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> accounts<span style="color: #66cc66;">&#40;</span>account_name<span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; verified_by&nbsp; &nbsp; &nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> accounts<span style="color: #66cc66;">&#40;</span>account_name<span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> bugs_products <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> bugs,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; product_id&nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> products,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span>&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">&#40;</span>bug_id, product_id<span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            Также обратите внимание, что таблица <code class="code">bugs</code> содержит
            несколько внешних ключей, ссылающихся на таблицу
            <code class="code">accounts</code>. Для одной ошибки эти внешние ключи могут
            ссылаться на разные строки в таблице <code class="code">accounts</code>.
        </p>

        <p class="para">
            Диаграмма ниже иллюстрирует физическую модель данных для этой базы
            данных.
        </p>

        <p class="para">
            <div class="inlinemediaobject"><div class="imageobject"><img src="images/d481d625821a97b9a5eb2cec99dca50e-zend.db.adapter.example-database.png" alt="zend.db.adapter.example-database.png" width="387" height="302" /></div></div>
        </p>

    </div>

    <div class="section" id="zend.db.adapter.select" name="zend.db.adapter.select"><div class="info"><h1 class="title">Чтение результатов запроса</h1></div>

        

        <p class="para">
            Этот раздел описывает методы класса адаптера, с помощью которых вы
            можете производить запросы SELECT и извлекать их результаты.
        </p>

        <div class="section" id="zend.db.adapter.select.fetchall" name="zend.db.adapter.select.fetchall"><div class="info"><h1 class="title">Извлечение полного набора результатов</h1></div>

            

            <p class="para">
                Вы можете запустить запрос SELECT и извлечь его результаты за
                один шаг, используя метод <code class="code">fetchAll()</code>.
            </p>

            <p class="para">
                Первым аргументом этого метода должна быть строка, содержащая
                оператор SELECT. Также первым аргументом может быть объект
                класса <a href="zend.db.select.html" class="link">Zend_Db_Select</a>.
                Адаптер автоматически преобразует этот объект в строковое
                представление оператора SELECT.
            </p>

            <p class="para">
                Вторым аргументом <code class="code">fetchAll()</code> должен быть массив
                значений для подстановки вместо меток заполнения (placeholders)
                в операторе SQL.
            </p>

            <div class="example"><div class="info"><p><b>Example #9 Использование fetchAll()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = ?'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchAll</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$sql</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetch-mode" name="zend.db.adapter.select.fetch-mode"><div class="info"><h1 class="title">Изменение режима извлечения</h1></div>

            

            <p class="para">
                По умолчанию <code class="code">fetchAll()</code> возвращает массив строк,
                каждая из которых представлена ассоциативным
                массивом. Ключами ассоциативных массивов являются имена столбцов
                или псевдонимы столбцов, определенные в данном запросе на
                выборку.
            </p>

            <p class="para">
                Вы можете задать другой стиль извлечения результатов, используя
                метод <code class="code">setFetchMode()</code>. Поддерживаемые режимы
                идентифицируются константами:
            </p>

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_ASSOC</em>:
                        возвращает данные в массиве ассоциативных массивов.
                        Ключами массива являются имена столбцов в виде строк.
                        Это режим извлечения, используемый по умолчанию в
                        классах Zend_Db_Adapter.
                    </p>
                    <p class="para">
                        Обратите внимание, что если ваш список выборки содержит
                        столбцы с одинаковыми именами, например, если они из
                        разных таблиц в JOIN-е, то в ассоциативном массиве может
                        быть только одна запись для этого имени. Если вы
                        используете режим FETCH_ASSOC, то должны задавать
                        псевдонимы столбцов в своем запросе SELECT для того,
                        чтобы для всех столбцов были свои уникальные ключи.
                    </p>
                    <p class="para">
                        По умолчанию эти строки возвращаются так же, как если бы
                        они были возвращены драйвером БД. Как правило, это
                        синтаксис столбцов для данного сервера СУРБД. Вы можете
                        задать регистр для этих строк, используя опцию.
                        <code class="code">Zend_Db::CASE_FOLDING</code>. Задавайте его во
                        время инстанцирования адаптера. См.
                        <a href="zend.db.adapter.html#zend.db.adapter.connecting.parameters.example1" class="xref">Передача фабрике опции перевода регистра (case-folding)</a>.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_NUM</em>:
                        возвращает данные в массиве массивов. Массив
                        индексируется целочисленными значениями в соответствии с
                        позицией данного поля в списке выборки запроса.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_BOTH</em>:
                        возвращает данные в массиве массивов. Ключами массива
                        являются как строки, так и целочисленные значения. Число
                        элементов в массиве получается в два раза больше, чем
                        если бы использовались FETCH_ASSOC или FETCH_NUM.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_COLUMN</em>:
                        возвращает данные в массиве значений. Значение в каждом
                        массиве является значением, возвращенным из одного
                        столбца результата выборки. По умолчанию это первый
                        столбец, индексированный нулем.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_OBJ</em>:
                        возвращает данные в массиве объектов. По умолчанию
                        используется встроенный в PHP класс stdClass. Столбцы
                        результата выборки доступны в качестве открытых свойств
                        этого объекта.
                    </p>
                </li>
            </ul>

            <div class="example"><div class="info"><p><b>Example #10 Использование setFetchMode()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchAll</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = ?'</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// $result является массивом объектов</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>-&gt;<span style="color: #006600;">bug_description</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetchassoc" name="zend.db.adapter.select.fetchassoc"><div class="info"><h1 class="title">Извлечение результатов выборки в виде ассоциативного массива</h1></div>

            

            <p class="para">
                Метод <code class="code">fetchAssoc()</code> возвращает данные в массиве
                ассоциативных массивов безотносительно того, какое значение вы
                установили для режима извлечения.
            </p>

            <div class="example"><div class="info"><p><b>Example #11 Использование fetchAssoc()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchAssoc</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = ?'</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// $result является массивом ассоциативных массивов, независимо</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// от установленного режима извлечения</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">'bug_description'</span><span style="color: #66cc66;">&#93;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetchcol" name="zend.db.adapter.select.fetchcol"><div class="info"><h1 class="title">Извлечение единственного столбца из результатов выборки</h1></div>

            

            <p class="para">
                Метод <code class="code">fetchCol()</code> возвращает данные в массиве
                значений безотносительно того, какое значение вы
                установили для режима извлечения. Он возвращает только первый
                столбец из возвращенных запросом. Все остальные столбцы,
                возвращенные запросом, не учитываются. Если вам нужно извлечь
                столбец, отличный от первого, то см.
                <a href="zend.db.statement.html#zend.db.statement.fetching.fetchcolumn" class="xref">Извлечение одного столбца из набора результатов</a>.
            </p>

            <div class="example"><div class="info"><p><b>Example #12 Использование fetchCol()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchCol</span><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'SELECT bug_description, bug_id FROM bugs WHERE bug_id = ?'</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// содержит bug_description; bug_id не возвращается</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetchpairs" name="zend.db.adapter.select.fetchpairs"><div class="info"><h1 class="title">Извлечение пар ключ-значение из результатов выборки</h1></div>

            

            <p class="para">
                Метод <code class="code">fetchPairs()</code> возвращает данные в массиве пар
                ключ-значение,
                Ключ ассоциативного массива берется из первого столбца,
                возвращенного запросом SELECT. Значение берется из второго
                столбца, возвращенного запросом SELECT. Все остальные столбцы,
                возвращенные запросом, не учитываются.
            </p>

            <p class="para">
                Вы должны строить запрос SELECT так, чтобы первый из
                возвращенных столбцов имел уникальные значения. Если в нем
                имеются повторяющиеся значения, то записи в ассоциативном
                массиве будут перезаписываться.
            </p>

            <div class="example"><div class="info"><p><b>Example #13 Использование fetchPairs()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchPairs</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT bug_id, bug_status FROM bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#93;</span>;</div></li></ol></div></div></div>

            </div>
        </div>

        <div class="section" id="zend.db.adapter.select.fetchrow" name="zend.db.adapter.select.fetchrow"><div class="info"><h1 class="title">Извлечение единственной строки из результатов выборки</h1></div>

            

            <p class="para">
                Метод <code class="code">fetchRow()</code> возвращает данные с использованием
                текущего режима извлечения, но возвращает только первую строку
                из результатов выборки.
            </p>

            <div class="example"><div class="info"><p><b>Example #14 Использование fetchRow()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = 2'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// обратите внимание, что $result - единственный объект, а не массив объектов</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span>-&gt;<span style="color: #006600;">bug_description</span>;</div></li></ol></div></div></div>

            </div>
        </div>

        <div class="section" id="zend.db.adapter.select.fetchone" name="zend.db.adapter.select.fetchone"><div class="info"><h1 class="title">Извлечение единственного скалярного значения из результатов выборки</h1></div>

            

            <p class="para">
                Метод <code class="code">fetchOne()</code> является как бы комбинацией
                методов <code class="code">fetchRow()</code> и <code class="code">fetchCol()</code> - он
                возвращает значение первого столбца в первой строке из
                результатов выборки. Таким образом, он возвращает одно скалярное
                значение, а не массив или объект.
            </p>

            <div class="example"><div class="info"><p><b>Example #15 Использование fetchOne()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchOne</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT bug_status FROM bugs WHERE bug_id = 2'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// это единственное строковое значение</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span>;</div></li></ol></div></div></div>

            </div>
        </div>

    </div>

    <div class="section" id="zend.db.adapter.write" name="zend.db.adapter.write"><div class="info"><h1 class="title">Изменение данных в БД</h1></div>

        

        <p class="para">
            Вы можете использовать класс адаптера для добавления новых данных
            или изменения существующих в своей базе данных. В данном разделе
            описываются методы для произведения этих операций.
        </p>

        <div class="section" id="zend.db.adapter.write.insert" name="zend.db.adapter.write.insert"><div class="info"><h1 class="title">Добавление данных</h1></div>

            

            <p class="para">
                Вы можете добавлять новые строки в таблицы в своей базе данных,
                используя метод  <code class="code">insert()</code>. Первым аргументом этого
                метода является строка с именем таблицы, а вторым аргументом -
                ассоциативный массив с именами столбцов и соответствующими им
                значениями.
            </p>

            <div class="example"><div class="info"><p><b>Example #16 Добавление в таблицу</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'created_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-22'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_description'</span> =&gt; <span style="color: #ff0000;">'Something wrong'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'NEW'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Те столбцы, которые не были включены в массив данных, не
                передаются базе данных. Таким образом, они следуют тем же
                правилам, что и SQL-оператор INSERT: если столбец имеет
                предложение DEFAULT, то он принимает это значение в созданной
                строке, иначе остается в состоянии NULL.
            </p>

            <p class="para">
                По умолчанию значения в вашем массиве данных добавляются с
                использованием параметров. Это сокращает некоторые риски
                безопасности. Вам не нужно будет применять к значениям в массиве
                данных такие действия, как взятие в кавычки или экранирование.
            </p>

            <p class="para">
                Иногда бывает необходимо, чтобы часть значений в массиве данных
                трактовалась как SQL-выражения, в этом случае они не должны
                заключаться в кавычки. По умолчанию все данные, переданные в
                виде строк, трактуются как строковые литералы. Для того, чтобы
                указать, что данное значение является SQL-выражением (а
                значит, не должно заключаться в кавычки), передавайте его в
                массиве данных в виде объекта типа Zend_Db_Expr вместо простой
                строки.
            </p>

            <div class="example"><div class="info"><p><b>Example #17 Добавление выражений в таблицу</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'created_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #000000; font-weight: bold;">new</span> Zend_Db_Expr<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'CURDATE()'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_description'</span> =&gt; <span style="color: #ff0000;">'Something wrong'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'NEW'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.write.lastinsertid" name="zend.db.adapter.write.lastinsertid"><div class="info"><h1 class="title">Получение сгенерированного значения</h1></div>

            

            <p class="para">
                Некоторые СУРБД поддерживают автоинкремент первичных ключей.
                Таблица, описанная определенным образом, автоматически
                генерирует значение первичного ключа во время добавления новой
                строки.
                Возвращаемое методом <code class="code">insert()</code> значение
                <em class="emphasis">не</em> является последним добавленным
                идентификатором, потому что таблица может не иметь
                автоинкрементных столбцов. Вместо этого возвращаемое
                значение является количеством затронутых строк (обычно 1).
            </p>

            <p class="para">
                Если ваша таблица определена с автоинкрементным первичным
                ключом, то вы можете вызывать метод <code class="code">lastInsertId()</code>
                после добавления. Этот метод возвращает последнее значение,
                сгенерированное в области видимости текущего соединения с БД.
            </p>

            <div class="example"><div class="info"><p><b>Example #18 Использование lastInsertId() для автоинкрементного ключа</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// возвращает последнее значение, сгенерированное автоинкрементным столбцом</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastInsertId</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Некоторые СУРБД поддерживают объекты последовательностей
                (sequence object), которые генерируют уникальные значения для
                использования в качестве значений первичных ключей. Для
                поддержки последовательностей <code class="code">lastInsertId()</code>
                принимает два необязательных строковых аргумента. Эти аргументы
                служат для передачи имен таблицы и столбца, при этом
                предполагается, что вы следуете соглашению, по которому имя
                последовательности состоит из имен таблицы и столбца, для
                которых эта последовательность генерирует значения, и суффикса
                &quot;_seq&quot;. Это соглашение основано на используемом системой
                PostgreSQL при именовании последовательностей для столбцов
                SERIAL. Например, таблица &quot;bugs&quot; с первичным ключом &quot;bug_id&quot;
                должна использовать последовательность с именем
                &quot;bugs_bug_id_seq&quot;.
            </p>

            <div class="example"><div class="info"><p><b>Example #19 Использование lastInsertId() для последовательности</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// возвращает последнее значение, сгенерированное</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// последовательностью 'bugs_bug_id_seq'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastInsertId</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #ff0000;">'bug_id'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// альтернативно, возвращает последнее значение, сгенерированное</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// последовательностью 'bugs_seq'.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastInsertId</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Если имя вашего объекта последовательности не следует этому
                соглашению по именованию, то используйте метод
                <code class="code">lastSequenceId()</code>. Этот метод принимает один
                строковой аргумент, через который передается точное имя
                последовательности
            </p>

            <div class="example"><div class="info"><p><b>Example #20 Использование lastSequenceId()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// возвращает последнее значение, сгенерированное</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// последовательностью 'bugs_id_gen'.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastSequenceId</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs_id_gen'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Для тех СУРБД, которые не поддерживают последовательности,
                включая MySQL, Microsoft SQL Server и SQLite, аргументы метода
                lastInsertId() игнорируются, и возвращается самое последнее
                значение, сгенерированное для любой таблицы через оператор
                INSERT в течение данного соединения. Для этих типов СУРБД метод
                lastSequenceId() всегда будет возвращать <b><tt>NULL</tt></b>.
            </p>

            <blockquote><p><b class="note">Note</b>: <span class="info"><b>Почему не используется &quot;SELECT MAX(id) FROM table&quot;?</b><br /></span>
                
                
                    Иногда этот запрос возвращает последнее значение первичного
                    ключа, добавленное в таблицу. Однако этот способ небезопасен
                    в условиях, когда несколько клиентов добавляют записи в базу
                    данных. Может случиться (и должно происходить в конечном
                    итоге) так, что другой клиент добавляет другую строку в
                    короткий промежуток времени между добавлением строки,
                    производимым вашим приложением-клиентом БД, и вашим запросом
                    для получения значения MAX(id). Таким образом, это
                    возвращаемое значение не будет соответствовать добавленной
                    вами строке, вместо этого оно будет соответствовать строке,
                    добавленной другим клиентом. Нет способа определить,
                    когда это происходит.
                <br />
                
                    Использование высокого уровня изоляции транзакций, такого,
                    как &quot;repeatable read&quot;, может уменьшить этот риск, но
                    некоторые СУРБД не поддерживают требуемую для этого изоляцию
                    транзакций, либо намеренно используется более низкий уровень
                    изоляции транзакций в приложении.
                <br />
                
                    Использование выражения наподобие &quot;MAX(id)+1&quot; для генерации
                    нового значения первичного ключа тоже небезопасно, так как
                    два клиента могут сделать этот запрос одновременно, и оба
                    будут использовать одно и то же полученное значение для
                    своей последующей операции INSERT.
                <br />
                
                    Все СУРБД предоставляют механизмы для генерации уникальных
                    значений и возвращения последних сгенерированных значений.
                    Эти механизмы работают вне области видимости транзакций,
                    поэтому нет вероятности того, что оба клиента сгенерируют
                    одно и то же значение, или что значение, сгенерированное
                    другим клиентом, будет возвращено вашему клиенту как
                    последнее сгенерированное им в его соединении.
                <br />
            </p></blockquote>

        </div>

        <div class="section" id="zend.db.adapter.write.update" name="zend.db.adapter.write.update"><div class="info"><h1 class="title">Обновление данных</h1></div>
            

            <p class="para">
                Вы можете обновлять строки в таблице БД, используя метод
                <code class="code">update()</code> адаптера. Этот метод принимает три
                аргумента: первый является имением таблицы, второй -
                ассоциативным массивом столбцов, которые требуется изменить, и
                значений, которые требуется присвоить этим столбцам.
            </p>

            <p class="para">
                Значения в массиве данных интерпретируются как строковые
                константы. Информацию об использовании выражений SQL в массиве
                данных см. в разделе
                <a href="zend.db.adapter.html#zend.db.adapter.write.insert" class="xref">Добавление данных</a>.
            </p>

            <p class="para">
                Третий аргумент является строкой, содержащей выражение SQL,
                которое используется в качестве условия, при выполнении которого
                строка должна изменяться. Значения и идентификаторы в этом
                аргументе не заключаются в кавычки и не экранируются. Вы
                ответственны за то, чтобы все динамическое содержимое было
                безопасным образом включено в эту строку. Информацию о методах,
                которые помогут вам в этом, см. в разделе
                <a href="zend.db.adapter.html#zend.db.adapter.quoting" class="xref">Заключение в кавычки значений и идентификаторов</a>.
            </p>

            <p class="para">
                Возвращаемое значение является числом строк, затронутых в
                операции обновления.
            </p>

            <div class="example"><div class="info"><p><b>Example #21 Обновление строк</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'updated_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-23'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">update</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span>, <span style="color: #ff0000;">'bug_id = 2'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Если вы опустите третий аргумент, то все строки в таблице БД
                будут обновлены со значениями, указанными в массиве данных.
            </p>

            <p class="para">
                Если вы передадите массив строк в качестве третьего аргумента,
                то эти строки будут объединены как термы выражения, разделенные
                операторами <code class="code">AND</code>.
            </p>

            <div class="example"><div class="info"><p><b>Example #22 Обновление строк с использованием массива выражений</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'updated_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-23'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">&quot;reported_by = 'goofy'&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">&quot;bug_status = 'OPEN'&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">update</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span>, <span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Результирующий SQL:</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; UPDATE &quot;bugs&quot; SET &quot;update_on&quot; = '2007-03-23', &quot;bug_status&quot; = 'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; WHERE (&quot;reported_by&quot; = 'goofy') AND (&quot;bug_status&quot; = 'OPEN')</span></div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.write.delete" name="zend.db.adapter.write.delete"><div class="info"><h1 class="title">Удаление данных</h1></div>
            
            <p class="para">
                Вы можете удалять строки из таблицы БД, используя метод
                <code class="code">delete()</code>. Этот метод принимает два аргумента,
                первый из них является строкой с именем таблицы.
            </p>

            <p class="para">
                Второй аргумент является строкой, содержащей выражение SQL,
                который используется в качестве условия, при выполнении которого
                строка удаляется. Значения и идентификаторы в этом аргументе не
                заключаются в кавычки и не экранируются. Вы ответственны за то,
                чтобы весь динамический контент был безопасным образом включен в
                эту строку. Информацию о методах, которые помогут вам в этом,
                см. в разделе <a href="zend.db.adapter.html#zend.db.adapter.quoting" class="xref">Заключение в кавычки значений и идентификаторов</a>.
            </p>

            <p class="para">
                Возвращаемое значение является числом строк, задействованных в
                операции удаления.
            </p>

            <div class="example"><div class="info"><p><b>Example #23 Удаление строк</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">delete</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #ff0000;">'bug_id = 3'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Если вы опустите второй аргумент, то в результате
                все строки в таблице БД будут удалены.
            </p>

            <p class="para">
                Если вы передадите массив строк в качестве второго аргумента, то
                эти строки будут объединены как термы выражения, разделенные
                операторами <code class="code">AND</code>.
            </p>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.quoting" name="zend.db.adapter.quoting"><div class="info"><h1 class="title">Заключение в кавычки значений и идентификаторов</h1></div>

        

        <p class="para">
            При построении запросов SQL часто требуется включить значения
            переменных PHP в выражения SQL. Это несет в себе дополнительный
            риск, потому что если значение в строке PHP содержит определенные
            символы, такие, как символы кавычек, то в результате может
            получиться недопустимый код SQL. Например, обратите внимание на
            несоответствие кавычек в следующем запросе:
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$name</span> = <span style="color: #ff0000;">&quot;O'Reilly&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE reported_by = '$name'&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 'O'Reilly'</span></div></li></ol></div></div></div>

        </p>

        <p class="para">
            Еще серьезнее риск того, что такие ошибки в коде могут быть
            целенаправленно использованы тем, кто пытается получить управление
            вашим веб-приложением. Если он может указать значение переменной
            PHP, используя параметры HTTP или другой механизм, то может
            заставить ваши SQL-запросы выполнять действия, для которых они не
            предназначены - например, возвращение данных, на чтение которых лицо
            не имеет прав. Это серьезное и широко распространенное нарушение
            безопасности приложения, известное под названием &quot;SQL-инъекции&quot;
            (см. <a href="http://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%8A%D0%B5%D0%BA%D1%86%D0%B8%D1%8F_SQL" class="link external">&raquo; http://ru.wikipedia.org/wiki/Инъекция_SQL</a>).
        </p>

        <p class="para">
            Класс адаптера Zend_Db предоставляет удобные функции для того, чтобы
            уменьшить уязвимость приложения к SQL-инъекциям. Решение
            состоит в том, чтобы экранировать специальные символы, такие, как
            кавычки в значениях PHP, до того, как они будут включены в строки
            запросов SQL. Это защищает как от случайных, так и от
            целенаправленных манипуляций строками SQL через переменные PHP,
            содержащие специальные символы.
        </p>

        <div class="section" id="zend.db.adapter.quoting.quote" name="zend.db.adapter.quoting.quote"><div class="info"><h1 class="title">Использование <code class="code">quote()</code></h1></div>

            

            <p class="para">
                Метод <code class="code">quote()</code> принимает единственный аргумент -
                скалярное строковое значение. Он возвращает значение с
                специальными символами, экранированными соответствующим образом
                для используемой вами СУРБД, и окруженным ограничителями
                строковых значений. Стандартным ограничителем строковых значений
                в SQL является одинарная кавычка (<code class="code">&#039;</code>).
            </p>

            <div class="example"><div class="info"><p><b>Example #24 Использование quote()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$name</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quote</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;O'Reilly&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$name</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 'O\'Reilly'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE reported_by = $name&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 'O\'Reilly'</span></div></li></ol></div></div></div>

            </div>

            <p class="para">
                Обратите внимание, что возвращаемое методом <code class="code">quote()</code>
                значение включает в себя окружающие кавычки. Этим
                метод отличается от некоторых функций, которые экранируют
                специальные символы, но не добавляют кавычки, например,
                <a href="http://www.php.net/mysqli_real_escape_string" class="link external">&raquo; mysql_real_escape_string()</a>.
            </p>

            <p class="para">
                Данные могут требовать или не требовать заключения в кавычки в
                зависимости от того, в каком контексте типа данных SQL они
                используются. Например, в некоторых СУРБД целочисленное
                значение не должно заключаться в кавычки, если оно
                сравнивается со столбцом или выражением целочисленного типа.
                Другими словами, следующий запрос является ошибочным в некоторых
                реализациях SQL, если столбец <code class="code">intColumn</code> имеет
                целочисленный тип данных <code class="code">INTEGER</code>.

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">SELECT * FROM atable WHERE intColumn = <span style="color: #ff0000;">'123'</span></div></li></ol></div></div></div>

            </p>

            <p class="para">
                Вы можете использовать необязательный второй аргумент метода
                <code class="code">quote()</code> для избирательного заключения в кавычки
                тех типов данных SQL, которые вы укажете.
            </p>

            <div class="example"><div class="info"><p><b>Example #25 Использование quote() с указанием типа SQL</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$value</span> = <span style="color: #ff0000;">'1234'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">'SELECT * FROM atable WHERE intColumn = '</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp;. <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quote</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$value</span>, <span style="color: #ff0000;">'INTEGER'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                Каждый класс Zend_Db_Adapter имеет закодированные имена типов
                данных SQL для соответствующих СУРБД. Вы можете также
                использовать константы <code class="code">Zend_Db::INT_TYPE</code>,
                <code class="code">Zend_Db::BIGINT_TYPE</code> и
                <code class="code">Zend_Db::FLOAT_TYPE</code> для написания еще более
                независимого от типа используемой СУРБД кода.
            </p>

            <p class="para">
                Zend_Db_Table автоматически указывает типы SQL для метода
                <code class="code">quote()</code> при генерации SQL-запросов, ссылающихся на
                ключевые столбцы таблицы.
            </p>

        </div>

        <div class="section" id="zend.db.adapter.quoting.quote-into" name="zend.db.adapter.quoting.quote-into"><div class="info"><h1 class="title">Использование <code class="code">quoteInto()</code></h1></div>

            

            <p class="para">
                Наиболее типичным случаем использования операции заключения в
                кавычки является добавление переменной PHP в выражение или
                оператор SQL. Вы можете использовать метод
                <code class="code">quoteInto()</code> для того, чтобы выполнить это за один
                шаг. Этот метод принимает два аргумента: первый аргумент
                является строкой, содержащей символ метки заполнения
                (<code class="code">?</code>), а второй аргумент - значением или
                переменной PHP, которая должна быть подставлена вместо этой
                метки заполнения.
            </p>

            <p class="para">
                Символ метки заполнения одинаковый в многих СУРБД для
                позиционных параметров, но метод <code class="code">quoteInto()</code> только
                эмулирует параметры запроса. Этот метод просто добавляет
                значение в строку, экранируя специальные символы и заключая его
                в кавычки. В случае настоящих параметров запроса сохраняется
                разделение между строкой SQL и параметрами, поскольку строка
                запроса анализируется сервером СУРБД.
            </p>

            <div class="example"><div class="info"><p><b>Example #26 Использование quoteInto()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quoteInto</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE reported_by = ?&quot;</span>, <span style="color: #ff0000;">&quot;O'Reilly&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 'O\'Reilly'</span></div></li></ol></div></div></div>

            </div>

            <p class="para">
                Вы можете использовать опциональный третий параметр метода
                <code class="code">quoteInto()</code> для указания типа данных SQL. Числовые
                типы данных не заключаются в кавычки, остальные заключаются.
            </p>

            <div class="example"><div class="info"><p><b>Example #27 Использование quoteInto() с указанием типа SQL</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quoteInto</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE bug_id = ?&quot;</span>, <span style="color: #ff0000;">'1234'</span>, <span style="color: #ff0000;">'INTEGER'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 1234</span></div></li></ol></div></div></div>

            </div>

        </div>
        <div class="section" id="zend.db.adapter.quoting.quote-identifier" name="zend.db.adapter.quoting.quote-identifier"><div class="info"><h1 class="title">Использование <code class="code">quoteIdentifier()</code></h1></div>

            

            <p class="para">
                Значения являются не единственной частью синтаксиса SQL, которая
                может изменяться. Если вы используете переменные PHP для имен
                таблиц, столбцов и других идентификаторов в своих операторах
                SQL, то эти строки тоже следует заключать в кавычки. По
                умолчанию идентификаторы в SQL следуют тем же правилам
                синтаксиса, что есть в PHP и других языках программирования.
                Например, идентификаторы не должны содержать пробелы,
                определенные знаки препинания, специальные символы или
                международные символы. Также в синтаксисе SQL зарезервированы
                некоторые слова, и они не должны использоваться в качестве
                идентификаторов.
            </p>

            <p class="para">
                Тем не менее, в SQL есть возможность, которая называется
                <em class="emphasis">идентификаторы с ограничителями</em> (delimited
                identifiers), она дает б<em class="emphasis">о</em>льшие возможности
                выбора идентификаторов. Если вы заключите идентификатор SQL в
                кавычки требуемого типа, то можете использовать те
                идентификаторы, которые были бы недопустимыми без кавычек.
                Идентификаторы с ограничителями могут содержать пробелы, знаки
                препинания и международные символы. Вы можете также использовать
                зарезервированные слова SQL, если заключите их в ограничители
                идентификаторов.
            </p>

            <p class="para">
                <code class="code">quoteIdentifier()</code> работает так же, как
                <code class="code">quote()</code>, но он применяет символы ограничителей
                идентификаторов к строке в соответствии с типом используемой
                СУРБД. Например, стандартный SQL использует двойные кавычки
                (<code class="code">&quot;</code>) в качестве ограничителей идентификаторов и
                большинство типов СУРБД использует именно их. MySQL по умолчанию
                использует обратные кавычки (<code class="code">`</code>). Метод
                <code class="code">quoteIdentifier()</code> также экранирует специальные
                символы в строковом аргументе.
            </p>

            <div class="example"><div class="info"><p><b>Example #28 Использование quoteIdentifier()</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// мы можем иметь имя таблицы,</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// которое является зарезервированным в SQL словом</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$tableName</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quoteIdentifier</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;order&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">&quot;SELECT * FROM $tableName&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM &quot;order&quot;</span></div></li></ol></div></div></div>

            </div>

            <p class="para">
                Идентификаторы с ограничителями в SQL являются чувствительными к
                регистру, в отличие от не заключенных в кавычки. Поэтому, если
                вы используете идентификаторы с ограничителями, то должны
                использовать в точности то же написание идентификаторов, как и в
                схеме БД, включая регистр букв.
            </p>

            <p class="para">
                В большинстве случаев, когда SQL генерируется в классах Zend_Db,
                все идентификаторы по умолчанию автоматически заключаются в
                ограничители. Вы можете изменить это поведение с помощью опции
                <code class="code">Zend_Db::AUTO_QUOTE_IDENTIFIERS</code>. Указывайте ее при
                инстанцировании объекта адаптера. См.
                <a href="zend.db.adapter.html#zend.db.adapter.connecting.parameters.example2" class="xref">Передача фабрике опции автоматического заключения в кавычки</a>.
            </p>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.transactions" name="zend.db.adapter.transactions"><div class="info"><h1 class="title">Управление транзакциями</h1></div>

        

        <p class="para">
            Базы данных описывают транзакции как логические единицы работы,
            которые могут фиксироваться или откатываться как одно изменение,
            даже если они затрагивают несколько таблиц. Все запросы к БД
            выполняются в контексте транзакций, даже если драйвер баз данных
            работает с ними неявным образом. Это называется режимом
            <em class="emphasis">автоматической фиксации</em>, в котором драйвера БД
            создают транзакции для каждого выполняемого SQL-оператора. По
            умолчанию все классы адаптеров Zend_Db функционируют в режиме
            автоматической фиксации.
        </p>

        <p class="para">
            Вы можете также задавать начало и конец транзакции, и таким образом
            контролировать число SQL-запросов в группе, которая фиксируется (или
            откатывается) как одна операция.
            Используйте метод <code class="code">beginTransaction()</code> для инициирования
            транзакции. Последующие SQL-операторы будут выполняться в контексте
            этой транзакции до тех пор, пока вы не завершите ее явным образом.
        </p>

        <p class="para">
            Для завершения транзакции используйте методы <code class="code">commit()</code>
            или <code class="code">rollBack()</code>. Метод <code class="code">commit()</code> помечает
            изменения, произведенные в течение данной транзакции, как
            зафиксированные, это означает, что результаты этих изменений будут
            видны в запросах, выполняемых в других транзакциях.
        </p>

        <p class="para">
            Метод <code class="code">rollBack()</code> делает обратное - он не учитывает
            изменения, произведенные в течение транзакции. Изменения будут
            эффективно отменены, и состояние данных вернется к тому, в котором
            они были до того, как была начата транзакция. Тем не менее, откат
            транзакции не повлияет на изменения, произведенные другими
            транзакциями, запущенными в это же время.
        </p>

        <p class="para">
            После того, как вы завершите транзакцию,
            <code class="code">Zend_Db_Adapter</code> вернется в режим автоматической
            фиксации до того, как вы не вызовете <code class="code">beginTransaction()</code> снова.
        </p>

        <div class="example"><div class="info"><p><b>Example #29 Управление транзакциями для обеспечения согласованности данных</b></p></div>
            
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Старт транзакции явным образом</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">beginTransaction</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">try <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Попытка произвести один или несколько запросов</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">query</span><span style="color: #66cc66;">&#40;</span>...<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">query</span><span style="color: #66cc66;">&#40;</span>...<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">query</span><span style="color: #66cc66;">&#40;</span>...<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Если все запросы были произведены успешно, то транзакция фиксируется,</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// и все изменения фиксируются одновременно</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">commit</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> catch <span style="color: #66cc66;">&#40;</span>Exception <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Если какой-либо из этих запросов прошел неудачно, то вся транзакция</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// откатывается, при этом все изменения отменяются, даже те, которые были</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// произведены успешно.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Таким образом, все изменения либо фиксируются, либо не фиксируется вместе.</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">rollBack</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$e</span>-&gt;<span style="color: #006600;">getMessage</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.list-describe" name="zend.db.adapter.list-describe"><div class="info"><h1 class="title">Листинг и описание таблиц</h1></div>

        

        <p class="para">
            Метод <code class="code">listTables()</code> возвращает массив имен всех
            таблиц в текущей базе данных.
        </p>

        <p class="para">
            Метод <code class="code">describeTable()</code> возвращает ассоциативный массив
            метаданных таблицы. Указывайте имя таблицы в качестве первого
            аргумента этого метода. Второй аргумент является опциональным, и
            обозначает схему, в которой существует эта таблица.
        </p>

        <p class="para">
            Ключами возвращаемого ассоциативного массива являются имена столбцов
            таблицы. Значения, соответствующие этим столбцам, также являются
            ассоциативными массивами со следующими ключами и значениями:
        </p>

        <table class="doctable table"><div class="info"><caption><b>Поля метаданных, возвращаемых методом describeTable()</b></caption></div>
            
            
                <thead valign="middle">
                    <tr valign="middle">
                        <th>Ключ</th>
                        <th>Тип</th>
                        <th>Описание</th>
                    </tr>

                </thead>

                <tbody valign="middle" class="tbody">
                    <tr valign="middle">
                        <td align="left">SCHEMA_NAME</td>
                        <td align="left">(string)</td>
                        <td align="left">Имя схемы БД, в которой находится эта таблица.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">TABLE_NAME</td>
                        <td align="left">(string)</td>
                        <td align="left">Имя таблицы, которой принадлежит данный столбец.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">COLUMN_NAME</td>
                        <td align="left">(string)</td>
                        <td align="left">Имя столбца</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">COLUMN_POSITION</td>
                        <td align="left">(integer)</td>
                        <td align="left">Порядковый номер столбца в таблице.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">DATA_TYPE</td>
                        <td align="left">(string)</td>
                        <td align="left">Имя типа данных столбца, используемое в данной СУРБД</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">DEFAULT</td>
                        <td align="left">(string)</td>
                        <td align="left">Значение по умолчанию, если есть.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">NULLABLE</td>
                        <td align="left">(boolean)</td>
                        <td align="left">TRUE, если столбец допускает значение NULL, иначе FALSE.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">LENGTH</td>
                        <td align="left">(integer)</td>
                        <td align="left">Длина или значение столбца, сообщаемое СУРБД.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">SCALE</td>
                        <td align="left">(integer)</td>
                        <td align="left">Масштаб для типа данных NUMERIC или DECIMAL.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">PRECISION</td>
                        <td align="left">(integer)</td>
                        <td align="left">Точность для типа данных NUMERIC или DECIMAL.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">UNSIGNED</td>
                        <td align="left">(boolean)</td>
                        <td align="left">TRUE, если целочисленный тип объявлен как UNSIGNED (беззнаковое число).</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">PRIMARY</td>
                        <td align="left">(boolean)</td>
                        <td align="left">TRUE, если столбец является частью первичного ключа этой таблицы.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">PRIMARY_POSITION</td>
                        <td align="left">(integer)</td>
                        <td align="left">Порядковый номер (начинается с 1) данного столбца в первичном ключе.</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left">IDENTITY</td>
                        <td align="left">(boolean)</td>
                        <td align="left">TRUE, если данный столбец использует автоматически генерируемые значения.</td>
                    </tr>

                </tbody>
            
        </table>


        <p class="para">
            Если таблица, соответствующая заданным имени таблицы и имени схемы
            (опционально), не существует, то <code class="code">describeTable()</code>
            возвращает пустой массив.
        </p>

        <blockquote><p><b class="note">Note</b>: <span class="info"><b>Как поле метаданных IDENTITY соотносится с типом СУРБД</b><br /></span>
            
            
                Поле метаданных IDENTITY было выбрано в качестве
                &quot;идиоматического&quot; термина для представления связи с
                суррогатными ключами. Это поле обычно знакомо под следующими
                именами:
            <br />
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <code class="code">IDENTITY</code> - DB2, MSSQL
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <code class="code">AUTO_INCREMENT</code> - MySQL
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <code class="code">SERIAL</code> - PostgreSQL
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <code class="code">SEQUENCE</code> - Oracle
                    </p>
                </li>
            </ul>
        </p></blockquote>

    </div>

    <div class="section" id="zend.db.adapter.closing" name="zend.db.adapter.closing"><div class="info"><h1 class="title">Закрытие соединения</h1></div>

        

        <p class="para">
            Обычно нет необходимости в том, чтобы закрывать соединение с БД.
            PHP автоматически очищает все ресурсы в конце запроса. Расширения
            PHP для баз данных спроектированы таким образом, чтобы они закрывали
            соединение, когда удаляется ссылка на объект ресурса.
        </p>

        <p class="para">
            Тем не менее, если у вас есть скрипт PHP длительного времени
            выполнения, который инициирует множество соединений с БД, то может
            потребоваться закрывать соединения, чтобы избежать снижения
            производительности сервера СУРБД. Вы можете использовать метод
            адаптера <code class="code">closeConnection()</code> для явного закрытия лежащего
            в основе соединения с БД.
        </p>

        <div class="example"><div class="info"><p><b>Example #30 Закрытие соединения с БД</b></p></div>
            
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">closeConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <blockquote><p><b class="note">Note</b>: <span class="info"><b>Поддерживает ли Zend_Db постоянные соединения?</b><br /></span>
            
            
                Использование постоянных соединений не поддерживается или
                рекомендуется в Zend_Db.
            <br />
            
                Использование постоянных соединений может привести к избытку
                неиспользуемых соединений на сервере СУРБД, что приносит больше
                проблем, чем дает выигрыша в производительности, достигаемого
                путем уменьшения накладных расходов на установку соединений.
            <br />
            
                Соединения с БД имеют свое состояние, т.е. некоторые объекты на
                сервере СУРБД существуют в области видимости сессии. Примером
                являются блокировки, пользовательские переменные, временные
                таблицы и информация о последних выполненных запросах, такая,
                как количество затронутых строк и последнее сгенерированное
                значение. Если вы используете постоянные соединения, то ваше
                приложение может получать неверные или привилегированные данные,
                созданные в предыдущем PHP-запросе.
            <br />
        </p></blockquote>

    </div>

    <div class="section" id="zend.db.adapter.other-statements" name="zend.db.adapter.other-statements"><div class="info"><h1 class="title">Запуск других операторов БД</h1></div>

        

        <p class="para">
            Может потребоваться получить прямой доступ к
            объекту соединения в том виде, в котором он предоставляется
            расширением PHP для баз данных. Некоторые из этих расширений могут
            предоставлять функционал, который не поддерживается методами
            Zend_Db_Adapter_Abstract.
        </p>

        <p class="para">
            Например, все операторы SQL, запускаемые через Zend_Db,
            подготавливаются перед выполнением. Однако некоторый функционал баз
            данных несовместим с подготовленными операторами. Операторы DDL,
            такие, как CREATE и ALTER, не могут подготавливаться в MySQL. Также
            операторы SQL не дают выигрыша от
            <a href="http://dev.mysql.com/doc/refman/5.1/en/query-cache-how.html" class="link external">&raquo; кэширования запросов MySQL</a> в версиях MySQL до 5.1.17.
        </p>

        <p class="para">
            Большинство расширений PHP для баз данных предоставляет метод для
            выполнения операторов SQL без их подготовки. Например, в PDO таким
            методом является <code class="code">exec()</code>. Вы можете обратиться напрямую
            к объекту соединения в расширении PHP, используя getConnection().
        </p>

        <div class="example"><div class="info"><p><b>Example #31 Запуск неподготовленного оператора в адаптере PDO</b></p></div>
            
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">exec</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'DROP TABLE bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <p class="para">
            Так же вы можете получить доступ к другим методам или свойствам,
            специфическим для данного расширения. Тем не менее, следует
            учитывать, что, делая это, вы можете ограничить ваше приложение
            интерфейсом, предоставляемым расширением для определенной
            СУРБД.
        </p>

        <p class="para">
            В будущих версиях Zend_Db будет возможность добавить точки входа
            методов для функционала, который является общим для поддерживаемых
            расширений PHP. Это не нарушит обратную совместимость.
        </p>

    </div>

    <div class="section" id="zend.db.adapter.adapter-notes" name="zend.db.adapter.adapter-notes"><div class="info"><h1 class="title">Примечания к отдельным адаптерам</h1></div>

        

        <p class="para">
            В данный разделе описываются различия между классами адаптеров, о
            которых следует знать.
        </p>

        <div class="section" id="zend.db.adapter.adapter-notes.ibm-db2" name="zend.db.adapter.adapter-notes.ibm-db2"><div class="info"><h1 class="title">IBM DB2</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Db2&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширение ibm_db2.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        IBM DB2 поддерживает как последовательности, так и
                        автоинкрементные ключи. Поэтому аргументы для
                        <code class="code">lastInsertId()</code> являются опциональными. Если
                        вы не передадите аргументы, то адаптер вернет последнее
                        значение, сгенерированное для автоинкрементного ключа.
                        Если вы передадите аргументы, то адаптер вернет
                        последнее значение, сгенерированное последовательностью,
                        имя которой удовлетворяет соглашению
                        &#039;<em class="emphasis">таблица</em>_<em class="emphasis">имя</em>_seq&#039;.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.mysqli" name="zend.db.adapter.adapter-notes.mysqli"><div class="info"><h1 class="title">MySQLi</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Mysqli&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширение mysqli.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        MySQL не поддерживает последовательности, поэтому
                        <code class="code">lastInsertId()</code> игнорирует переданные
                        аргументы и всегда возвращает последнее значение,
                        сгенерированное для автоинкрементного ключа. Метод
                        <code class="code">lastSequenceId()</code> возвращает
                        <b><tt>NULL</tt></b>.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.oracle" name="zend.db.adapter.adapter-notes.oracle"><div class="info"><h1 class="title">Oracle</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Oracle&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширение oci8.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Oracle не поддерживает автоинкрементные ключи, поэтому
                        вы должны указывать имя последовательности для
                        <code class="code">lastInsertId()</code> или
                        <code class="code">lastSequenceId()</code>.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Расширение Oracle не поддерживает позиционные параметры.
                        Вы должны использовать именованные параметры.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        На данный момент опция
                        <code class="code">Zend_Db::CASE_FOLDING</code> не поддерживается
                        адаптером Oracle. Для того, чтобы применять эту опцию с
                        Oracle, вам нужно использовать адаптер PDO OCI.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-ibm" name="zend.db.adapter.adapter-notes.pdo-ibm"><div class="info"><h1 class="title">PDO для IBM DB2 и Informix Dynamic Server (IDS)</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Pdo_Ibm&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширения pdo и pdo_ibm.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Вы должны использовать расширение PDO_IBM версии не ниже
                        1.2.2. Если вы используете более раннюю версию этого
                        расширения, то должны обновить расширение PDO_IBM из
                        PECL.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-mssql" name="zend.db.adapter.adapter-notes.pdo-mssql"><div class="info"><h1 class="title">PDO Microsoft SQL Server</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Pdo_Mssql&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширения pdo и pdo_mssql.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Microsoft SQL Server не поддерживает последовательности,
                        поэтому <code class="code">lastInsertId()</code> игнорирует
                        переданные аргументы и всегда возвращает последнее
                        значение, сгенерированное для автоинкрементного ключа.
                        Метод <code class="code">lastSequenceId()</code> возвращает
                        <b><tt>NULL</tt></b>.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Zend_Db_Adapter_Pdo_Mssql устанавливает
                        <code class="code">QUOTED_IDENTIFIER ON</code> сразу после соединения
                        с сервером баз данных. Это заставляет драйвер
                        использовать стандартные символы-ограничители
                        идентификаторов (<code class="code">&quot;</code>) вместо квадратных
                        скобок, которые SQL Server использует в качестве
                        ограничителей идентификаторов.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Вы можете указывать <code class="code">pdoType</code> в качестве
                        ключа в массиве опций. Возможными значениями могут быть
                        &quot;mssql&quot; (по умолчанию),
                        &quot;dblib&quot;, &quot;freetds&quot; или &quot;sybase&quot;. Эта опция влияет на
                        префикс DSN, который используется адаптером, когда
                        строится строка DSN. &quot;Freetds&quot; и &quot;sybase&quot; подразумевают
                        префикс &quot;sybase:&quot;, который используется для набора
                        библиотек <a href="http://www.freetds.org/" class="link external">&raquo; FreeTDS</a>. Более
                        подробную информацию о префиксах, используемых в этих
                        драйверах, читайте на
                        <a href="http://www.php.net/manual/en/ref.pdo-dblib.connection.php" class="link external">&raquo; 
                        http://www.php.net/manual/en/ref.pdo-dblib.connection.php</a>.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-mysql" name="zend.db.adapter.adapter-notes.pdo-mysql"><div class="info"><h1 class="title">PDO MySQL</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Pdo_Mysql&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширения pdo и pdo_mysql.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        MySQL не поддерживает последовательности,
                        поэтому <code class="code">lastInsertId()</code> игнорирует
                        переданные аргументы и всегда возвращает последнее
                        значение, сгенерированное для автоинкрементного ключа.
                        Метод <code class="code">lastSequenceId()</code> возвращает
                        <b><tt>NULL</tt></b>.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-oci" name="zend.db.adapter.adapter-notes.pdo-oci"><div class="info"><h1 class="title">PDO Oracle</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Pdo_Oci&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширения pdo и pdo_oci.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Oracle не поддерживает автоинкрементные ключи, поэтому
                        вы должны указывать имя последовательности для
                        <code class="code">lastInsertId()</code> или
                        <code class="code">lastSequenceId()</code>.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-pgsql" name="zend.db.adapter.adapter-notes.pdo-pgsql"><div class="info"><h1 class="title">PDO PostgreSQL</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Pdo_Pgsql&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширения pdo и pdo_pgsql.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        PostgreSQL поддерживает как последовательности, так и
                        автоинкрементные ключи. Поэтому аргументы для
                        <code class="code">lastInsertId()</code> являются опциональными. Если
                        вы не передадите аргументы, то адаптер вернет последнее
                        значение, сгенерированное для автоинкрементного ключа.
                        Если вы передадите аргументы, то адаптер вернет
                        последнее значение, сгенерированное последовательностью,
                        имя которой удовлетворяет соглашению
                        &#039;<em class="emphasis">таблица</em>_<em class="emphasis">имя</em>_seq&#039;.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-sqlite" name="zend.db.adapter.adapter-notes.pdo-sqlite"><div class="info"><h1 class="title">PDO SQLite</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Для установки этого адаптера через метод factory() используйте строку &#039;Pdo_Sqlite&#039;.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширения pdo и pdo_sqlite.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        SQLite не поддерживает последовательности,
                        поэтому <code class="code">lastInsertId()</code> игнорирует
                        переданные аргументы и всегда возвращает последнее
                        значение, сгенерированное для автоинкрементного ключа.
                        Метод <code class="code">lastSequenceId()</code> возвращает
                        <b><tt>NULL</tt></b>.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Для того, чтобы соединится с базой данных SQLite2,
                        указывайте <code class="code">&#039;sqlite2&#039;=&gt;true</code> в массиве
                        параметров при создании экземпляра адаптера Pdo_Sqlite.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Для соединения с базой данных SQLite в памяти указывайте
                        <code class="code">&#039;dbname&#039;=&gt;&#039;:memory:&#039;</code> в массиве параметров
                        при создании экземпляра адаптера Pdo_Sqlite.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Старые версии драйвера SQLite для PHP могут не
                        поддерживать команды PRAGMA, необходимые для обеспечения
                        использования коротких имен столбцов в результатах. Если
                        имеются проблемы с тем, что результаты возвращаются с
                        ключами в виде &quot;tablename.columnname&quot;, когда производится запрос с объединением таблиц, то следует обновить PHP до текущей версии.
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.firebird" name="zend.db.adapter.adapter-notes.firebird"><div class="info"><h1 class="title">Firebird/Interbase</h1></div>
            
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Этот адаптер использует PHP-расширение php_interbase.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        Firebird/interbase  не поддерживает автоинкрементные
                        ключи, поэтому вы должны указывать имя
                        последовательности для
                        <code class="code">lastInsertId()</code> или
                        <code class="code">lastSequenceId()</code>.
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        На данный момент опция
                        <code class="code">Zend_Db::CASE_FOLDING</code> не поддерживается
                        адаптером Firebird/interbase. Не заключенные в кавычки
                        идентификаторы автоматически возвращаются в верхнем
                        регистре..
                    </p>
                </li>
            </ul>
        </div>

    </div>

</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.db.html">Zend_Db</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.db.html">Zend_Db</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.db.statement.html">Zend_Db_Statement</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.db.html">Zend_Db</a></li>
  <li class="active"><a href="zend.db.adapter.html">Zend_Db_Adapter</a></li>
  <li><a href="zend.db.statement.html">Zend_Db_Statement</a></li>
  <li><a href="zend.db.profiler.html">Zend_Db_Profiler</a></li>
  <li><a href="zend.db.select.html">Zend_Db_Select</a></li>
  <li><a href="zend.db.table.html">Zend_Db_Table</a></li>
  <li><a href="zend.db.table.row.html">Zend_Db_Table_Row</a></li>
  <li><a href="zend.db.table.rowset.html">Zend_Db_Table_Rowset</a></li>
  <li><a href="zend.db.table.relationships.html">Связи между таблицами Zend_Db_Table</a></li>
  <li><a href="zend.db.table.definition.html">Zend_Db_Table_Definition</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>