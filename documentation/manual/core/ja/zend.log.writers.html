<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>ライター - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.log.overview.html">概要</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.log.html">Zend_Log</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.log.formatters.html">フォーマッタ</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.log.writers" class="section"><div class="info"><h1 class="title">ライター</h1></div>
  
  <p class="para">
    ライターは、<span class="classname">Zend_Log_Writer_Abstract</span>
    を継承したオブジェクトです。ライターの役割は、
    ログのデータをバックエンドのストレージに記録することです。
  </p>

  <div class="section" id="zend.log.writers.stream" name="zend.log.writers.stream"><div class="info"><h1 class="title">ストリームへの書き出し</h1></div>
    
    <p class="para">
      <span class="classname">Zend_Log_Writer_Stream</span> は、ログデータを
      <a href="http://www.php.net/stream" class="link external">&raquo; PHP のストリーム</a>
      に書き出します。
    </p>

    <p class="para">
      ログのデータを <acronym class="acronym">PHP</acronym> の出力バッファに書き出すには、URL <var class="filename">php://output</var>
      を使用します。一方、ログのデータを直接 <b><tt>STDERR</tt></b>
      のようなストリームに送ることもできます (<var class="filename">php://stderr</var>)。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Stream<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'php://output'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Informational message'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
      データをファイルに書き出すには、
      <a href="http://www.php.net/manual/ja/wrappers.php#wrappers.file" class="link external">&raquo; ファイルシステム
      URL</a> のいずれかを使用します。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Stream<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/path/to/logfile'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Informational message'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
      デフォルトでは、ストリームを追記モード (&quot;a&quot;) でオープンします。
      別のモードでオープンするには、<span class="classname">Zend_Log_Writer_Stream</span>
      のコンストラクタで二番目のオプション引数にモードを指定します。
    </p>

    <p class="para">
      <span class="classname">Zend_Log_Writer_Stream</span> のコンストラクタには、
      既存のストリームリソースを指定することもできます。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$stream</span> = @<a href="http://www.php.net/fopen"><span style="color: #000066;">fopen</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/path/to/logfile'</span>, <span style="color: #ff0000;">'a'</span>, <span style="color: #000000; font-weight: bold;">false</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>! <span style="color: #0000ff;">$stream</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; throw <span style="color: #000000; font-weight: bold;">new</span> Exception<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'ストリームのオープンに失敗しました'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Stream<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$stream</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'通知メッセージ'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
      既存のストリームリソースに対してモードを指定することはできません。
      指定しようとすると <span class="classname">Zend_Log_Exception</span> をスローします。
    </p>
  </div>

  <div class="section" id="zend.log.writers.database" name="zend.log.writers.database"><div class="info"><h1 class="title">データベースへの書き出し</h1></div>
    

    <p class="para">
      <span class="classname">Zend_Log_Writer_Db</span> は、
      <span class="classname">Zend_Db</span> を使用してログ情報をデータベースに書き出します。
      <span class="classname">Zend_Log_Writer_Db</span> のコンストラクタには
      <span class="classname">Zend_Db_Adapter</span> のインスタンス、テーブル名
      およびデータベースのカラムとイベントデータ項目との対応を指定します。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'malory'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'******'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'camelot'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'PDO_MYSQL'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$columnMapping</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'lvl'</span> =&gt; <span style="color: #ff0000;">'priority'</span>, <span style="color: #ff0000;">'msg'</span> =&gt; <span style="color: #ff0000;">'message'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Db<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$db</span>, <span style="color: #ff0000;">'log_table_name'</span>, <span style="color: #0000ff;">$columnMapping</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'通知メッセージ'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
      上の例は、一行ぶんのログデータを &#039;log_table_name&#039;
      という名前のテーブルに書き出します。データベースのカラム
      &#039;lvl&#039; には優先度の番号が格納され、&#039;msg&#039;
      というカラムにログのメッセージが格納されます。
    </p>

  </div>

  <div class="section" id="zend.log.writers.firebug" name="zend.log.writers.firebug"><div class="info"><h1 class="title">Firebug への書き込み</h1></div>
    
    <p class="para">
      <span class="classname">Zend_Log_Writer_Firebug</span> は、ログデータを
      <a href="http://www.getfirebug.com/" class="link external">&raquo; Firebug</a>
      <a href="http://getfirebug.com/logging.html" class="link external">&raquo; コンソール</a>
      に送信します。
    </p>
    <p class="para">
      <div class="inlinemediaobject"><div class="imageobject"><img src="images/d481d625821a97b9a5eb2cec99dca50e-zend.wildfire.firebug.console.png" alt="zend.wildfire.firebug.console.png" width="310" height="151" /></div></div>
    </p>
    <p class="para">
      すべてのデータの送信には <span class="classname">Zend_Wildfire_Channel_HttpHeaders</span>
      コンポーネントを使用します。これは <acronym class="acronym">HTTP</acronym> ヘッダを使用するので、
      ページのコンテンツには何も影響を及ぼしません。
      この方式なら、<acronym class="acronym">AJAX</acronym> リクエストのようにクリーンな <acronym class="acronym">JSON</acronym>
      および <acronym class="acronym">XML</acronym> レスポンスを要求するリクエストのデバッグも行えます。
    </p>
    <p class="para">
      要件:
    </p>
    <ul class="itemizedlist">
      <li class="listitem">
        <p class="para">
          Firefox ブラウザ。バージョン 3 が最適ですがバージョン 2 にも対応しています。
        </p>
      </li>
      <li class="listitem">
        <p class="para">
          Firebug 拡張。
          <a href="https://addons.mozilla.org/ja/firefox/addon/1843" class="link external">&raquo; https://addons.mozilla.org/ja/firefox/addon/1843</a>
          からダウンロードできます。
        </p>
      </li>
      <li class="listitem">
        <p class="para">
          FirePHP 拡張。
          <a href="https://addons.mozilla.org/ja/firefox/addon/6149" class="link external">&raquo; https://addons.mozilla.org/ja/firefox/addon/6149</a>
          からダウンロードできます。
        </p>
      </li>
    </ul>

    <div class="example"><div class="info"><p><b>Example #1 Zend_Controller_Front を使ったログ記録</b></p></div>
      

      <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 起動ファイルで、フロントコントローラのディスパッチの前に記述します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Firebug<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// モデル、ビューおよびコントローラのファイル内でこれを使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">log</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'This is a log message!'</span>, Zend_Log::<span style="color: #006600;">INFO</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </div>

    <div class="example"><div class="info"><p><b>Example #2 Zend_Controller_Front を使わないログ記録</b></p></div>
      

      <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Firebug<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$request</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Controller_Request_Http<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$response</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Controller_Response_Http<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$channel</span> = Zend_Wildfire_Channel_HttpHeaders::<span style="color: #006600;">getInstance</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$channel</span>-&gt;<span style="color: #006600;">setRequest</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$request</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$channel</span>-&gt;<span style="color: #006600;">setResponse</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$response</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 出力バッファリングを開始します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/ob_start"><span style="color: #000066;">ob_start</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// ロガーをコールします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">log</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'This is a log message!'</span>, Zend_Log::<span style="color: #006600;">INFO</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// ログデータをブラウザに送ります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$channel</span>-&gt;<span style="color: #006600;">flush</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$response</span>-&gt;<span style="color: #006600;">sendHeaders</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.log.writers.firebug.priority-styles" name="zend.log.writers.firebug.priority-styles"><div class="info"><h1 class="title">優先度のスタイルの設定</h1></div>

      

      <p class="para">
        組み込みの優先度やユーザ定義の優先度を使うには
         <span class="methodname">setPriorityStyle()</span> メソッドを使用します。
      </p>
      <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">addPriority</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'FOO'</span>, <span style="color: #cc66cc;">8</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setPriorityStyle</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">8</span>, <span style="color: #ff0000;">'TRACE'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">foo</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Foo Message'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

      <p class="para">
        ユーザ定義の優先度用のデフォルトのスタイルを設定するには
         <span class="methodname">setDefaultPriorityStyle()</span> メソッドを使用します。
      </p>
      <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setDefaultPriorityStyle</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'TRACE'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

      <p class="para">
        サポートしているスタイルは次のとおりです。
        <table class="doctable table"><div class="info"><caption><b>Firebug Logging Styles</b></caption></div>
            
            
                <thead valign="middle">
                    <tr valign="middle">
                        <th>スタイル</th>
                        <th>説明</th>
                    </tr>

                </thead>

                <tbody valign="middle" class="tbody">
                    <tr valign="middle">
                        <td align="left"><b><tt>LOG</tt></b></td>
                        <td align="left">通常のログメッセージを表示します</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>INFO</tt></b></td>
                        <td align="left">情報ログメッセージを表示します</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>WARN</tt></b></td>
                        <td align="left">警告ログメッセージを表示します</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>ERROR</tt></b></td>
                        <td align="left">エラーログメッセージを表示し、Firebug のエラーカウントをひとつ増やします</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>TRACE</tt></b></td>
                        <td align="left">拡張スタックトレースつきのログメッセージを表示します</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>EXCEPTION</tt></b></td>
                        <td align="left">拡張スタックトレースつきのエラーログメッセージを表示します</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>TABLE</tt></b></td>
                        <td align="left">拡張テーブルつきのログメッセージを表示します</td>
                    </tr>

                </tbody>
            
        </table>

      </p>
    </div>

    <div class="section" id="zend.log.writers.firebug.preparing-data" name="zend.log.writers.firebug.preparing-data"><div class="info"><h1 class="title">ログ記録用のデータの準備</h1></div>

      

      <p class="para">
        任意の <acronym class="acronym">PHP</acronym> の変数を組み込みの優先度でログに記録できますが、
        特殊なログ形式を使う場合は、何らかの書式変換が必要となります。
      </p>
      <p class="para">
        <b><tt>LOG</tt></b>、<b><tt>INFO</tt></b>、<b><tt>WARN</tt></b>、<b><tt>ERROR</tt></b>
        そして <b><tt>TRACE</tt></b> については特別な書式変換は不要です。
      </p>
    </div>

    <div class="section" id="zend.log.writers.firebug.preparing-data.exception" name="zend.log.writers.firebug.preparing-data.exception"><div class="info"><h1 class="title">例外のログ記録</h1></div>

      

      <p class="para">
        <span class="classname">Zend_Exception</span> のログを記録するには、
        単にその例外オブジェクトをロガーに渡すだけです。
        設定している優先度やスタイルにかかわらず、
        例外は自動的に例外と判断されます。
      </p>
      <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$exception</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Exception<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Test exception'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">err</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$exception</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.log.writers.firebug.preparing-data.table" name="zend.log.writers.firebug.preparing-data.table"><div class="info"><h1 class="title">表形式のログ</h1></div>

      

      <p class="para">
        ログを表形式で記録できます。カラムは自動検出され、
        データの最初の行がヘッダと見なされます。
      </p>
      <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setPriorityStyle</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">8</span>, <span style="color: #ff0000;">'TABLE'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">addPriority</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'TABLE'</span>, <span style="color: #cc66cc;">8</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$table</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Summary line for the table'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Column 1'</span>, <span style="color: #ff0000;">'Column 2'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Row 1 c 1'</span>,<span style="color: #ff0000;">' Row 1 c 2'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Row 2 c 1'</span>,<span style="color: #ff0000;">' Row 2 c 2'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">table</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$table</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </div>
</div>
  <div class="section" id="zend.log.writers.mail" name="zend.log.writers.mail"><div class="info"><h1 class="title">Email への書き込み</h1></div>
    

    <p class="para">
        <span class="classname">Zend_Log_Writer_Mail</span> は、
        <span class="classname">Zend_Mail</span> を使ってログエントリをメールのメッセージに書き出します。
        <span class="classname">Zend_Log_Writer_Mail</span> のコンストラクタは
        <span class="classname">Zend_Mail</span> オブジェクトを受け取り、
        またオプションで <span class="classname">Zend_Layout</span> オブジェクトを受け取ります。
    </p>

    <p class="para">
        <span class="classname">Zend_Log_Writer_Mail</span> の主な使い道は、
        開発者やシステム管理者など関係者に対して
        <acronym class="acronym">PHP</acronym> スクリプトで発生したエラーを通知することです。
        「何か問題がおこったら、すぐに人間に通知しないとね。
        そうすればすぐに適切な対応ができるわけだから」そんなアイデアを元に
        <span class="classname">Zend_Log_Writer_Mail</span> が誕生しました。
    </p>

    <p class="para">
        基本的な使い方は以下のとおりです。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$mail</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Mail<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$mail</span>-&gt;<span style="color: #006600;">setFrom</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'errors@example.org'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">addTo</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'project_developers@example.org'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Mail<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$mail</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 件名に使用するテキストを設定します。実際にメッセージを送信する前に、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 発生したエラー数がこの件名に付け加えられます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setSubjectPrependText</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Errors with script foo.php'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 警告レベル以上の場合にのみメールを送信します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">addFilter</span><span style="color: #66cc66;">&#40;</span>Zend_Log::<span style="color: #006600;">WARN</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">addWriter</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// なにかが起こりました！</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">error</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'unable to connect to database'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// ライターの処理が終了すると Zend_Mail::send() が立ち上がり、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 上の Zend_Log フィルタレベル以上のすべてのログメッセージが送信されます</span></div></li></ol></div></div></div>


    <p class="para">
        <span class="classname">Zend_Log_Writer_Mail</span> は、デフォルトで
        メールの本文をプレーンテキスト形式でレンダリングします。
    </p>

    <p class="para">
        指定したフィルタレベル以上のすべてのログエントリが、
        ひとつのメールにまとめて送られます。たとえば、
        警告レベル以上を送信するよう設定しているときに
        2 つの警告と 5 つのエラーが発生したら、
        メールには 7 つのログエントリが含まれることになります。
    </p>

    <div class="section" id="zend.log.writers.mail.layoutusage" name="zend.log.writers.mail.layoutusage"><div class="info"><h1 class="title">Zend_Layout の使用法</h1></div>
        

        <p class="para">
            <span class="classname">Zend_Layout</span> のインスタンスを使用して、
            マルチパートメールの <acronym class="acronym">HTML</acronym> 部を作成できます。
            <span class="classname">Zend_Layout</span> のインスタンスが用いられた場合、
            <span class="classname">Zend_Log_Writer_Mail</span> は <acronym class="acronym">HTML</acronym> をレンダリングするものとみなし、
            <span class="classname">Zend_Layout</span> がレンダリングした値をメッセージの本文
            <acronym class="acronym">HTML</acronym> として設定します。
        </p>

        <p class="para">
            <span class="classname">Zend_Log_Writer_Mail</span> で
            <span class="classname">Zend_Layout</span> のインスタンスを使う場合には、
             <span class="methodname">setLayoutFormatter()</span> メソッドで独自のフォーマッタを指定できます。
            <span class="classname">Zend_Layout</span> 用のエントリフォーマッタを指定しなかった場合は、
            現在使用中のものをそのまま使います。
            <span class="classname">Zend_Layout</span> で独自のフォーマッタを使用する方法を以下に示します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$mail</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Mail<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$mail</span>-&gt;<span style="color: #006600;">setFrom</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'errors@example.org'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">addTo</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'project_developers@example.org'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 件名は Zend_Mail のインスタンスには設定していないことに注意しましょう!</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// シンプルに、デフォルトの Zend_Layout のインスタンスを使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$layout</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Layout<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// エントリを li タグで囲むフォーマッタを作成します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$layoutFormatter</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Formatter_Simple<span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'&lt;li&gt;'</span> . Zend_Log_Formatter_Simple::<span style="color: #006600;">DEFAULT_FORMAT</span> . <span style="color: #ff0000;">'&lt;/li&gt;'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Mail<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$mail</span>, <span style="color: #0000ff;">$layout</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Zend_Layout でレンダリングするための、エントリのフォーマッタを適用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setLayoutFormatter</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$layoutFormatter</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setSubjectPrependText</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Errors with script foo.php'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">addFilter</span><span style="color: #66cc66;">&#40;</span>Zend_Log::<span style="color: #006600;">WARN</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">addWriter</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// なにかが起こりました！</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">error</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'unable to connect to database'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// ライターの処理が終了すると Zend_Mail::send() が立ち上がり、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 上の Zend_Log フィルタレベル以上のすべてのログメッセージが送信されます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// メールは、プレーンテキストと HTML パートの両方を含む形式になります</span></div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.log.writers.mail.dynamicsubjectline" name="zend.log.writers.mail.dynamicsubjectline"><div class="info"><h1 class="title">件名でのエラーの概要</h1></div>
        

        <p class="para">
             <span class="methodname">setSubjectPrependText()</span> メソッドを
             <span class="methodname">Zend_Mail::setSubject()</span> のかわりに使用すると、
            メールを送信する直前に件名を動的に書き込むことができます。たとえば、
            件名のテキストが &quot;Errors from script&quot; だとすると、
            2 つの警告と 5 つのエラーが発生した場合に <span class="classname">Zend_Log_Writer_Mail</span>
            が作成するメールの件名は &quot;Errors from script (warn = 2;
            error = 5)&quot; となります。<span class="classname">Zend_Log_Writer_Mail</span>
            で件名のテキストを設定しなかった場合、もし <span class="classname">Zend_Mail</span>
            で設定されていればそれを使用します。
        </p>
    </div>

    <div class="section" id="zend.log.writers.mail.caveats" name="zend.log.writers.mail.caveats"><div class="info"><h1 class="title">警告</h1></div>
        

        <p class="para">
            ログエントリをメールでおくるのは危険なこともあります。
            スクリプト内でのエラー条件の処理が不適切だったり
            エラーレベルの使用法を間違えたりすると、
            エラーの発生頻度によっては何百通何千通ものメールを送信してしまう可能性があります。
        </p>

        <p class="para">
            現時点では、<span class="classname">Zend_Log_Writer_Mail</span>
            にはメッセージを抑制したりひとつにまとめたりする機能はありません。
            そのような機能が必要な場合は自前で実装する必要があります。
        </p>

        <p class="para">
            もう一度言いますが、<span class="classname">Zend_Log_Writer_Mail</span>
            の第一の目標は、人間に向けてエラーの情報を積極的に伝えることです。
            これらのエラーがタイミングよく処理され、
            このような状況が避けられるような機能が実装されたときには、
            メールによるエラー通知は便利な道具となることでしょう。
        </p>
    </div>
</div>
  <div class="section" id="zend.log.writers.syslog" name="zend.log.writers.syslog"><div class="info"><h1 class="title">システムログへの書き込み</h1></div>
    

    <p class="para">
        <span class="classname">Zend_Log_Writer_Syslog</span>は、
        システムログ (syslog) にログ項目を書きます。
        内部的には、それは<acronym class="acronym">PHP</acronym>の
         <span class="methodname">openlog()</span>や <span class="methodname">closelog()</span>、
        そして <span class="methodname">syslog()</span>関数の代わりです。
    </p>

    <p class="para">
        <span class="classname">Zend_Log_Writer_Syslog</span>が役立つ例の１つは、
        クラスター形成されたマシンからシステムログ機能を通して集計されるログです。
        多くのシステムでは、システム・イベントをリモートでログ収集できます。
        それにより、システム管理者が単一のログファイルでマシンのクラスタをモニターできるようになります。
    </p>

    <p class="para">
        デフォルトで、生成されるsyslogメッセージはすべて、
        文字列「Zend_Log」という接頭辞が付きます。
        コンストラクタ、またはアプリケーション・アクセッサにアプリケーション名を渡すことで、
        そのようなログメッセージを特定する異なる「アプリケーション」名を指定するかもしれません。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//インスタンス生成時に任意で &quot;application&quot; キーを渡します。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Syslog<span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'application'</span> =&gt; <span style="color: #ff0000;">'FooBar'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//そのほかいつでも</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setApplicationName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'BarBaz'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
        システムログでは &quot;facility&quot; やアプリケーション・タイプ、
        またはログ収集メッセージを指定できます。
        多くのシステム・ロガーは、実は機能毎に異なるログファイルを生成します。
        それは、前と同じように、サーバ活動をモニターする管理者を助けます。
    </p>

    <p class="para">
        コンストラクタ、またはアクセッサでログ機能を指定するかもしれません。
        それは、<a href="http://php.net/openlog" class="link external">&raquo; openlog() マニュアル</a>で定義される
         <span class="methodname">openlog()</span>定数のうちの１つでなければなりません。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//インスタンス生成時に任意で &quot;facility&quot; キーを渡します。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Syslog<span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'facility'</span> =&gt; LOG_AUTH<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//そのほかいつでも</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span>-&gt;<span style="color: #006600;">setFacility</span><span style="color: #66cc66;">&#40;</span>LOG_USER<span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
        ログ収集時に、デフォルトの<span class="classname">Zend_Log</span>
        優先度定数を使い続けるかもしれません。
        内部的には、それらは適切な <span class="methodname">syslog()</span>
        優先度定数にマップされます。
    </p>
</div>
  <div class="section" id="zend.log.writers.zendmonitor" name="zend.log.writers.zendmonitor"><div class="info"><h1 class="title">Zend Server モニターへの書き込み</h1></div>
    

    <p class="para">
        <span class="classname">Zend_Log_Writer_ZendMonitor</span> では、Zend Server のモニター
        <acronym class="acronym">API</acronym> を介してイベントを記録できます。
        これにより、アプリケーション環境全体のログ・メッセージを一箇所に集約できます。
        内部的には、それは単に Zend モニター <acronym class="acronym">API</acronym> 由来の
         <span class="methodname">monitor_custom_event()</span> 関数を使用します。
    </p>

    <p class="para">
        モニター <acronym class="acronym">API</acronym> で特に役立つ機能は、
        ログ・メッセージと一緒に任意のカスタム情報を指定できることです。
        たとえば、例外を記録したい場合、まさにその例外メッセージを記録できません。
        しかし、関数に例外オブジェクトを全て渡せます。
        そして、Zend Server イベント・モニターの内部でオブジェクトを調査できます。
    </p>

    <blockquote><p><b class="note">Note</b>: <span class="info"><b>Zend モニターがインストールされ、使用可能にされなければいけません</b><br /></span>
        

        
            このログ・ライタを使用するには、Zend モニターがインストールされ、使用可能にされなければなりません。
            しかしながら、Zend モニターが検出されない場合、<b><tt>NULL</tt></b>
            ロガーとして単純に動作するように設計されています。
        <br />
    </p></blockquote>

    <p class="para">
        <span class="classname">ZendMonitor</span>ログ・ライタのインスタンス生成は特記するまでもありません。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_ZendMonitor<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>&nbsp; &nbsp; = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
        それから、通常通り単純にメッセージを記録します。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'This is a message'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
        イベントと共に記録する追加の情報を指定したい場合は、
        ２番目の引数でその情報を渡します。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Exception occurred'</span>, <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
        ２番目の引数は、スカラー、オブジェクトまたは配列です。
        情報の複数の部分を渡す必要があるならば、そうする最高の方法は連想配列を渡すことです。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$log</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Exception occurred'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'request'</span>&nbsp; &nbsp;=&gt; <span style="color: #0000ff;">$request</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'exception'</span> =&gt; <span style="color: #0000ff;">$e</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


    <p class="para">
        Zend Server 内では、イベントは「カスタム・イベント」として記録されます。
        「モニター」タブから「イベント」項目を選び、カスタム・イベントを見るために、「カスタム」上で絞り込みます。
    </p>

    <p class="para">
        <div class="inlinemediaobject"><div class="imageobject"><a href="images/d481d625821a97b9a5eb2cec99dca50e-zend.log.writers.zendmonitor-events.png"><img src="images/d481d625821a97b9a5eb2cec99dca50e-zend.log.writers.zendmonitor-events.png" alt="zend.log.writers.zendmonitor-events.png" width="450" height="298" /></a></div></div>
    </p>

    <p class="para">
        Zend Server のモニター・ダッシュボードのイベント
    </p>

    <p class="para">
        このスクリーン・ショットで、一覧表示される最初の2つのイベントは、
        <span class="classname">ZendMonitor</span>ログ・ライタを通して記録されるカスタム・イベントです。
        関連した情報を全て見るには、イベントをクリックします。
    </p>

    <p class="para">
        <div class="inlinemediaobject"><div class="imageobject"><a href="images/d481d625821a97b9a5eb2cec99dca50e-zend.log.writers.zendmonitor-event.png"><img src="images/d481d625821a97b9a5eb2cec99dca50e-zend.log.writers.zendmonitor-event.png" alt="zend.log.writers.zendmonitor-event.png" width="450" height="298" /></a></div></div>
    </p>

    <p class="para">
        Zend Server のモニターのイベント詳細
    </p>

    <p class="para">
        「カスタム」タブをクリックすると、ログ収集メソッドに２番目の引数を渡して記録した
        追加の情報を全て詳しく表示します。
        この情報は、<var class="varname">info</var> キーとして記録されます。
        この例では、リクエスト・オブジェクトが記録されることを確認できます。
    </p>

    <blockquote><p><b class="note">Note</b>: <span class="info"><b>Zend_Application との統合</b><br /></span>
        

        
            <strong class="command">zf.sh</strong> と <strong class="command">zf.bat</strong> コマンドは、デフォルトで
            <a href="zend.application.available-resources.html#zend.application.available-resources.log" class="link"><span class="classname">Zend_Application</span>
            ログ・リソース</a>用の構成を追加します。
            そして、それは <span class="classname">ZendMonitor</span> ログ・ライタ用の構成を含みます。
            さらに、<span class="classname">ErrorController</span> は、アプリケーション例外を記録するために
            構成されたロガーを使います。それは、デフォルトでZend モニター・イベント統合とともに提供します。
        <br />

        
            前述のように、モニター <acronym class="acronym">API</acronym> が <acronym class="acronym">PHP</acronym> インストールで検出されない場合、
            ロガーは単純に <b><tt>NULL</tt></b> ロガーとして動作します。
        <br />
    </p></blockquote>
</div>

  <div class="section" id="zend.log.writers.null" name="zend.log.writers.null"><div class="info"><h1 class="title">ライターのスタブ</h1></div>
    

    <p class="para">
      <span class="classname">Zend_Log_Writer_Null</span> はスタブで、ログデータをどこにも書き出しません。
      これは、ログ出力を無効にしたりテスト時などに便利です。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Null;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// どこにも出力されません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'通知メッセージ'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

  </div>

  <div class="section" id="zend.log.writers.mock" name="zend.log.writers.mock"><div class="info"><h1 class="title">モックによるテスト</h1></div>
    

    <p class="para">
      <span class="classname">Zend_Log_Writer_Mock</span> は非常にシンプルなライターです。
      受け取った生のデータを配列に格納し、それを public プロパティとして公開します。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$mock</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Mock;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$mock</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'通知メッセージ'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/var_dump"><span style="color: #000066;">var_dump</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$mock</span>-&gt;<span style="color: #006600;">events</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Array</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// (</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; &nbsp; [timestamp] =&gt; 2007-04-06T07:16:37-07:00</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; &nbsp; [message] =&gt; 通知メッセージ</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; &nbsp; [priority] =&gt; 6</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; &nbsp; [priorityName] =&gt; INFO</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// )</span></div></li></ol></div></div></div>


    <p class="para">
      モックが記録したイベントを消去するには、単純に <strong class="command">$mock-&gt;events = array()</strong>
      とします。
    </p>
  </div>

  <div class="section" id="zend.log.writers.compositing" name="zend.log.writers.compositing"><div class="info"><h1 class="title">ライターを組み合わせる</h1></div>
    

    <p class="para">
      合成ライターオブジェクトはありません。
      しかし、ログのインスタンスは任意の数のライターに書き出すことができます。そのためには
       <span class="methodname">addWriter()</span> メソッドを使用します。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer1</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Stream<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/path/to/first/logfile'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$writer2</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log_Writer_Stream<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/path/to/second/logfile'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Log<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">addWriter</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer1</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">addWriter</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$writer2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 両方のライターに書き出されます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$logger</span>-&gt;<span style="color: #006600;">info</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'通知メッセージ'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

  </div>
</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.log.overview.html">概要</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.log.html">Zend_Log</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.log.formatters.html">フォーマッタ</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.log.html">Zend_Log</a></li>
  <li><a href="zend.log.overview.html">概要</a></li>
  <li class="active"><a href="zend.log.writers.html">ライター</a></li>
  <li><a href="zend.log.formatters.html">フォーマッタ</a></li>
  <li><a href="zend.log.filters.html">フィルタ</a></li>
  <li><a href="zend.log.factory.html">Using the Factory to Create a Log</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>