<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Zend_Service_Nirvanix(日本語) - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.service.livedocx.html">Zend_Service_LiveDocx</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.service.html">Zend_Service</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.service.recaptcha.html">Zend_Service_ReCaptcha(日本語)</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.service.nirvanix" class="section"><div class="info"><h1 class="title">Zend_Service_Nirvanix(日本語)</h1></div>
    

    <div class="section" id="zend.service.nirvanix.introduction" name="zend.service.nirvanix.introduction"><div class="info"><h1 class="title">導入</h1></div>
        

        <p class="para">
            Nirvanix は Internet Media File System (<acronym class="acronym">IMFS</acronym>)
            です。インターネット上のストレージサービスに対して
            ファイルをアップロードして保存し、ファイルを管理します。
            また、標準的なウェブサービスインターフェイスでファイルにアクセスできます。
            <acronym class="acronym">IMFS</acronym> はクラスタ形式のファイルシステムで、インターネット越しにアクセスします。
            また、メディアファイル (音声や動画など) に最適化されています。
            <acronym class="acronym">IMFS</acronym> の目標は、ますます増えていくメディアストレージに対応する
            スケーラビリティを提供すること、
            そしていつでもどこでもそこにアクセスできることを保証することです。
            最後に、<acronym class="acronym">IMFS</acronym> を使用すればアプリケーションからデータに対して
            セキュアにアクセスできるようになります。また、
            物理的なストレージを確保したり保守したりするためのコストも回避できます。
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.registering" name="zend.service.nirvanix.registering"><div class="info"><h1 class="title">Nirvanix への登録</h1></div>
        

        <p class="para">
            <span class="classname">Zend_Service_Nirvanix</span> を使う前に、
            まずアカウントを取得する必要があります。詳細な情報は、
            Nirvanix のウェブサイトにある
            <a href="http://www.nirvanix.com/gettingStarted.aspx" class="link external">&raquo; Getting Started</a>
            を参照ください。
        </p>

        <p class="para">
            登録を済ませると、ユーザ名とパスワードそしてアプリケーションキーが得られます。
            <span class="classname">Zend_Service_Nirvanix</span> を使うには、
            これらすべてが必要となります。
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.apiDocumentation" name="zend.service.nirvanix.apiDocumentation"><div class="info"><h1 class="title">API ドキュメント</h1></div>
        

        <p class="para">
            Nirvanix <acronym class="acronym">IMFS</acronym> へのアクセス方法には、<acronym class="acronym">SOAP</acronym> を使用する方法と
            (より高速な) REST サービスを使用する方法があります。
            <span class="classname">Zend_Service_Nirvanix</span>
            は、REST サービスに対する比較的軽量な <acronym class="acronym">PHP</acronym> 5 ラッパーを提供します。
        </p>

        <p class="para">
            <span class="classname">Zend_Service_Nirvanix</span> の狙いは
            Nirvanix REST サービスをより簡単に使用できるようにすることですが、
            Nirvanix サービス自体についてきちんと理解しておくことも大切です。
        </p>

        <p class="para">
            <a href="http://developer.nirvanix.com/sitefiles/1000/API.html" class="link external">&raquo; Nirvanix <acronym class="acronym">API</acronym> Documentation</a>
            に、このサービスについての概要から詳細な情報までがまとめられています。
            このドキュメントを熟読し、
            <span class="classname">Zend_Service_Nirvanix</span>
            を使う際にも常に参照するようにしましょう。
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.features" name="zend.service.nirvanix.features"><div class="info"><h1 class="title">機能</h1></div>
        

        <p class="para">
            Nirvanix の REST サービスは、<acronym class="acronym">PHP</acronym> の
            <a href="http://www.php.net/simplexml" class="link external">&raquo; SimpleXML</a>
            拡張モジュールと <span class="classname">Zend_Http_Client</span>
            を使うだけでもうまく操作できます。しかしこの方法だと、
            リクエスト時にセッショントークンを毎回渡したり、
            レスポンスの内容を確認してエラーコードを調べたりといった繰り返し処理が面倒です。
        </p>

        <p class="para">
            <span class="classname">Zend_Service_Nirvanix</span> には次のような機能があります。

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        Nirvanix の認証情報を一元管理し、
                        Nirvanix 名前空間内で使いまわします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        HTTP クライアントをそのまま使うよりもより便利なプロキシオブジェクトを用意し、
                        REST サービスへのアクセス時に毎回 HTTP POST
                        リクエストを手で作成させるような手間を省きます。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        レスポンスオブジェクトのラッパーを用意し、
                        レスポンスをパースしてエラー時には例外をスローするようにします。
                        これにより、コマンドが成功したかどうかを調べるような
                        面倒くさい処理を軽減させることができます。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        ありがちな操作を行うための、便利なメソッドを提供します。
                    </p>
                </li>
            </ul>
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.storing-your-first" name="zend.service.nirvanix.storing-your-first"><div class="info"><h1 class="title">さぁはじめましょう</h1></div>
        

        <p class="para">
            Nirvanix への登録をすませたら、
            <acronym class="acronym">IMFS</acronym> 上にファイルを格納する準備は完了です。
            <acronym class="acronym">IMFS</acronym> 上で必要となる作業として最もよくあるものは、
            新規ファイルの作成や既存ファイルのダウンロード、
            そしてファイルの削除といったところでしょう。
            <span class="classname">Zend_Service_Nirvanix</span>
            には、これら 3 つの操作のための便利なメソッドが用意されています。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$auth</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'your-username'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'your-password'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'appKey'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'your-app-key'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$nirvanix</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Service_Nirvanix<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$auth</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$imfs</span> = <span style="color: #0000ff;">$nirvanix</span>-&gt;<span style="color: #006600;">getService</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'IMFS'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$imfs</span>-&gt;<span style="color: #006600;">putContents</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/foo.txt'</span>, <span style="color: #ff0000;">'contents to store'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$imfs</span>-&gt;<span style="color: #006600;">getContents</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/foo.txt'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$imfs</span>-&gt;<span style="color: #006600;">unlink</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/foo.txt'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            <span class="classname">Zend_Service_Nirvanix</span>
            を利用する際の最初の手続きは常に、サービスに対する認証となります。
            これは、認証情報を上のように <span class="classname">Zend_Service_Nirvanix</span>
            のコンストラクタに渡すことで行います。
            連想配列の内容が、Nirvanix に対する POST パラメータとして直接渡されます。
        </p>

        <p class="para">
            Nirvanix は、ウェブサービスを
            <a href="http://developer.nirvanix.com/sitefiles/1000/API.html#_Toc175999879" class="link external">&raquo; 名前空間</a>
            で区別しています。個々の名前空間が、関連する操作群をカプセル化しています。
            <span class="classname">Zend_Service_Nirvanix</span> のインスタンスを取得したら、
             <span class="methodname">getService()</span> メソッドをコールして
            使いたい名前空間へのプロキシを作成します。
            上の例では、<code class="code">IMFS</code> 名前空間へのプロキシを作成しています。
        </p>

        <p class="para">
            使いたい名前空間へのプロキシを取得したら、そのメソッドをコールします。
            プロキシ上では、REST <acronym class="acronym">API</acronym> の任意のコマンドを使用できます。
            また、プロキシにはウェブサービスのコマンドをラップする便利なメソッドも用意されています。
            上の例では、<acronym class="acronym">IMFS</acronym> の便利なメソッドを使用して新規ファイルを作成し、
            それを取得して表示し、最後にファイルを削除しています。
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.understanding-proxy" name="zend.service.nirvanix.understanding-proxy"><div class="info"><h1 class="title">プロキシについて</h1></div>
        

        <p class="para">
            先ほどの理恵では、 <span class="methodname">getService()</span> メソッドを使用して
            <code class="code">IMFS</code> 名前空間へのプロキシオブジェクトを取得しました。
            このプロキシオブジェクトを使用すると、Nirvanix の REST
            サービスを通常の <acronym class="acronym">PHP</acronym> のメソッドコールと同じ方式で行うことができます。
            自分で HTTP リクエストオブジェクトを作成する方式ではこのようにはいきません。
        </p>

        <p class="para">
            プロキシオブジェクトには、その他の便利なメソッドも用意されています。
            <span class="classname">Zend_Service_Nirvanix</span> が用意するこれらのメソッドを使用すれば、
            Nirvanix ウェブサービスをよりシンプルに使用できます。
            先ほどの例では
             <span class="methodname">putContents()</span> や  <span class="methodname">getContents()</span>、
            そして  <span class="methodname">unlink()</span> といったメソッドを使用していますが、
            REST <acronym class="acronym">API</acronym> にはこれらに直接対応するものは存在しません。
            これらのメソッドは <span class="classname">Zend_Service_Nirvanix</span>
            が提供しているもので、REST <acronym class="acronym">API</acronym> 上でのより複雑な操作を抽象化したものです。
        </p>

        <p class="para">
            プロキシオブジェクトに対するその他のすべてのメソッドコールは、
            プロキシによって動的に変換され、同等の REST <acronym class="acronym">API</acronym>
            に対する HTTP POST リクエストとなります。
            これは、メソッド名を <acronym class="acronym">API</acronym> のコマンドとして使用し、
            最初の引数に渡した連想配列を POST パラメータとして使用します。
        </p>

        <p class="para">
            たとえば、REST <acronym class="acronym">API</acronym> のメソッド
            <a href="http://developer.nirvanix.com/sitefiles/1000/API.html#_Toc175999923" class="link external">&raquo; RenameFile</a>
            をコールすることを考えてみましょう。このメソッドに対応する便利なメソッドは
            <span class="classname">Zend_Service_Nirvanix</span> には用意されていません。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$auth</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'your-username'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'your-password'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'appKey'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'your-app-key'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$nirvanix</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Service_Nirvanix<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$auth</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$imfs</span> = <span style="color: #0000ff;">$nirvanix</span>-&gt;<span style="color: #006600;">getService</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'IMFS'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$imfs</span>-&gt;<span style="color: #006600;">renameFile</span><span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'filePath'</span> =&gt; <span style="color: #ff0000;">'/path/to/foo.txt'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'newFileName'</span> =&gt; <span style="color: #ff0000;">'bar.txt'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            上の例では、<code class="code">IMFS</code> 名前空間へのプロキシを作成します。
            そして、プロキシ上で  <span class="methodname">renameFile()</span> メソッドをコールします。
            このメソッドは <acronym class="acronym">PHP</acronym> のコード上では定義されていないので、
             <span class="methodname">__call()</span> に渡されます。
            そして、REST <acronym class="acronym">API</acronym> に対する POST リクエストに変換され、
            連想配列を POST パラメータとして使用します。
        </p>

        <p class="para">
            Nirvanix の <acronym class="acronym">API</acronym> ドキュメントには、このメソッドには <code class="code">sessionToken</code>
            が必須であるとかかれていますが、プロキシオブジェクトにこれを渡していません。
            これは、利便性を考慮して自動的に付加されるようになっています。
        </p>

        <p class="para">
            この操作の結果は <span class="classname">Zend_Service_Nirvanix_Response</span>
            オブジェクトで返されます。これは Nirvanix が返す XML
            をラップしたものです。エラーが発生した場合は
            <span class="classname">Zend_Service_Nirvanix_Exception</span>
            を返します。
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.examining-results" name="zend.service.nirvanix.examining-results"><div class="info"><h1 class="title">結果の吟味</h1></div>
        

        <p class="para">
            Nirvanix の REST <acronym class="acronym">API</acronym> は、常に結果を XML で返します。
            <span class="classname">Zend_Service_Nirvanix</span> は、この XML を
            <code class="code">SimpleXML</code> 拡張モジュールでパースして、
            結果として得られた <code class="code">SimpleXMLElement</code>
            を <span class="classname">Zend_Service_Nirvanix_Response</span>
            オブジェクトに変換します。
        </p>

        <p class="para">
            サービスから返された結果の内容を調べるいちばん簡単な方法は、
            <acronym class="acronym">PHP</acronym> の組み込み関数である  <span class="methodname">print_r()</span>
            などを使用することです。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$auth</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'your-username'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'your-password'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'appKey'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'your-app-key'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$nirvanix</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Service_Nirvanix<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$auth</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$imfs</span> = <span style="color: #0000ff;">$nirvanix</span>-&gt;<span style="color: #006600;">getService</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'IMFS'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$imfs</span>-&gt;<span style="color: #006600;">putContents</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/foo.txt'</span>, <span style="color: #ff0000;">'fourteen bytes'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/print_r"><span style="color: #000066;">print_r</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Service_Nirvanix_Response Object</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#91;</span>_sxml:protected<span style="color: #66cc66;">&#93;</span> =&gt; SimpleXMLElement Object</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#91;</span>ResponseCode<span style="color: #66cc66;">&#93;</span> =&gt; <span style="color: #cc66cc;">0</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#91;</span>FilesUploaded<span style="color: #66cc66;">&#93;</span> =&gt; <span style="color: #cc66cc;">1</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#91;</span>BytesUploaded<span style="color: #66cc66;">&#93;</span> =&gt; <span style="color: #cc66cc;">14</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span></div></li></ol></div></div></div>


        <p class="para">
            <code class="code">SimpleXMLElement</code> の任意のプロパティやメソッドにアクセスできます。
            上の例では、<code class="code">$result-&gt;BytesUploaded</code> を使用して
            取得したバイト数を調べています。<code class="code">SimpleXMLElement</code>
            に直接アクセスしたい場合は <code class="code">$result-&gt;getSxml()</code> を使用します。
        </p>

        <p class="para">
            Nirvanix からの帰り値のほとんどは、成功を表すもの (<code class="code">ResponseCode</code> がゼロ)
            です。通常は <code class="code">ResponseCode</code> をチェックする必要はありません。
            というのも、結果がゼロ以外になる場合は
            <span class="classname">Zend_Service_Nirvanix_Exception</span> がスローされるからです。
            エラー処理については次のセクションを参照ください。
        </p>
    </div>

    <div class="section" id="zend.service.nirvanix.handling-errors" name="zend.service.nirvanix.handling-errors"><div class="info"><h1 class="title">エラー処理</h1></div>
        

        <p class="para">
            Nirvanix を使用する際には、
            サービスからエラーが返されることも想定して
            適切にエラー処理を行うようにすることが大切です。
        </p>

        <p class="para">
            REST サービスに対するすべて操作の結果は XML で返され、
            その中には <code class="code">ResponseCode</code> 要素が含まれています。
            たとえば次のようになります。
        </p>

        <div class="programlisting xml"><div class="xmlcode"><div class="xml" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;Response<span style="font-weight: bold; color: black;">&gt;</span></span></span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp;<span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;ResponseCode<span style="font-weight: bold; color: black;">&gt;</span></span></span>0<span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;/ResponseCode<span style="font-weight: bold; color: black;">&gt;</span></span></span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #009900;"><span style="font-weight: bold; color: black;">&lt;/Response<span style="font-weight: bold; color: black;">&gt;</span></span></span></div></li></ol></div></div></div>


        <p class="para">
            上の例のように <code class="code">ResponseCode</code> がゼロの場合は、
            その操作が成功したことを表します。操作が成功しなかった場合は
            <code class="code">ResponseCode</code> がゼロ以外の値となり、さらに
            <code class="code">ErrorMessage</code> 要素が含まれるようになります。
        </p>

        <p class="para">
            <code class="code">ResponseCode</code> がゼロでないかどうかを
            毎回チェックするのは手間がかかるので、
            <span class="classname">Zend_Service_Nirvanix</span> は自動的に
            Nirvanix が返す各レスポンスの内容をチェックします。
            <code class="code">ResponseCode</code> がエラーを表す値であった場合は
            <span class="classname">Zend_Service_Nirvanix_Exception</span> がスローされます。
        </p>

        <div class="programlisting xml"><div class="xmlcode"><div class="xml" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">$auth = array('username' =&gt; 'your-username',</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'password' =&gt; 'your-password',</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 'appKey'&nbsp; &nbsp;=&gt; 'your-app-key');</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">$nirvanix = new Zend_Service_Nirvanix($auth);</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">try {</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; $imfs = $nirvanix-&gt;getService('IMFS');</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; $imfs-&gt;unlink('/a-nonexistant-path');</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">} catch (Zend_Service_Nirvanix_Exception $e) {</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; echo $e-&gt;getMessage() . &quot;\n&quot;;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; echo $e-&gt;getCode();</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">}</div></li></ol></div></div></div>


        <p class="para">
            上の例で使用している  <span class="methodname">unlink()</span> は、REST <acronym class="acronym">API</acronym> の
            <code class="code">DeleteFiles</code> コマンドをラップした便利なメソッドです。
            <a href="http://developer.nirvanix.com/sitefiles/1000/API.html#_Toc175999918" class="link external">&raquo; DeleteFiles</a>
            コマンドが要求する<code class="code">filePath</code> パラメータに、
            存在しないパスを指定しています。その結果、
            <span class="classname">Zend_Service_Nirvanix</span> からは例外がスローされます。
            メッセージは &quot;Invalid path&quot;、そしてコードは 70005 となります。
        </p>

        <p class="para">
            <a href="http://developer.nirvanix.com/sitefiles/1000/API.html" class="link external">&raquo; Nirvanix
            <acronym class="acronym">API</acronym> ドキュメント</a> に、各コマンドに関連するエラーが説明されています。
            必要に応じて、各コマンドを <code class="code">try</code> ブロックでラップするようにしましょう。
            あるいは複数のコマンドをひとつの <code class="code">try</code> ブロックにまとめてもかまいません。
        </p>
    </div>

</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.service.livedocx.html">Zend_Service_LiveDocx</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.service.html">Zend_Service</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.service.recaptcha.html">Zend_Service_ReCaptcha(日本語)</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.service.html">Zend_Service</a></li>
  <li><a href="zend.service.introduction.html">導入</a></li>
  <li><a href="zend.service.akismet.html">Zend_Service_Akismet(日本語)</a></li>
  <li><a href="zend.service.amazon.html">Zend_Service_Amazon(日本語)</a></li>
  <li><a href="zend.service.amazon.ec2.html">Zend_Service_Amazon_Ec2(日本語)</a></li>
  <li><a href="zend.service.amazon.ec2.instance.html">Zend_Service_Amazon_Ec2: Instances</a></li>
  <li><a href="zend.service.amazon.ec2.windows.instance.html">Zend_Service_Amazon_Ec2: Windows Instances</a></li>
  <li><a href="zend.service.amazon.ec2.reserved.instance.html">Zend_Service_Amazon_Ec2: Reserved Instances</a></li>
  <li><a href="zend.service.amazon.ec2.cloudwatch.html">Zend_Service_Amazon_Ec2: CloudWatch Monitoring</a></li>
  <li><a href="zend.service.amazon.ec2.images.html">Zend_Service_Amazon_Ec2: Amazon Machine Images (AMI)</a></li>
  <li><a href="zend.service.amazon.ec2.ebs.html">Zend_Service_Amazon_Ec2: Elastic Block Storage (EBS)</a></li>
  <li><a href="zend.service.amazon.ec2.elasticip.html">Zend_Service_Amazon_Ec2: Elastic IP Addresses</a></li>
  <li><a href="zend.service.amazon.ec2.keypairs.html">Zend_Service_Amazon_Ec2: Keypairs(日本語)</a></li>
  <li><a href="zend.service.amazon.ec2.zones.html">Zend_Service_Amazon_Ec2:リージョンおよび利用可能ゾーン</a></li>
  <li><a href="zend.service.amazon.ec2.securitygroups.html">Zend_Service_Amazon_Ec2: Security Groups</a></li>
  <li><a href="zend.service.amazon.s3.html">Zend_Service_Amazon_S3</a></li>
  <li><a href="zend.service.amazon.sqs.html">Zend_Service_Amazon_Sqs</a></li>
  <li><a href="zend.service.audioscrobbler.html">Zend_Service_Audioscrobbler(日本語)</a></li>
  <li><a href="zend.service.delicious.html">Zend_Service_Delicious(日本語)</a></li>
  <li><a href="zend.service.developergarden.html">Zend_Service_DeveloperGarden</a></li>
  <li><a href="zend.service.ebay.html">Zend_Service_Ebay</a></li>
  <li><a href="zend.service.ebay.finding.html">Zend_Service_Ebay_Finding</a></li>
  <li><a href="zend.service.flickr.html">Zend_Service_Flickr(日本語)</a></li>
  <li><a href="zend.service.livedocx.html">Zend_Service_LiveDocx</a></li>
  <li class="active"><a href="zend.service.nirvanix.html">Zend_Service_Nirvanix(日本語)</a></li>
  <li><a href="zend.service.recaptcha.html">Zend_Service_ReCaptcha(日本語)</a></li>
  <li><a href="zend.service.short-url.html">Zend_Service_ShortUrl</a></li>
  <li><a href="zend.service.simpy.html">Zend_Service_Simpy(日本語)</a></li>
  <li><a href="zend.service.slideshare.html">Zend_Service_SlideShare(日本語)</a></li>
  <li><a href="zend.service.strikeiron.html">Zend_Service_StrikeIron(日本語)</a></li>
  <li><a href="zend.service.strikeiron.bundled-services.html">Zend_Service_StrikeIron: バンドルされているサービス</a></li>
  <li><a href="zend.service.strikeiron.advanced-uses.html">Zend_Service_StrikeIron: 応用編</a></li>
  <li><a href="zend.service.technorati.html">Zend_Service_Technorati(日本語)</a></li>
  <li><a href="zend.service.twitter.html">Zend_Service_Twitter</a></li>
  <li><a href="zend.service.windowsazure.html">Zend_Service_WindowsAzure</a></li>
  <li><a href="zend.service.windowsazure.storage.blob.html">Zend_Service_WindowsAzure_Storage_Blob</a></li>
  <li><a href="zend.service.windowsazure.diagnostics.manager.html">Zend_Service_WindowsAzure_Diagnostics_Manager</a></li>
  <li><a href="zend.service.windowsazure.storage.queue.html">Zend_Service_WindowsAzure_Storage_Queue</a></li>
  <li><a href="zend.service.windowsazure.storage.table.html">Zend_Service_WindowsAzure_Storage_Table</a></li>
  <li><a href="zend.service.yahoo.html">Zend_Service_Yahoo(日本語)</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>