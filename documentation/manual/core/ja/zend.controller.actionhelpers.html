<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>アクションヘルパー - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.controller.action.html">アクションコントローラ</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.controller.html">Zend_Controller</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.controller.response.html">レスポンスオブジェクト</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.controller.actionhelpers" class="section"><div class="info"><h1 class="title">アクションヘルパー</h1></div>
    

    <div class="section" id="zend.controller.actionhelper.introduction" name="zend.controller.actionhelper.introduction"><div class="info"><h1 class="title">導入</h1></div>
        

        <p class="para">
            アクションヘルパーを使用すると、<span class="classname">Zend_Controller_Action</span>
            を継承した任意のアクションコントローラに対して
            実行時やその他必要に応じて機能を追加できます。
            アクションヘルパーの狙いは、
            アクションコントローラに共通機能を追加するために
            いちいち抽象クラスを継承する手間を省くことにあります。
        </p>

        <p class="para">
            アクションヘルパーにはさまざまな使用法があります。
            たとえば、<a href="zend.view.helpers.html" class="link">Zend_View_Helper</a>
            や <a href="zend.controller.plugins.html" class="link">Zend_Controller_Plugin</a>
            と同じように、処理の仲買をするために用いることもできます。
            アクションヘルパーは (<span class="classname">Zend_View_Helper</span> と同様に)、
            必要になった時点で読み込むこともできますし、
            リクエスト時 (起動時) やアクションコントローラの作成時 ( <span class="methodname">init()</span>)
            で読み込むこともできます。詳細は、以下の使用例を参照ください。
        </p>
    </div>

    <div class="section" id="zend.controller.actionhelper.initialization" name="zend.controller.actionhelper.initialization"><div class="info"><h1 class="title">ヘルパーの初期化</h1></div>
        

        <p class="para">
            ヘルパーを初期化するにはいくつかの方法があります。
            必要に応じて、またそのヘルパーの機能に応じて使い分けましょう。
        </p>

        <p class="para">
            ヘルパーブローカは、<span class="classname">Zend_Controller_Action</span>
            の <var class="varname">$_helper</var> に格納されます。
            このブローカを使用して、ヘルパーを取得したりコールしたりします。
            以下のような方法があります。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                    明示的に  <span class="methodname">getHelper()</span> を使用します。
                    ヘルパーの名前を指定すると、
                    そのヘルパーオブジェクトが返されます。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$flashMessenger</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'FlashMessenger'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$flashMessenger</span>-&gt;<span style="color: #006600;">addMessage</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'先ほどのリクエストで、あることをしました'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </li>

            <li class="listitem">
                <p class="para">
                    ヘルパーブローカの  <span class="methodname">__get()</span> 機能を使用すると、
                    まるでブローカのプロパティであるかのようにヘルパーを操作できます。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$flashMessenger</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">FlashMessenger</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$flashMessenger</span>-&gt;<span style="color: #006600;">addMessage</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'先ほどのリクエストで、あることをしました'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </li>

            <li class="listitem">
                <p class="para">
                    たいていのアクションヘルパーは
                     <span class="methodname">direct()</span> メソッドを実装しており、
                    これはそのヘルパーのデフォルトメソッドをコールします。
                     <span class="methodname">FlashMessenger</span> の例では、
                     <span class="methodname">addMessage()</span> をコールします。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">FlashMessenger</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'先ほどのリクエストで、あることをしました'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </li>
        </ul>

        <blockquote><p><b class="note">Note</b>: 
            これらの例は、すべて同じことを行っています。<br />
        </p></blockquote>

        <p class="para">
            ヘルパーのインスタンスを明示的に作成したいと考えるかもしれません。
            たとえばアクションコントローラ以外からヘルパーを使用したいだとか、
            すべてのアクションのヘルパーブローカに同じヘルパーを渡したいだとかいった場合です。
            インスタンスを作成する方法は、通常の <acronym class="acronym">PHP</acronym> のクラスと同じです。
        </p>
    </div>

    <div class="section" id="zend.controller.actionhelper.broker" name="zend.controller.actionhelper.broker"><div class="info"><h1 class="title">ヘルパーブローカ</h1></div>
        

        <p class="para">
            <span class="classname">Zend_Controller_Action_HelperBroker</span>
            がヘルパーオブジェクトやそのパスの登録に関する詳細を処理します。
            また、必要に応じてそこからヘルパーを取得できます。
        </p>

        <p class="para">
            ヘルパーをブローカに登録するには
             <span class="methodname">addHelper()</span> を使用します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">addHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$helper</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            もちろん、ヘルパーのインスタンスを作成してそれをブローカに渡すという作業は
            時間とリソースを消費します。これらの作業の手間をほんの少し省くためのメソッドとして、
             <span class="methodname">addPrefix()</span> と
             <span class="methodname">addPath()</span> が用意されています。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">addPrefix()</span> はクラスのプレフィックスを受け取り、
                    それをもとにヘルパークラスのパスを決定します。
                    プレフィックスが、Zend Framework のクラス命名規約に沿っているものとみなして、
                    パスを決定します。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// My/Action/Helpers/ にある、名前が My_Action_Helpers で始まるヘルパーを追加します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">addPrefix</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'My_Action_Helpers'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">addPath()</span> は、最初の引数にディレクトリ、
                    そして二番目の引数にクラスのプレフィックス
                    (デフォルトは &#039;<span class="classname">Zend_Controller_Action_Helper</span>&#039;) を指定します。
                    これは、指定したディレクトリにある指定したプレフィックスのクラスを追加します。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Plugins/Helpers/ にある、名前が Helper で始まるヘルパーを追加します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">addPath</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'./Plugins/Helpers'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ff0000;">'Helper'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </li>
        </ul>

        <p class="para">
            これらは静的メソッドなので、コントローラチェイン内の任意の場所で使用できます。
            これにより、必要に応じて動的にヘルパーを追加できることになります。
        </p>

        <p class="para">
            内部的には、ヘルパーブローカは <a href="zend.loader.pluginloader.html" class="link">PluginLoader
                のインスタンス</a> を用いてパスを保持します。静的メソッド
             <span class="methodname">getPluginLoader()</span> で PluginLoader
            を取得することもできますし、また独自の PluginLoader
            インスタンスを  <span class="methodname">setPluginLoader()</span> で設定することもできます。
        </p>

        <p class="para">
            ヘルパークラスがヘルパーブローカ内に存在するかどうかを調べるには
             <span class="methodname">hasHelper($name)</span> を使用します。<var class="varname">$name</var>
            には、ヘルパーのショートネーム (プレフィックスを除いたもの)
            を指定します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 'redirector' ヘルパーがブローカに登録されているかどうかを調べます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>Zend_Controller_Action_HelperBroker::<span style="color: #006600;">hasHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'redirector'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #ff0000;">'Redirector helper registered'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


        <p class="para">
            ヘルパーブローかからヘルパーを取得する静的メソッドには、さらに
             <span class="methodname">getExistingHelper()</span> と
             <span class="methodname">getStaticHelper()</span> のふたつがあります。
             <span class="methodname">getExistingHelper()</span> は、すでに起動されているか、
            あるいは明示的にヘルパーブローカに登録されているヘルパーのみを取得します。
            存在しない場合は例外をスローします。
             <span class="methodname">getStaticHelper()</span> は
             <span class="methodname">getExistingHelper()</span> と同じですが、
            ヘルパースタックに登録されていないヘルパーについてはそのインスタンスを作成しようとします。
            自分で設定をしたいヘルパーを取得するには
             <span class="methodname">getStaticHelper()</span> がおすすめです。
        </p>

        <p class="para">
            どちらのメソッドも、引数はひとつだけです。
            この引数 <var class="varname">$name</var>
            には、ヘルパーのショートネーム (プレフィックスを除いたもの)
            を指定します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 'redirector' ヘルパーがブローカに登録されているかどうかを調べ、取得します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>Zend_Controller_Action_HelperBroker::<span style="color: #006600;">hasHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'redirector'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$redirector</span> =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; Zend_Controller_Action_HelperBroker::<span style="color: #006600;">getExistingHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'redirector'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// あるいは、登録されているかどうかを気にせずに単純に取得します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$redirector</span> =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Controller_Action_HelperBroker::<span style="color: #006600;">getStaticHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'redirector'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


        <p class="para">
            最後に、登録済みのヘルパーをブローカから削除するには
             <span class="methodname">removeHelper($name)</span> を使用します。<var class="varname">$name</var>
            には、ヘルパーのショートネーム (プレフィックスを除いたもの)
            を指定します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 'redirector' ヘルパーがブローカに登録されている場合にはそれを削除します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>Zend_Controller_Action_HelperBroker::<span style="color: #006600;">hasHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'redirector'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Controller_Action_HelperBroker::<span style="color: #006600;">removeHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'redirector'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.controller.actionhelper.stockhelpers" name="zend.controller.actionhelper.stockhelpers"><div class="info"><h1 class="title">組み込みのアクションヘルパー</h1></div>
        

        <p class="para">
            Zend Framework には、いくつかのアクションヘルパーがデフォルトで組み込まれています。
            <acronym class="acronym">AJAX</acronym> のオートコンプリート機能用のレスポンスを作成する <em class="emphasis">AutoComplete</em>、
            アクションに応じてレスポンスの形式を変更する <em class="emphasis">ContextSwitch</em> と
            <em class="emphasis">AjaxContext</em>、セッション単位のフラッシュメッセージを扱う
            <em class="emphasis">FlashMessenger</em>、<acronym class="acronym">JSON</acronym> 形式へのエンコードとレスポンスの送信を行う
            <em class="emphasis">Json</em>、
            アプリケーション内から内部あるいは外部へのリダイレクトを実装できるようにする
            <em class="emphasis">Redirector</em>、そして
            コントローラ内でのビューオブジェクトの設定とビューのレンダリングを自動化する
            <em class="emphasis">ViewRenderer</em> です。
        </p>

        <div class="section" id="zend.controller.actionhelpers.actionstack" name="zend.controller.actionhelpers.actionstack"><div class="info"><h1 class="title">ActionStack(日本語)</h1></div>
    

    <p class="para">
        <em class="emphasis">ActionStack</em> ヘルパーは、リクエストをフロントコントローラの
        <a href="zend.controller.plugins.html#zend.controller.plugins.standard.actionstack" class="link">ActionStack</a>
        プラグインに格納します。これにより、
        リクエストの実行時にアクションのキューを作成しやすくなります。
        このヘルパーは、アクションを追加する際に
        新しいリクエストオブジェクトを指定するか
        アクション - コントローラ - モジュール の設定を指定するかのいずれかを用います。
    </p>

    <blockquote><p><b class="note">Note</b>: <span class="info"><b>ActionStack ヘルパーを起動すると ActionStack プラグインが初期化される</b><br /></span>
        

        
            <em class="emphasis">ActionStack</em> を起動すると、暗黙のうちに
            <em class="emphasis">ActionStack</em> プラグインを登録します。
            つまり、この機能を使う際に明示的に <em class="emphasis">ActionStack</em>
            プラグインを登録する必要はないということです。
        <br />
    </p></blockquote>

    <div class="example"><div class="info"><p><b>Example #1 アクション、コントローラおよびモジュール名によるタスクの追加</b></p></div>
        

        <div class="example-contents"><p>
            単純にアクションとコントローラそしてモジュール
            (およびオプションでリクエストパラメータ)
            を指定して  <span class="methodname">Zend_Controller_Action::_forward()</span>
            をコールするのが一番シンプルな方法です。
        </p></div>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> barAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 2 つのアクションをスタックに格納して</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// /foo/baz/bar/baz をコールします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// (FooController::bazAction() にリクエスト変数 bar == baz を指定したもの)</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">actionStack</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'baz'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'foo'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'default'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bar'</span> =&gt; <span style="color: #ff0000;">'baz'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// /bar/bat のコール</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// (BarController::batAction()) を追加します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">actionStack</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bat'</span>, <span style="color: #ff0000;">'bar'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


    </div>

    <div class="example"><div class="info"><p><b>Example #2 リクエストオブジェクトによるタスクの追加</b></p></div>
        

        <div class="example-contents"><p>
            時にはリクエストオブジェクトのオブジェクト指向的な部分が使いたいこともあるでしょう。
            そんな場合はこのオブジェクトを <em class="emphasis">ActionStack</em>
            ヘルパーに渡すこともできます。
        </p></div>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> barAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 2 つのアクションをスタックに格納して</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// /foo/baz/bar/baz をコールします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// (FooController::bazAction() にリクエスト変数 bar == baz を指定したもの)</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$request</span> = clone <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getRequest</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// コントローラやモジュールは指定せず、現在の値を使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$request</span>-&gt;<span style="color: #006600;">setActionName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'baz'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">setParams</span><span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bar'</span> =&gt; <span style="color: #ff0000;">'baz'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">actionStack</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$request</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// /bar/bat のコール</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// (BarController::batAction()) を追加します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$request</span> = clone <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getRequest</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// モジュールは指定せず、現在の値を使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$request</span>-&gt;<span style="color: #006600;">setActionName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bat'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">setControllerName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bar'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">actionStack</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$request</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

    </div>
</div>
        <div class="section" id="zend.controller.actionhelpers.autocomplete" name="zend.controller.actionhelpers.autocomplete"><div class="info"><h1 class="title">AutoComplete</h1></div>
    

    <p class="para">
        多くの <acronym class="acronym">AJAX</acronym> 用 javascript ライブラリでは、
        オートコンプリート機能を提供しています。
        これは、ユーザがタイプした内容にマッチする可能性のある候補の一覧を表示するものです。
        <em class="emphasis">AutoComplete</em> ヘルパーは、
        このような場合に使用できるレスポンスを返すためのものです。
    </p>

    <p class="para">
        オートコンプリート機能の実装方法は JS ライブラリによって異なるので、
        <em class="emphasis">AutoComplete</em> では多くのライブラリで使用する共通機能を抽象化しています。
        そして、個々のライブラリにあわせた実装を用意しています。
        返り値の型は、<acronym class="acronym">JSON</acronym> 形式の文字列の配列か
        <acronym class="acronym">JSON</acronym> 形式の配列の配列
        (内部の配列は、選択リストを作成する際に使用するメタデータの連想配列)
        あるいは <acronym class="acronym">HTML</acronym> となります。
    </p>

    <p class="para">
        どの実装についての基本的な使用法は同じです。
    </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> barAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何かの処理をします...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// エンコードしたレスポンスを送信します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">autoCompleteDojo</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// あるいは明示的に</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$response</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">autoCompleteDojo</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">sendAutoCompletion</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// あるいは単純にオートコンプリート用のレスポンスを準備します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$response</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">autoCompleteDojo</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">prepareAutoCompletion</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


    <p class="para">
        デフォルトでは以下のような作業を行います。
    </p>

    <ul class="itemizedlist">
        <li class="listitem"><p class="para">
                レイアウト機能と ViewRenderer を無効にする。
        </p></li>

        <li class="listitem"><p class="para">
                適切なレスポンスヘッダを設定する。
        </p></li>

        <li class="listitem"><p class="para">
                レスポンスボディにエンコード/フォーマットしたデータを設定する。
        </p></li>

        <li class="listitem"><p class="para">
                レスポンスを送信する。
        </p></li>
    </ul>

    <p class="para">
        このヘルパーでは次のようなメソッドが使用できます。
    </p>

    <ul class="itemizedlist">
        <li class="listitem"><p class="para">
                 <span class="methodname">disableLayouts()</span> は、レイアウト機能と
                ViewRenderer を無効にします。一般に、これは
                 <span class="methodname">prepareAutoCompletion()</span> の中でコールされます。
        </p></li>

        <li class="listitem"><p class="para">
                 <span class="methodname">encodeJson($data, $keepLayouts = false)</span>
                はデータを <acronym class="acronym">JSON</acronym> 形式にエンコードし、オプションでレイアウト機能の有効/無効
                を切り替えます。一般に、これは
                 <span class="methodname">prepareAutoCompletion()</span> の中でコールされます。
        </p></li>

        <li class="listitem"><p class="para">
                 <span class="methodname">prepareAutoCompletion($data, $keepLayouts = false)</span>
                は、各種具象実装にあわせてレスポンスデータをフォーマットし、
                オプションでレイアウト機能の有効/無効を切り替えます。
                返り値は実装によって異なります。
        </p></li>

        <li class="listitem"><p class="para">
                 <span class="methodname">sendAutoCompletion($data, $keepLayouts = false)</span>
                は、各種具象実装にあわせてフォーマットしたレスポンスデータを送信します。
                これは、 <span class="methodname">prepareAutoCompletion()</span> をコールしたあとでレスポンスを送信します。
        </p></li>

        <li class="listitem"><p class="para">
                 <span class="methodname">direct($data, $sendNow = true, $keepLayouts =
                    false)</span> は、このヘルパーをヘルパーブローカのメソッドとしてコールする場合に使用します。
                <var class="varname">$sendNow</var> フラグは、
                 <span class="methodname">sendAutoCompletion()</span> と
                 <span class="methodname">prepareAutoCompletion()</span> のどちらをコールするかを指定するものです。
        </p></li>
    </ul>

    <p class="para">
        現在 <em class="emphasis">AutoComplete</em> がサポートしている <acronym class="acronym">AJAX</acronym>
        ライブラリは、Dojo と Scriptaculous です。
    </p>

    <div class="section" id="zend.controller.actionhelpers.autocomplete.dojo" name="zend.controller.actionhelpers.autocomplete.dojo"><div class="info"><h1 class="title">Dojo でのオートコンプリート</h1></div>
        

        <p class="para">
            Dojo には、オートコンプリートのためだけのウィジェットはありません。
            しかし、ComboBox と FilteringSelect
            のふたつのウィジェットがオートコンプリート機能を持っています。
            どちらのウィジェットも、QueryReadStore
            を実装したデータを必要とします。詳細は
            <a href="http://dojotoolkit.org/reference-guide/dojo/data.html" class="link external">&raquo; dojo.data</a>
            のドキュメントを参照ください。
        </p>

        <p class="para">
            Zend Framework では、単純な数値添字の配列を
            AutoCompleteDojo ヘルパーに渡します。
            そうすると、適切な形式の <acronym class="acronym">JSON</acronym> オブジェクトを返します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// コントローラのアクション内で</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">autoCompleteDojo</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <div class="example"><div class="info"><p><b>Example #3 Zend MVC を使用した、Dojo でのオートコンプリート</b></p></div>
            

            <div class="example-contents"><p>
                Zend <acronym class="acronym">MVC</acronym> で Dojo によるオートコンプリートを使用するには、
                いくつかの準備が必要です。オートコンプリートを使用したい
                ComboBox 用にフォームオブj稀有とを作成し、
                オートコンプリートの結果を提供するためのコントローラアクションを作成し、
                オートコンプリートアクションに接続するための
                独自の QueryReadStore を作成し、
                サーバ側でオートコンプリートを行わせるための javascript
                を作成することになります。
            </p></div>

            <div class="example-contents"><p>
                まずは、必要となる javascript を見ていきましょう。
                Dojo は javascript によるオブジェクト指向プログラミングを行うための
                完全なフレームワークで、ちょうど <acronym class="acronym">PHP</acronym> における Zend Framework
                のようなものです。その中には、
                ディレクトリ構造を用いて擬似的な名前空間を作成する機能もあります。
                ここでは、Dojo の配布ファイルの Dojo
                ディレクトリと同じ階層に &#039;custom&#039; ディレクトリを作成します。
                そのディレクトリの中に <var class="filename">TestNameReadStore.js</var>
                という javascript ファイルを作成し、次のようなコードを書きます。
            </p></div>

            <div class="programlisting javascript"><div class="javascriptcode"><div class="javascript" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.<span style="color: #006600;">provide</span><span style="color: #66cc66;">&#40;</span><span style="color: #3366CC;">&quot;custom.TestNameReadStore&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.<span style="color: #006600;">declare</span><span style="color: #66cc66;">&#40;</span><span style="color: #3366CC;">&quot;custom.TestNameReadStore&quot;</span>, dojox.<span style="color: #006600;">data</span>.<span style="color: #006600;">QueryReadStore</span>, <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; fetch:<span style="color: #003366; font-weight: bold;">function</span> <span style="color: #66cc66;">&#40;</span>request<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; request.<span style="color: #006600;">serverQuery</span> = <span style="color: #66cc66;">&#123;</span> test:request.<span style="color: #006600;">query</span>.<span style="color: #000066;">name</span> <span style="color: #66cc66;">&#125;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066; font-weight: bold;">return</span> <span style="color: #000066; font-weight: bold;">this</span>.<span style="color: #006600;">inherited</span><span style="color: #66cc66;">&#40;</span><span style="color: #3366CC;">&quot;fetch&quot;</span>, arguments<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <div class="example-contents"><p>
                このクラスは、単に Dojo 自身の QueryReadStore
                クラスを継承したものです。継承元のクラス自体は抽象クラスです。
                そこにリクエスト用のメソッドを定義し、&#039;test&#039;
                要素に割り当てています。
            </p></div>

            <div class="example-contents"><p>
                次に、オートコンプリートを行うためのフォーム要素を作成します。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> TestController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; protected <span style="color: #0000ff;">$_form</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> getForm<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">null</span> === <span style="color: #0000ff;">$this</span>-&gt;_form<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_form = <span style="color: #000000; font-weight: bold;">new</span> Zend_Form<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_form-&gt;<span style="color: #006600;">setMethod</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'get'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">setAction</span><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getRequest</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">getBaseUrl</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> . <span style="color: #ff0000;">'/test/process'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">addElements</span><span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'test'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'type'</span> =&gt; <span style="color: #ff0000;">'text'</span>, <span style="color: #ff0000;">'options'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'filters'</span>&nbsp; &nbsp; &nbsp; &nbsp; =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'StringTrim'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'dojoType'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'dijit.form.ComboBox'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'store'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'testStore'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'autoComplete'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'false'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'hasDownArrow'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'true'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'label'</span> =&gt; <span style="color: #ff0000;">'Your input:'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'go'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'type'</span> =&gt; <span style="color: #ff0000;">'submit'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'options'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'label'</span> =&gt; <span style="color: #ff0000;">'Go!'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #0000ff;">$this</span>-&gt;_form;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


            <div class="example-contents"><p>
                ここでは、単に &#039;test&#039; と &#039;go&#039; メソッドのみを持つフォームを作成します。
                &#039;test&#039; メソッドは、特別な Dojo 固有の属性
                dojoType、store、autoComplete および hasDownArrow
                を追加します。dojoType では、これから ComboBox
                を作成することを指定します。そして、それを &#039;testStore&#039; のデータストア
                (キー &#039;store&#039;) にリンクします。詳細は後ほど説明します。
                &#039;autoComplete&#039; を <b><tt>FALSE</tt></b> に設定することで、
                最初にマッチしたものを自動選択するのではなく
                マッチしたものの一覧を表示するよう Dojo に指示します。
                最後に &#039;hasDownArrow&#039; でセレクトボックス風の下向き矢印を作ります。
                これで、マッチしたものを表示したり隠したりできるようになります。
            </p></div>

            <div class="example-contents"><p>
                では、フォームを表示するためのメソッドと
                オートコンプリートの処理用のエンドポイントを作成してみましょう。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> TestController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* 最初のページ</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> indexAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">view</span>-&gt;<span style="color: #006600;">form</span> = <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getForm</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> autocompleteAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'ajax'</span> != <span style="color: #0000ff;">$this</span>-&gt;_getParam<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'format'</span>, <span style="color: #000000; font-weight: bold;">false</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">redirector</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'index'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getRequest</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">isPost</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span> <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">redirector</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'index'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$match</span> = <a href="http://www.php.net/trim"><span style="color: #000066;">trim</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getRequest</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">getQuery</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'test'</span>, <span style="color: #ff0000;">''</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$matches</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">foreach</span> <span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">getData</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$datum</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">0</span> === <a href="http://www.php.net/strpos"><span style="color: #000066;">strpos</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$datum</span>, <span style="color: #0000ff;">$match</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$matches</span><span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #0000ff;">$datum</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">autoCompleteDojo</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$matches</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


            <div class="example-contents"><p>
                 <span class="methodname">autocompleteAction()</span>
                ではいくつかの作業を行っています。
                まず、POST リクエストを受け取ったことを確実にし、
                &#039;format&#039; パラメータの値を &#039;ajax&#039; に設定します。
                これにより、余計なクエリがアクションに送られることを減らします。
                次に、&#039;test&#039; パラメータの内容を確認し、私たちのデータと比較します
                (ここでは、 <span class="methodname">getData()</span> の実装は意図的に控えています。
                何らかのデータソースを使用することになるでしょう)。
                最後に、マッチした内容を AutoCompletion ヘルパーに送信します。
            </p></div>

            <div class="example-contents"><p>
                これでバックエンド側の準備はすべて整いました。
                次に、ページのビュースクリプト側ではどうすればいいのかを考えてみましょう。
                まず、データストアを用意しなければなりません。
                次にフォームをレンダリングし、最後に適切な Dojo ライブラリ
                (使用するデータストアも含む) を読み込みます。
                ビュースクリプトを見てみましょう。
                適宜コメントを入れてあります。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #808080; font-style: italic;">// データストアの準備 ?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&lt;div dojoType=<span style="color: #ff0000;">&quot;custom.TestNameReadStore&quot;</span> jsId=<span style="color: #ff0000;">&quot;testStore&quot;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; url=<span style="color: #ff0000;">&quot;&lt;?php echo $this-&gt;baseUrl() ?&gt;/unit-test/autocomplete/format/ajax&quot;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; requestMethod=<span style="color: #ff0000;">&quot;get&quot;</span>&gt;&lt;/div&gt;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #808080; font-style: italic;">// フォームのレンダリング ?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">form</span> <span style="color: #000000; font-weight: bold;">?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #808080; font-style: italic;">// Dojo 関連の CSS の、HTML head での読み込み ?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">headStyle</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">captureStart</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #000000; font-weight: bold;">?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">@import <span style="color: #ff0000;">&quot;&lt;?php echo $this-&gt;baseUrl()</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #ff0000;">?&gt;/javascript/dijit/themes/tundra/tundra.css&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">@import <span style="color: #ff0000;">&quot;&lt;?php echo $this-&gt;baseUrl() ?&gt;/javascript/dojo/resources/dojo.css&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">headStyle</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">captureEnd</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #000000; font-weight: bold;">?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #808080; font-style: italic;">// 必要な Dojo ライブラリを含む javascript の、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp;<span style="color: #808080; font-style: italic;">// HTML head での読み込み ?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">headScript</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">setAllowArbitraryAttributes</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">appendFile</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">baseUrl</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> . <span style="color: #ff0000;">'/javascript/dojo/dojo.js'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'text/javascript'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'djConfig'</span> =&gt; <span style="color: #ff0000;">'parseOnLoad: true'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">captureStart</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #000000; font-weight: bold;">?&gt;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">djConfig.usePlainJson=<span style="color: #000000; font-weight: bold;">true</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.registerModulePath<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;custom&quot;</span>,<span style="color: #ff0000;">&quot;../custom&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.<span style="color: #b1b100;">require</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;dojo.parser&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.<span style="color: #b1b100;">require</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;dojox.data.QueryReadStore&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.<span style="color: #b1b100;">require</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;dijit.form.ComboBox&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">dojo.<span style="color: #b1b100;">require</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;custom.TestNameReadStore&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">&lt;?php</span> <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">headScript</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">captureEnd</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #000000; font-weight: bold;">?&gt;</span></div></li></ol></div></div></div>


            <div class="example-contents"><p>
                headStyle や headScript といったビューヘルパーのコールに注意しましょう。
                これらはプレースホルダで、ビュースクリプトをレンダリングする際に
                <acronym class="acronym">HTML</acronym> の head セクションとなります。
            </p></div>

            <div class="example-contents"><p>
                これで、Dojo のオートコンプリートを動作させるための準備がすべて整いました。
            </p></div>
        </div>
    </div>

    <div class="section" id="zend.controller.actionhelpers.autocomplete.scriptaculous" name="zend.controller.actionhelpers.autocomplete.scriptaculous"><div class="info"><h1 class="title">Scriptaculous でのオートコンプリート</h1></div>
        
        <p class="para">
            <a href="http://wiki.script.aculo.us/scriptaculous/show/Ajax.Autocompleter" class="link external">&raquo; Scriptaculous</a>
            は、所定の形式の <acronym class="acronym">HTML</acronym> レスポンスを受け取ることを想定しています。
        </p>

        <p class="para">
            このライブラリで使用するヘルパーは &#039;AutoCompleteScriptaculous&#039; です。
            このヘルパーにデータの配列を渡せば、Ajax.Autocompleter
            に対応した形式の <acronym class="acronym">HTML</acronym> レスポンスができあがります。
        </p>
    </div>
</div>
        <div class="section" id="zend.controller.actionhelpers.contextswitch" name="zend.controller.actionhelpers.contextswitch"><div class="info"><h1 class="title">ContextSwitch および AjaxContext</h1></div>
    

    <p class="para">
        <em class="emphasis">ContextSwitch</em> アクションヘルパーは、
        リクエストに対してさまざまなレスポンスを返す機能を実現するためのものです。
        <em class="emphasis">AjaxContext</em> ヘルパーは
        <em class="emphasis">ContextSwitch</em> をより特化したもので、
        レスポンスを XmlHttpRequests で返す機能を提供します。
    </p>

    <p class="para">
        いずれかを有効にするには、コントローラに対して
        「どのアクションがどのコンテキストに対応するのか」
        を教えてやる必要があります。
        やってきたリクエストがそのアクションで有効なコンテキストである場合、
        ヘルパーが行う処理は次のようになります。
    </p>

    <ul class="itemizedlist">
        <li class="listitem"><p class="para">
                レイアウト機能が有効な場合に、それを無効にする。
        </p></li>

        <li class="listitem"><p class="para">
                別のビューサフィックスを設定し、
                コンテキストに応じて別のビュースクリプトを効率よく扱えるようにする。
        </p></li>

        <li class="listitem"><p class="para">
                コンテキストに応じて適切なレスポンスヘッダを送信する。
        </p></li>

        <li class="listitem"><p class="para">
                オプションで、指定したコールバックを実行して
                コンテキストの設定や後処理を行う。
        </p></li>
    </ul>

    <p class="para">
        たとえば、次のようなコントローラを考えてみましょう。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> NewsController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* トップページは listAction() に転送します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> indexAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_forward<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'list'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* ニュースの一覧</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> listAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* ニュースの閲覧</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> viewAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


    <p class="para">
        ここで、 <span class="methodname">listAction()</span>
        の結果を <acronym class="acronym">XML</acronym> 形式でも返せるようにしたくなったとしましょう。
        わざわざ別のアクションを作らなくても、
        <acronym class="acronym">XML</acronym> でレスポンスを返すように指示できます。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> NewsController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$contextSwitch</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'contextSwitch'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$contextSwitch</span>-&gt;<span style="color: #006600;">addActionContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'list'</span>, <span style="color: #ff0000;">'xml'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


    <p class="para">
        これが何を行っているかというと、
    </p>

    <ul class="itemizedlist">
        <li class="listitem"><p class="para">
                レスポンスヘッダ &#039;Content-Type&#039; を &#039;<var class="filename">application/xml</var>&#039; にします。
        </p></li>

        <li class="listitem"><p class="para">
                ビューのサフィックスを &#039;<var class="filename">xml.phtml</var>&#039; (あるいは別のサフィックスをを使っているなら
                &#039;xml.[your suffix]&#039;) に変更します。
        </p></li>
    </ul>

    <p class="para">
        さて、次は新しいビュースクリプト &#039;<var class="filename">news/list.xml.phtml</var>&#039;
        を作成しましょう。これが <acronym class="acronym">XML</acronym> の作成とレンダリングを行います。
    </p>

    <p class="para">
        あるリクエストがコンテキストスイッチを起動するかどうかを判断するために、
        このヘルパーはリクエストオブジェクト内のトークンを調べます。
        デフォルトでは &#039;format&#039; というパラメータを調べることになっていますが、
        これは変更することもできます。つまり、
        ほとんどの場合は、リクエストに &#039;format&#039; パラメータを追加するだけで
        コンテキストスイッチを行えるということです。
    </p>

    <ul class="itemizedlist">
        <li class="listitem"><p class="para">
                <acronym class="acronym">URL</acronym> のパラメータで指定する場合: <var class="filename">/news/list/format/xml</var>
                (デフォルトのルーティング方式では、アクションに続けて任意の
                キー/値 のペアを指定できたことを思い出しましょう)
        </p></li>

        <li class="listitem"><p class="para">
                <b><tt>GET</tt></b> パラメータで指定する場合: <strong class="command">/news/list?format=xml</strong>
        </p></li>
    </ul>

    <p class="para">
        <em class="emphasis">ContextSwitch</em> では任意のコンテキストを指定できます。
        つまり (もし存在するなら) サフィックスを自由に変更したり
        送信するレスポンスヘッダを任意のものに変更したり、
        任意のコールバックで初期化や後処理を行ったりができるということです。
    </p>

    <div class="section" id="zend.controller.actionhelpers.contextswitch.contexts" name="zend.controller.actionhelpers.contextswitch.contexts"><div class="info"><h1 class="title">デフォルトで使用できるコンテキスト</h1></div>
        

        <p class="para">
            <em class="emphasis">ContextSwitch</em> ヘルパーで
            使用できるデフォルトのコンテキストは、json と <acronym class="acronym">XML</acronym> のふたつです。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                    <em class="emphasis"><acronym class="acronym">JSON</acronym></em>。<acronym class="acronym">JSON</acronym> コンテキストは、
                    &#039;Content-Type&#039; レスポンスヘッダを &#039;<var class="filename">application/json</var>&#039; に設定し、
                    ビュースクリプトのサフィックスを &#039;<var class="filename">json.phtml</var>&#039; とします。
                </p>

                <p class="para">
                    しかし、デフォルトではビュースクリプトは不要です。
                    これは、すべてのビュー変数を単純にシリアライズして
                    <acronym class="acronym">JSON</acronym> レスポンスを直接発行するものです。
                </p>

                <p class="para">
                    自動 <acronym class="acronym">JSON</acronym> シリアライズ機能を使わないようにすることもできます。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">contextSwitch</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">setAutoJsonSerialization</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </li>

            <li class="listitem">
                <p class="para">
                    <em class="emphasis"><acronym class="acronym">XML</acronym></em>。<acronym class="acronym">XML</acronym> コンテキストは、
                    &#039;Content-Type&#039; レスポンスヘッダを &#039;<var class="filename">application/xml</var>&#039; に設定し、
                    ビュースクリプトのサフィックスを &#039;<var class="filename">xml.phtml</var>&#039; とします。
                    このコンテキスト用に、新しいビュースクリプトを作成する必要があります。
                </p>
            </li>
        </ul>
    </div>

    <div class="section" id="zend.controller.actionhelpers.contextswitch.custom" name="zend.controller.actionhelpers.contextswitch.custom"><div class="info"><h1 class="title">独自のコンテキストの作成</h1></div>
        

        <p class="para">
            デフォルトのコンテキストだけでは対応しきれないこともあるでしょう。
            たとえば結果を <acronym class="acronym">YAML</acronym> で返したり、<acronym class="acronym">PHP</acronym> のシリアライズ文字列で返したり、
            あるいは <acronym class="acronym">RSS</acronym> や <acronym class="acronym">ATOM</acronym> フィードで返したりといったようにです。
            <em class="emphasis">ContextSwitch</em> を使用すればそれも可能です。
        </p>

        <p class="para">
            新たなコンテキストを追加する最も簡単な方法は
             <span class="methodname">addContext()</span> メソッドを使用することです。
            このメソッドの引数は 2 つで、コンテキストの名前と
            設定の配列を指定します。設定には、以下のうちのひとつあるいは複数を指定します。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para"><em class="emphasis">suffix</em>:
                ViewRenderer で登録されているデフォルトのビューサフィックスの
                前に追加するサフィックス。</p>
            </li>

            <li class="listitem">
                <p class="para"><em class="emphasis">headers</em>: ヘッダ/値
                    のペアの配列で、レスポンスとともに送信したいもの。</p>
            </li>

            <li class="listitem">
                <p class="para"><em class="emphasis">callbacks</em>:
                キー &#039;init&#039; や &#039;post&#039; を含む配列で、それぞれ
                コンテキストの初期化や後処理の際に使用する
                <acronym class="acronym">PHP</acronym> コールバックを指定します。</p>

                <p class="para">初期化コールバックは、<em class="emphasis">ContextSwitch</em> が
                コンテキストを検出した場合に実行されます。
                これを使用して、任意のロジックを実行できます。
                たとえば <acronym class="acronym">JSON</acronym> コンテキストでは、
                このコールバックを使用して
                自動 <acronym class="acronym">JSON</acronym> シリアライズが有効な場合に ViewRenderer
                を無効化しています。</p>

                <p class="para">後処理はアクションの  <span class="methodname">postDispatch()</span>
                で発生します。これを使用して、任意のロジックを実行できます。
                たとえば <acronym class="acronym">JSON</acronym> コンテキストでは、このコールバックを使用して
                自動 <acronym class="acronym">JSON</acronym> シリアライズ機能が有効か無効かを調べています。
                有効な場合はビュー変数を <acronym class="acronym">JSON</acronym> にシリアライズしてレスポンスに送信し、
                無効な場合は ViewRenderer を再度有効にします。</p>
            </li>
        </ul>

        <p class="para">
            コンテキストを操作するメソッドには次のようなものがあります。
        </p>

        <ul class="itemizedlist">
            <li class="listitem"><p class="para">
                 <span class="methodname">addContext($context, array $spec)</span>:
                新しいコンテキストを追加する。
                そのコンテキストが既に存在する場合は例外をスローします。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">setContext($context, array $spec)</span>:
                新しいコンテキストを追加、あるいは既存のコンテキストを上書きする。
                 <span class="methodname">addContext()</span> と同じように指定します。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">addContexts(array $contexts)</span>:
                複数のコンテキストを一度に追加する。配列 <var class="varname">$contexts</var>
                は、コンテキスト/設定 のペアの配列となります。
                既に存在するコンテキストを指定した場合は例外をスローします。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">setContexts(array $contexts)</span>:
                新しいコンテキストを追加、あるいは既存のコンテキストを上書きする。
                 <span class="methodname">addContexts()</span> と同じように指定します。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">hasContext($context)</span>:
                そのコンテキストが存在する場合に <b><tt>TRUE</tt></b>、存在しない場合に
                <b><tt>FALSE</tt></b> を返します。
            </p></li>

            <li class="listitem"><p class="para">  <span class="methodname">getContext($context)</span>:
                    指定した名前のコンテキストを取得する。
                     <span class="methodname">addContext()</span> で使用する設定とあわせた配列を返します。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">getContexts()</span>: すべてのコンテキストを取得する。
                コンテキスト/設定 のペアの配列を返します。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">removeContext($context)</span>:
                指定した名前のコンテキストを削除する。成功した場合に <b><tt>TRUE</tt></b>、
                そのコンテキストが見つからない場合に <b><tt>FALSE</tt></b> を返します。
            </p></li>

            <li class="listitem"><p class="para">
                 <span class="methodname">clearContexts()</span>: すべてのコンテキストを削除する。
            </p></li>
        </ul>
    </div>

    <div class="section" id="zend.controller.actionhelpers.contextswitch.actions" name="zend.controller.actionhelpers.contextswitch.actions"><div class="info"><h1 class="title">アクションごとのコンテキストの設定</h1></div>
        

        <p class="para">
            使用するコンテキストの設定には 2 通りの方法があります。
            コントローラ内で手動で配列を作成する方法、
            そして <em class="emphasis">ContextSwitch</em> のメソッドでそれを作成する方法です。
        </p>

        <p class="para">
            アクションとコンテキストの関連を追加するメソッドは
             <span class="methodname">addActionContext()</span> です。
            このメソッドには 2 つの引数を指定します。
            ひとつはコンテキストを追加したいアクション、
            もうひとつはコンテキスト名あるいはコンテキスト名の配列です。
            たとえば、次のようなコントローラクラスを考えてみましょう。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> listAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> viewAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> commentsAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> updateAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


        <p class="para">
            ここで、&#039;list&#039; アクションに <acronym class="acronym">XML</acronym> コンテキストを、
            そして &#039;comments&#039; アクションに <acronym class="acronym">XML</acronym> コンテキストと <acronym class="acronym">JSON</acronym>
            コンテキストを追加してみることにします。これは
             <span class="methodname">init()</span> メソッドで行います。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">contextSwitch</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">addActionContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'list'</span>, <span style="color: #ff0000;">'xml'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">addActionContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'comments'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'xml'</span>, <span style="color: #ff0000;">'json'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


        <p class="para">
            あるいは、単純に配列プロパティ
            <var class="varname">$contexts</var> を設定することもできます。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #0000ff;">$contexts</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'list'</span>&nbsp; &nbsp; &nbsp;=&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'xml'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'comments'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'xml'</span>, <span style="color: #ff0000;">'json'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">contextSwitch</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


        <p class="para">
            このほうがオーバーヘッドが少なくなりますが、
            書き間違える可能性もあります。
        </p>

        <p class="para">
            コンテキストの関連付けを行うメソッドには次のようなものがあります。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">addActionContext($action, $context)</span>:
                    ひとつあるいは複数のコンテキストを、あるアクションで使用できるようにする。
                    関連付けがすでに設定されている場合は、それに追記します。
                    <var class="varname">$context</var> は、単一のコンテキストか
                    コンテキストの配列となります。
                </p>

                <p class="para">
                    コンテキストとして <b><tt>TRUE</tt></b> を指定すると、
                    すべてのコンテキストをそのアクションで使用できるようにします。
                </p>

                <p class="para">
                    <var class="varname">$context</var> に空の値を指定すると、
                    そのアクションではどのコンテキストも使用できないようにします。
                </p>
            </li>

            <li class="listitem"><p class="para">
                     <span class="methodname">setActionContext($action, $context)</span>:
                    ひとつあるいは複数のコンテキストを、あるアクションで使用できるようにする。
                    関連付けがすでに設定されている場合は、指定したものでそれを置き換えます。
                    <var class="varname">$context</var> は、単一のコンテキストか
                    コンテキストの配列となります。
            </p></li>

            <li class="listitem"><p class="para">
                     <span class="methodname">addActionContexts(array $contexts)</span>:
                    いくつかの アクション/コンテキスト のペアを一度に追加する。
                    <var class="varname">$contexts</var> は、アクション/コンテキスト
                    のペアの連想配列です。これは  <span class="methodname">addActionContext()</span>
                    へのプロキシとなります。つまり、既に別のペアが登録されている場合は
                    そこに追記します。
            </p></li>

            <li class="listitem"><p class="para">
                     <span class="methodname">setActionContexts(array $contexts)</span>:
                     <span class="methodname">addActionContexts()</span> と同様だが、既存の
                    アクション/コンテキスト のペアは上書きする。
            </p></li>

            <li class="listitem"><p class="para">
                     <span class="methodname">hasActionContext($action, $context)</span>:
                    特定のアクションにそのコンテキストが存在するかどうかを調べる。
            </p></li>

            <li class="listitem"><p class="para">
                     <span class="methodname">getActionContexts($action = null)</span>:
                    指定したアクションのすべてのコンテキスト、
                    あるいはすべての アクション/コンテキスト のペアを返す。
            </p></li>

            <li class="listitem"><p class="para">
                     <span class="methodname">removeActionContext($action, $context)</span>:
                    ひとつあるいは複数のコンテキストを、指定したアクションから削除する。
                    <var class="varname">$context</var> は、単一のコンテキストか
                    コンテキストの配列となります。
            </p></li>

            <li class="listitem"><p class="para">
                     <span class="methodname">clearActionContexts($action = null)</span>:
                    すべてのコンテキストを、指定したアクションから削除する。
                    あるいはすべてのアクションのすべてのコンテキストを削除する。
            </p></li>
        </ul>
    </div>

    <div class="section" id="zend.controller.actionhelpers.contextswitch.initcontext" name="zend.controller.actionhelpers.contextswitch.initcontext"><div class="info"><h1 class="title">コンテキストスイッチの初期化</h1></div>
        

        <p class="para">
            コンテキストスイッチを初期化するには、アクションコントローラで
             <span class="methodname">initContext()</span> をコールする必要があります。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> NewsController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">contextSwitch</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


        <p class="para">
            時には、使用するコンテキストを決めてしまいたいこともあるでしょう。
            たとえば、コンテキストスイッチが起動したときには
            <acronym class="acronym">XML</acronym> コンテキストだけを使わせたいという場合などです。
            その場合は、そのコンテキストを
             <span class="methodname">initContext()</span> に渡します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$contextSwitch</span>-&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'xml'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.controller.actionhelpers.contextswitch.misc" name="zend.controller.actionhelpers.contextswitch.misc"><div class="info"><h1 class="title">追加機能</h1></div>
        

        <p class="para">
            さまざまなメソッドを使用することで、
            <em class="emphasis">ContextSwitch</em> ヘルパーの挙動を変更できます。
            たとえば次のようなメソッドが存在します。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">setAutoJsonSerialization($flag)</span>:
                    デフォルトでは、<acronym class="acronym">JSON</acronym> コンテキストはビュー変数をすべてシリアライズし、
                    <acronym class="acronym">JSON</acronym> 記法にしたものをレスポンスとして返します。
                    レスポンスを自分で作成したい場合はこれをオフにしなければなりません。
                    これは、 <span class="methodname">initContext()</span> をコールする前に行う必要があります。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$contextSwitch</span>-&gt;<span style="color: #006600;">setAutoJsonSerialization</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$contextSwitch</span>-&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


                <p class="para">
                    このフラグの値を取得するには
                     <span class="methodname">getAutoJsonSerialization()</span> を使用します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setSuffix($context, $suffix,
                        $prependViewRendererSuffix)</span>:
                    このメソッドは、指定したコンテキストに対して
                    別のサフィックスを設定します。
                    3 番目の引数を使用すると、
                    ViewRenderer のサフィックスの前に
                    新しいサフィックスをつけるのかどうかを指定できます。
                    このフラグはデフォルトで有効になっています。
                </p>

                <p class="para">
                    サフィックスに空の値を指定すると、
                    ViewRenderer のサフィックスのみを使用します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">addHeader($context, $header, $content)</span>:
                    指定したコンテキストにレスポンスヘッダを追加します。
                    <var class="varname">$header</var> はヘッダの名前で、
                    <var class="varname">$content</var> はそのヘッダに渡す値となります。
                </p>

                <p class="para">
                    各コンテキストは複数のヘッダを持つことができます。
                     <span class="methodname">addHeader()</span> は、
                    そのヘッダをコンテキストのヘッダスタックに追加します。
                </p>

                <p class="para">
                    指定した <var class="varname">$header</var> がそのコンテキストに既に存在する場合は、
                    例外をスローします。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setHeader($context, $header, $content)</span>:
                     <span class="methodname">setHeader()</span> は
                     <span class="methodname">addHeader()</span> とほぼ同じですが、
                    既存のコンテキストヘッダを上書きします。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">addHeaders($context, array $headers)</span>:
                    指定したコンテキストに一度に複数のヘッダを追加します。
                     <span class="methodname">addHeader()</span> へのプロキシとして動作するので、
                    そのヘッダがすでに存在する場合は例外をスローします。
                    <var class="varname">$headers</var> は ヘッダ/コンテキスト
                    のペアの配列です。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setHeaders($context, array $headers.)</span>:
                     <span class="methodname">addHeaders()</span> と似ていますが、これは
                     <span class="methodname">setHeader()</span> へのプロキシとして動作し、
                    既存のヘッダは上書きします。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getHeader($context, $header)</span>:
                    指定したコンテキストのヘッダの値を取得します。
                    見つからない場合は <b><tt>NULL</tt></b> を返します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">removeHeader($context, $header)</span>:
                    指定したコンテキストの単一のヘッダを削除します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">clearHeaders($context, $header)</span>:
                    指定したコンテキストのすべてのヘッダを削除します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setCallback($context, $trigger, $callback)</span>:
                    指定したコンテキストにおける指定したトリガーのコールバックを設定します。
                    トリガーに指定できる値は &#039;init&#039; あるいは &#039;post&#039;
                    (それぞれ、コンテキストの初期化時と postDispatch 時を表します) です。
                    <var class="varname">$callback</var> は <acronym class="acronym">PHP</acronym> のコールバックとして正しい形式でなければなりません。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setCallbacks($context, array $callbacks)</span>:
                    指定したコンテキストに複数のコールバックを設定します。
                    <var class="varname">$callbacks</var> は トリガー/コールバック
                    のペアとなります。実際のところ、登録できるコールバックは
                    ほとんどふたつだけで、初期化用のものと後処理用のものです。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getCallback($context, $trigger)</span>:
                    指定したコンテキストにおける指定したトリガーのコールバックを取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getCallbacks($context)</span>:
                    指定したコンテキストにおけるすべてのコールバックを取得します。
                    トリガー/コールバック のペアを返します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">removeCallback($context, $trigger)</span>:
                    指定したコンテキストにおける指定したトリガーのコールバックを削除します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">clearCallbacks($context)</span>:
                    指定したコンテキストにおけるすべてのコールバックを削除します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setContextParam($name)</span>:
                    コンテキストスイッチが要求されたかどうかを調べるための
                    リクエストパラメータを設定します。デフォルトは
                    &#039;format&#039; ですが、このアクセサを使用することで変更できます。
                </p>

                <p class="para">
                     <span class="methodname">getContextParam()</span>
                    で、現在の値を取得できます。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setAutoDisableLayout($flag)</span>:
                    デフォルトでは、コンテキストスイッチが発生したときには
                    レイアウト機能が無効になります。これは、
                    レイアウト機能は通常は普通のレスポンスの時に使用するものであって
                    それ以外のコンテキストでは無意味だからです。
                    しかし、時にはレイアウト機能を使いたいこともあるでしょう
                    (新しいコンテキスト用のレイアウトがある場合など)。
                    その場合は、 <span class="methodname">setAutoDisableLayout()</span>
                    に <b><tt>FALSE</tt></b> を渡します。これは、
                     <span class="methodname">initContext()</span> をコールするより
                    <em class="emphasis">前に</em> 行わなければなりません。
                </p>

                <p class="para">
                    このフラグの現在の値を取得するには、アクセサ
                     <span class="methodname">getAutoDisableLayout()</span> を使用します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getCurrentContext()</span> を使うと、
                    現在のコンテキストを取得できます。
                    コンテキストスイッチが発生していない場合や
                     <span class="methodname">initContext()</span> の起動前にコールした場合は
                    <b><tt>NULL</tt></b> を返します。
                </p>
            </li>
        </ul>
    </div>

    <div class="section" id="zend.controller.actionhelpers.contextswitch.ajaxcontext" name="zend.controller.actionhelpers.contextswitch.ajaxcontext"><div class="info"><h1 class="title">AjaxContext の機能</h1></div>
        

        <p class="para">
            <em class="emphasis">AjaxContext</em> ヘルパーは
            <em class="emphasis">ContextSwitch</em> を継承したものです。
            <em class="emphasis">ContextSwitch</em> の機能はすべて使用できます。
            しかし、いくつか重要な違いがあります。
        </p>

        <p class="para">
            まず、コンテキストを決めるアクションコントローラのプロパティは
            <var class="varname">$ajaxable</var> となります。これにより、
            <acronym class="acronym">AJAX</acronym> 用と通常の <acronym class="acronym">HTTP</acronym> リクエスト用で別のコンテキストを使用できるようになります。
            <em class="emphasis">AjaxContext</em> の *<em class="emphasis">ActionContext()</em>*
            系のメソッドは、このプロパティに書き込みます。
        </p>

        <p class="para">
            次に、これは XmlHttpRequest が発生した場合にのみ起動します。
            リクエストオブジェクトの  <span class="methodname">isXmlHttpRequest()</span>
            メソッドで判断します。したがって、たとえコンテキストパラメータ
            (&#039;format&#039;) をリクエストで渡したとしても、そのリクエストが
            XmlHttpRequest でない場合はコンテキストスイッチが発生しません。
        </p>

        <p class="para">
            3 番目に、<em class="emphasis">AjaxContext</em> は <acronym class="acronym">HTML</acronym> コンテキストを追加します。
            このコンテキストでは、サフィックスを &#039;<var class="filename">ajax.phtml</var>&#039;
            として通常のリクエストのコンテキストと区別しています。
            追加のヘッダは返しません。
        </p>

        <div class="example"><div class="info"><p><b>Example #4 Ajax リクエストに対してアクションに応答させる</b></p></div>
            

            <div class="example-contents"><p>
                この例では、アクション &#039;view&#039;、&#039;form&#039; および &#039;process&#039;
                に対する <acronym class="acronym">AJAX</acronym> リクエストにレスポンスを返させるようにしています。
                最初のふたつ &#039;view&#039; および &#039;form&#039; では、<acronym class="acronym">HTML</acronym>
                コード片を返してページを更新させます。最後の &#039;process&#039;
                については <acronym class="acronym">JSON</acronym> を返しています。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> CommentController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$ajaxContext</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'AjaxContext'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$ajaxContext</span>-&gt;<span style="color: #006600;">addActionContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'view'</span>, <span style="color: #ff0000;">'html'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">addActionContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'form'</span>, <span style="color: #ff0000;">'html'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">addActionContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'process'</span>, <span style="color: #ff0000;">'json'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">initContext</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> viewAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 単一のコメントを表示します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// AjaxContext の場合は comment/view.ajax.phtml</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// を使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> formAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 新規コメントの追加フォームをレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// AjaxContext の場合は comment/form.ajax.phtml</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// を使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> processAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 新規コメントを処理します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 結果を JSON で返します。結果をビュー変数に格納するだけで、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// JSON でそれを返してくれます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


            <div class="example-contents"><p>
                クライアント側では、<acronym class="acronym">AJAX</acronym> ライブラリからエンドポイント
                &#039;<var class="filename">/comment/view</var>&#039;、&#039;<var class="filename">/comment/form</var>&#039; そして
                &#039;<var class="filename">/comment/process</var>&#039; へリクエストを送ることになります。
                その際に、&#039;format&#039; パラメータを
                &#039;<var class="filename">/comment/view/format/html</var>&#039;、&#039;<var class="filename">/comment/form/format/html</var>&#039; そして
                &#039;<var class="filename">/comment/process/format/json</var>&#039; のように指定します
                (あるいはクエリ文字列で &quot;?format=json&quot; のようにしてもかまいません)。
            </p></div>

            <div class="example-contents"><p>
                ライブラリ側で &#039;X-Requested-With:
                XmlHttpRequest&#039; ヘッダが設定されていれば、
                このアクションは適切な形式でレスポンスを返します。
            </p></div>
        </div>
    </div>
</div>
        <div class="section" id="zend.controller.actionhelpers.flashmessenger" name="zend.controller.actionhelpers.flashmessenger"><div class="info"><h1 class="title">FlashMessenger(日本語)</h1></div>
    

    <div class="section" id="zend.controller.actionhelper.flashmessenger.introduction" name="zend.controller.actionhelper.flashmessenger.introduction"><div class="info"><h1 class="title">導入</h1></div>
        

        <p class="para">
            <em class="emphasis">FlashMessenger</em> ヘルパーは、
            次のリクエストの際にユーザに見せる必要のあるメッセージを渡すためのものです。
            この機能を実現するため、<em class="emphasis">FlashMessenger</em> は
            <span class="classname">Zend_Session_Namespace</span> を使用してメッセージを保管しています。
            <span class="classname">Zend_Session</span> や
            <span class="classname">Zend_Session_Namespace</span> を使用する際には、起動ファイル中で
             <span class="methodname">Zend_Session::start()</span> を実行するようにしましょう
            (詳細な使用例は <a href="zend.session.advanced_usage.html#zend.session.advanced_usage.starting_a_session" class="link">Zend Session</a>
            のドキュメントを参照ください)。
        </p>

    </div>

    <div class="section" id="zend.controller.actionhelper.flashmessenger.basicusage" name="zend.controller.actionhelper.flashmessenger.basicusage"><div class="info"><h1 class="title">基本的な使用例</h1></div>
        

        <p class="para">
            以下の使用例は、もっとも基本的なフラッシュメッセンジャーの使用法を示すものです。
            アクション <var class="filename">/some/my</var> がコールされると、フラッシュメッセージに
            &quot;Record Saved!&quot; が保存されます。そして、その次のアクション
            <var class="filename">/some/my-next-request</var> へのリクエストの際にそれを取得
            (そして削除) します。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> SomeController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* FlashMessenger</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* @var Zend_Controller_Action_Helper_FlashMessenger</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; protected <span style="color: #0000ff;">$_flashMessenger</span> = <span style="color: #000000; font-weight: bold;">null</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_flashMessenger =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'FlashMessenger'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">initView</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> myAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* Zend_Controller_Action_Helper_FlashMessenger</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* のインスタンスを必要に応じて取得するための</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* デフォルトメソッド</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_flashMessenger-&gt;<span style="color: #006600;">addMessage</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Record Saved!'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> myNextRequestAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">view</span>-&gt;<span style="color: #006600;">messages</span> = <span style="color: #0000ff;">$this</span>-&gt;_flashMessenger-&gt;<span style="color: #006600;">getMessages</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">render</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

    </div>
</div>
        <div class="section" id="zend.controller.actionhelpers.json" name="zend.controller.actionhelpers.json"><div class="info"><h1 class="title">JSON(日本語)</h1></div>
    

    <p class="para">
        <acronym class="acronym">JSON</acronym> レスポンスは、<acronym class="acronym">AJAX</acronym> リクエストでデータセットを受け取るときの
        形式としてすっかり定着しました。<acronym class="acronym">JSON</acronym> はクライアント側で
        すぐにパースすることができ、すばやく実行できます。
    </p>

    <p class="para">
        <acronym class="acronym">JSON</acronym> アクションヘッダは次のようなことを行います。
    </p>

    <ul class="itemizedlist">
        <li class="listitem">
            <p class="para">
                レイアウト機能が有効になっている場合はそれを無効にする。
            </p>
        </li>

        <li class="listitem">
            <p class="para">
                任意で、オプションの配列を
                 <span class="methodname">Zend_Json::encode()</span> の 2 番目の引数として渡す。
                このオプションの配列で、レイアウト機能を有効にしたり
                <span class="classname">Zend_Json_Expr</span> によるエンコードを有効にしたりする。
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'enableJsonExprFinder'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </li>

        <li class="listitem">
            <p class="para">
                ViewRenderer が有効になっている場合にそれを無効にする。
            </p>
        </li>

        <li class="listitem">
            <p class="para">
                &#039;Content-Type&#039; レスポンスヘッダを &#039;<var class="filename">application/json</var>&#039; に設定する。
            </p>
        </li>

        <li class="listitem">
            <p class="para">
                デフォルトでレスポンスをすぐに返す。
                アクションの実行が終了するのを待たない。
            </p>
        </li>
    </ul>

    <p class="para">
        使い方は簡単です。ヘルパーブローカのメソッドとしてコールするか、
         <span class="methodname">encodeJson()</span> あるいは
         <span class="methodname">sendJson()</span> といったメソッドをコールするだけです。
    </p>

    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> FooController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> barAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何らかの処理をして...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// JSON レスポンスを返します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// あるいは...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span>-&gt;<span style="color: #006600;">sendJson</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// あるいは JSON を取得します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$json</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span>-&gt;<span style="color: #006600;">encodeJson</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


    <blockquote><p><b class="note">Note</b>: <span class="info"><b>レイアウトの維持</b><br /></span>
        

        
            <acronym class="acronym">JSON</acronym> レスポンスでレイアウト機能を使用したい場合
            (いくつかの <acronym class="acronym">JSON</acronym> レスポンスをひとつにまとめて処理するなど)
            のために、<acronym class="acronym">JSON</acronym> ヘルパーの各メソッドには
            2 番目の引数が用意されています。
            この引数はオプションのフラグで、レイアウト機能を有効あるいは無効にします。
            <b><tt>TRUE</tt></b> を渡すと、レイアウト機能を有効なままにします。
        <br />

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span>, <span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        
            オプションで、2 番目の引数に配列を渡すことができます。
            この配列には、<em class="emphasis">keepLayouts</em>
            のオプションを含むさまざまなオプションを指定できます。
        <br />

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'keepLayouts'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </p></blockquote>

    <blockquote><p><b class="note">Note</b>: <span class="info"><b>Zend_Json_Expr を使用したエンコードの有効化</b><br /></span>
        

        
             <span class="methodname">Zend_Json::encode()</span> は、ネイティブ <acronym class="acronym">JSON</acronym> 式を
            <span class="classname">Zend_Json_Expr</span> オブジェクトを使用してエンコードできます。
            このオプションはデフォルトでは無効になっています。
            有効にするには、<em class="emphasis">enableJsonExprFinder</em>
            オプションに <b><tt>TRUE</tt></b> を設定します。
        <br />

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'enableJsonExprFinder'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        
            これを行いたい場合は、2 番目の引数に必ず配列を渡さなければなりません。
            また、たとえば <em class="emphasis">keepLayouts</em> のような他のオプションと組み合わせることもできます。
            これらすべてのオプションが  <span class="methodname">Zend_Json::encode()</span> に渡されます。
        <br />

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">json</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$data</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'enableJsonExprFinder'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span>, </div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'keepLayouts'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #000000; font-weight: bold;">true</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </p></blockquote>
</div>
        <div class="section" id="zend.controller.actionhelpers.redirector" name="zend.controller.actionhelpers.redirector"><div class="info"><h1 class="title">Redirector(日本語)</h1></div>
    

    <div class="section" id="zend.controller.actionhelper.redirector.introduction" name="zend.controller.actionhelper.redirector.introduction"><div class="info"><h1 class="title">導入</h1></div>
        

        <p class="para">
            <em class="emphasis">Redirector</em> ヘルパーは、
            アプリケーション内で必要となるリダイレクト処理用のオブジェクトとして使用します。
             <span class="methodname">_redirect()</span> メソッドと比べた場合の利点としては、
            サイト全体で使用する設定を事前に組み込んでおけることがあります。また、
             <span class="methodname">Zend_Controller_Action::_forward()</span>
            の場合と同様に、組み込みのインターフェイス
             <span class="methodname">gotoSimple($action, $controller, $module, $params)</span>
            が使用できることも利点となります。
        </p>

        <p class="para">
            <em class="emphasis">Redirector</em> では、
            リダイレクトの設定を行うメソッドとして次のようなものが用意されています。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">setCode()</span> を使用して、
                    リダイレクトの際に使用する <acronym class="acronym">HTTP</acronym> レスポンスコードを設定します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setExit()</span> を使用して、
                    リダイレクトの後で強制的に  <span class="methodname">exit()</span> を実行させるようにします。
                    デフォルトは <b><tt>TRUE</tt></b> です。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setGotoSimple()</span> を使用して、 <span class="methodname">gotoSimple()</span>
                    に何も渡されなかったときのデフォルトの <acronym class="acronym">URL</acronym> を設定します。
                     <span class="methodname">Zend_Controller_Action::_forward()</span> の <acronym class="acronym">API</acronym> である
                     <span class="methodname">setGotoSimple($action, $controller = null, $module = null, array
                    $params = array())</span> を使用します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setGotoRoute()</span> を使用して、
                    登録済みのルートにもとづいた <acronym class="acronym">URL</acronym> を設定します。
                    キー/値 のペアの配列とルート名を渡し、
                    それをもとにルートの型と定義から <acronym class="acronym">URL</acronym> を作成します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setGotoUrl()</span> を使用して、 <span class="methodname">gotoUrl()</span>
                    に何も渡されなかったときのデフォルトの <acronym class="acronym">URL</acronym> を設定します。
                    <acronym class="acronym">URL</acronym> を表す文字列を受け取ります。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setPrependBase()</span> を使用して、
                     <span class="methodname">setGotoUrl()</span>、 <span class="methodname">gotoUrl()</span>
                    あるいは  <span class="methodname">gotoUrlAndExit()</span>
                    で指定した <acronym class="acronym">URL</acronym> の前にリクエストのベース <acronym class="acronym">URL</acronym> を追加します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setUseAbsoluteUri()</span> を使用すると、
                     <span class="methodname">Redirector</span> がリダイレクトの際に絶対
                    <acronym class="acronym">URI</acronym> を使用するようになります。
                    このオプションを設定すると、
                    <var class="varname">$_SERVER[&#039;HTTP_HOST&#039;]</var> や
                    <var class="varname">$_SERVER[&#039;SERVER_PORT&#039;]</var>、そして
                    <var class="varname">$_SERVER[&#039;HTTPS&#039;]</var> の内容をもとにして
                    リダイレクト用の完全な <acronym class="acronym">URI</acronym> を作成します。
                    このオプションのデフォルト値はオフですが、
                    将来のリリースではデフォルトで有効になるかもしれません。
                </p>
            </li>
        </ul>

        <p class="para">
            さらに、実際のリダイレクトを行うためのメソッドとして以下のものが用意されています。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">gotoSimple()</span> は、 <span class="methodname">setGotoSimple()</span>
                    ( <span class="methodname">_forward()</span> 風の <acronym class="acronym">API</acronym>) を用いて作成した <acronym class="acronym">URL</acronym>
                    にリダイレクトします。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">gotoRoute()</span> は、 <span class="methodname">setGotoRoute()</span>
                    (<em class="emphasis">ルートの作成</em>) を用いて作成した <acronym class="acronym">URL</acronym>
                    にリダイレクトします。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">gotoUrl()</span> は  <span class="methodname">setGotoUrl()</span>
                    (<em class="emphasis"><acronym class="acronym">URL</acronym> 文字列の指定</em>) を用いて作成した <acronym class="acronym">URL</acronym>
                    にリダイレクトします。
                </p>
            </li>
        </ul>

        <p class="para">
            リダイレクト先の <acronym class="acronym">URL</acronym> を知るには
             <span class="methodname">getRedirectUrl()</span> を使用します。
            これはいつでも使用できます。
        </p>
    </div>

    <div class="section" id="zend.controller.actionhelper.redirector.basicusage" name="zend.controller.actionhelper.redirector.basicusage"><div class="info"><h1 class="title">基本的な使用例</h1></div>
        

        <div class="example"><div class="info"><p><b>Example #5 オプションの設定</b></p></div>
            

            <div class="example-contents"><p>
                この例ではデフォルトのオプションを少し変更します。
                <acronym class="acronym">HTTP</acronym> ステータスコードを 303 にし、リダイレクト後に
                exit() しないようにして、そしてリダイレクトの際のデフォルト
                <acronym class="acronym">URL</acronym> を指定しています。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> SomeController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* Redirector - defined for code completion</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* @var Zend_Controller_Action_Helper_Redirector</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; protected <span style="color: #0000ff;">$_redirector</span> = <span style="color: #000000; font-weight: bold;">null</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Redirector'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// リダイレクタのデフォルトのオプションを設定します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// このオブジェクトはヘルパーブローカに登録されるので、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// これ以降のすべてのアクションで有効となります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector-&gt;<span style="color: #006600;">setCode</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">303</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">setExit</span><span style="color: #66cc66;">&#40;</span><span style="color: #000000; font-weight: bold;">false</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">setGotoSimple</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;this-action&quot;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">&quot;some-controller&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> myAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/* 何かを行います */</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 先ほど登録した URL にリダイレクトし、その後で</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// exit() します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector-&gt;<span style="color: #006600;">redirectAndExit</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span>; <span style="color: #808080; font-style: italic;">// 決してここには到達しません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <div class="example"><div class="info"><p><b>Example #6 デフォルト設定の使用</b></p></div>
            

            <div class="example-contents"><p>
                この例ではデフォルト設定を使用しています。
                つまり、リダイレクトするとすぐに
                 <span class="methodname">exit()</span> が実行されるということです。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 別の例</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> AlternativeController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* Redirector - defined for code completion</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* @var Zend_Controller_Action_Helper_Redirector</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; protected <span style="color: #0000ff;">$_redirector</span> = <span style="color: #000000; font-weight: bold;">null</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Redirector'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> myAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/* 何かを行います */</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">gotoUrl</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/my-controller/my-action/param1/test/param2/test2'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span>; <span style="color: #808080; font-style: italic;">// リダイレクト後に自動的に exit() されるので、決してここには到達しません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <div class="example"><div class="info"><p><b>Example #7 goto() での _forward() API の使用</b></p></div>
            

            <div class="example-contents"><p>
                 <span class="methodname">gotoSimple()</span> の <acronym class="acronym">API</acronym> は、
                 <span class="methodname">Zend_Controller_Action::_forward()</span>
                と同じ形式です。違う点は、このメソッドは渡されたパラメータから <acronym class="acronym">URL</acronym>
                を作成し、デフォルトルータのデフォルトフォーマットである
                <var class="filename">:module/:controller/:action/*</var> を使用するということです。
                また、アクションチェインではなくリダイレクトを行います。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> ForwardController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* Redirector - defined for code completion</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* @var Zend_Controller_Action_Helper_Redirector</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; protected <span style="color: #0000ff;">$_redirector</span> = <span style="color: #000000; font-weight: bold;">null</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Redirector'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> myAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/* 何かを行います */</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 現在のモジュールの 'my-controller' コントローラの</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 'my-action' アクションにリダイレクトします。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// パラメータは param1 =&gt; test、param2 =&gt; test2 となります。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector-&gt;<span style="color: #006600;">gotoSimple</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'my-action'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ff0000;">'my-controller'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #000000; font-weight: bold;">null</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'param1'</span> =&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #ff0000;">'param2'</span> =&gt; <span style="color: #ff0000;">'test2'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <div class="example"><div class="info"><p><b>Example #8 gotoRoute() でのルートアセンブリの使用</b></p></div>
            

            <div class="example-contents"><p>
                次の例は、<a href="zend.controller.router.html" class="link">ルータ</a>
                の  <span class="methodname">assemble()</span> メソッドを使用して、
                パラメータで指定した連想配列に基づく <acronym class="acronym">URL</acronym> を作成しています。
                次のようなルートが登録されているものと仮定します。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$route</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Controller_Router_Route<span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'blog/:year/:month/:day/:id'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'controller'</span> =&gt; <span style="color: #ff0000;">'archive'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'module'</span> =&gt; <span style="color: #ff0000;">'blog'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'action'</span> =&gt; <span style="color: #ff0000;">'view'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$router</span>-&gt;<span style="color: #006600;">addRoute</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'blogArchive'</span>, <span style="color: #0000ff;">$route</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <div class="example-contents"><p>
                year を 2006、month を 4、day を 24、そして ID を 42
                として配列を渡すと、結果の <acronym class="acronym">URL</acronym> は
                <var class="filename">/blog/2006/4/24/42</var> となります。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> BlogAdminController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* Redirector - defined for code completion</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;* @var Zend_Controller_Action_Helper_Redirector</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">&nbsp; &nbsp; &nbsp;*/</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; protected <span style="color: #0000ff;">$_redirector</span> = <span style="color: #000000; font-weight: bold;">null</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">getHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Redirector'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> returnAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">/* 何かを行います */</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// blog の過去記事にリダイレクトします。URL は</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// /blog/2006/4/24/42 になります。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirector-&gt;<span style="color: #006600;">gotoRoute</span><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'year'</span> =&gt; <span style="color: #cc66cc;">2006</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'month'</span> =&gt; <span style="color: #cc66cc;">4</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'day'</span> =&gt; <span style="color: #cc66cc;">24</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'id'</span> =&gt; <span style="color: #cc66cc;">42</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'blogArchive'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>
    </div>
</div>
        <div class="section" id="zend.controller.actionhelpers.viewrenderer" name="zend.controller.actionhelpers.viewrenderer"><div class="info"><h1 class="title">ViewRenderer(日本語)</h1></div>
    

    <div class="section" id="zend.controller.actionhelper.viewrenderer.introduction" name="zend.controller.actionhelper.viewrenderer.introduction"><div class="info"><h1 class="title">導入</h1></div>
        

        <p class="para">
            <em class="emphasis">ViewRenderer</em> ヘルパーは、
            以下のような要件を満たすために作られたものです。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                    コントローラ内でいちいちビューオブジェクトのインスタンスを
                    作成しなくても済むようにする。
                    ビューオブジェクトは自動的にコントローラに登録されます。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    ビュースクリプトやヘルパー、そしてフィルタのパスを
                    現在のモジュールに基づいて自動的に設定し、
                    モジュール名をヘルパーやフィルタのクラス名の先頭に自動的に関連付ける。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    すべてのコントローラとアクションで使用できる
                    グローバルなビューオブジェクトを作成する。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    すべてのコントローラで使用する、
                    デフォルトのビューレンダリングオプションを設定できるようにする。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    何も指定しなくても、
                    自動的にビュースクリプトをレンダリングできる機能を追加する。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    ビューの基底パスやビュースクリプトのパスを
                    独自に指定できるようにする。
                </p>
            </li>
        </ul>

        <blockquote><p><b class="note">Note</b>: 
            
                 <span class="methodname">_forward()</span> や  <span class="methodname">redirect()</span>、
                あるいは手動での  <span class="methodname">render()</span> を行う場合は、
                自動レンダリングは不要です。これらの処理を行う場合は、
                出力を自前で行うことを <em class="emphasis">ViewRenderer</em>
                に対して指示します。
            <br />
        </p></blockquote>

        <blockquote><p><b class="note">Note</b>: 
            
                <em class="emphasis">ViewRenderer</em> はデフォルトで有効になっています。
                これを無効にするには、フロントコントローラのパラメータ
                <em class="emphasis">noViewRenderer</em> を指定する
                (<strong class="command">$front-&gt;setParam(&#039;noViewRenderer&#039;, true);</strong>) か、
                あるいはヘルパーブローカからヘルパーを削除
                ( <span class="methodname">Zend_Controller_Action_HelperBroker::removeHelper(&#039;viewRenderer&#039;)</span>)
                します。
            <br />

            
                フロントコントローラでのディスパッチ処理の前に
                <em class="emphasis">ViewRenderer</em> の設定を変更したい場合は、
                次のいずれかの方法を使用します。
            <br />

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        独自の <em class="emphasis">ViewRenderer</em> のインスタンスを作成し、
                        ヘルパーブローカにそれを渡して登録する。
                    </p>

                    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Controller_Action_Helper_ViewRenderer<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span>-&gt;<span style="color: #006600;">setView</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$view</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">setViewSuffix</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'php'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">addHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$viewRenderer</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

                </li>

                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">ViewRenderer</em> オブジェクトを、
                        ヘルパーブローカから必要に応じて作成、取得する。
                    </p>

                    <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span> =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Controller_Action_HelperBroker::<span style="color: #006600;">getStaticHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'viewRenderer'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span>-&gt;<span style="color: #006600;">setView</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$view</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">setViewSuffix</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'php'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

                </li>
            </ul>
        </p></blockquote>
    </div>

    <div class="section" id="zend.controller.actionhelper.viewrenderer.api" name="zend.controller.actionhelper.viewrenderer.api"><div class="info"><h1 class="title">API</h1></div>
        

        <p class="para">
            もっとも基本的な使用法は、単に <em class="emphasis">ViewRenderer</em>
            のインスタンスを作成してそれをヘルパーブローカに渡すというものです。
            インスタンスの作成と登録を一度に行うには、ヘルパーブローカの
             <span class="methodname">getStaticHelper()</span> メソッドを使用するのがいちばん簡単です。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">getStaticHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'viewRenderer'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            アクションコントローラのインスタンスが最初に作成されたときに、
            <em class="emphasis">ViewRenderer</em> がビューオブジェクトのインスタンスを作成します。
            コントローラのインスタンスが作成されるたびに、<em class="emphasis">ViewRenderer</em>
            の  <span class="methodname">init()</span> が呼び出されます。
            ここでアクションコントローラのビュープロパティを設定し、
            現在のモジュールからの相対パスを指定して
             <span class="methodname">addScriptPath()</span> を呼び出します。
            これは現在のモジュール名に基づいたプレフィックスをクラス名の先頭につけて呼び出されるので、
            ヘルパーやフィルタのクラスをモジュール内で効率的に管理できます。
        </p>

        <p class="para">
             <span class="methodname">postDispatch()</span> が呼び出されるたびに、現在のアクションの
             <span class="methodname">render()</span> を自動的に呼び出します。
        </p>

        <p class="para">
            例として、次のようなクラスを考えてみましょう。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// foo モジュールのコントローラクラス</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> Foo_BarController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// デフォルトで bar/index.phtml をレンダリングするので、特に何もする必要はありません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> indexAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 変数 'foo' の値を 'bar' に設定して bar/populate.phtml をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ビューオブジェクトは既に preDispatch() で定義されているので、既に使用可能です</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> populateAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">view</span>-&gt;<span style="color: #006600;">foo</span> = <span style="color: #ff0000;">'bar'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// ビュースクリプトの中では、たとえば次のように書きます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">foo</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>; <span style="color: #808080; font-style: italic;">// Foo_View_Helper_Foo::foo() を呼び出します</span></div></li></ol></div></div></div>


        <p class="para">
            <em class="emphasis">ViewRenderer</em> には、
            ビューのオプションを取得したり設定したりするためのメソッドも豊富に用意されています。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">setView($view)</span>
                    は <em class="emphasis">ViewRenderer</em> が使用するビューオブジェクトを設定します。
                    これは、クラスのプロパティ <var class="varname">$view</var> の値を設定します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setNeverRender($flag = true)</span>
                    を使用すると、自動レンダリング機能を全体的に
                    （すべてのコントローラに対して）無効にしたり有効にしたりできます。
                    <b><tt>TRUE</tt></b> を指定すると、そのコントローラの  <span class="methodname">postDispatch()</span>
                    では  <span class="methodname">render()</span> を呼び出さなくなります。
                     <span class="methodname">getNeverRender()</span> は、現在の設定を取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setNoRender($flag = true)</span>
                    を使用すると、自動レンダリングを無効にしたり有効にしたりできます。
                    <b><tt>TRUE</tt></b> を指定すると、現在のコントローラの  <span class="methodname">postDispatch()</span>
                    では  <span class="methodname">render()</span> を呼び出さなくなります。
                    この設定は、 <span class="methodname">preDispatch()</span>
                    が呼び出されるたびにいったんリセットされます
                    (つまり、自動レンダリングを無効にしたいすべてのコントローラで
                    個々にこれを設定する必要があるということです)。
                     <span class="methodname">getNoRender()</span> は、現在の設定を取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setNoController($flag = true)</span>
                    を使用すると、 <span class="methodname">render()</span>
                    がコントローラ名のサブディレクトリにあるアクションスクリプトを
                    読みにいかなくできます (デフォルトでは読みにいきます)。
                     <span class="methodname">getNoController()</span> は、現在の設定を取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setNeverController($flag = true)</span>
                    は  <span class="methodname">setNoController()</span> と似ていますが、
                    こちらは全体に影響を与えます。つまり、
                    ディスパッチ処理を行っても設定はリセットされません。
                     <span class="methodname">getNeverController()</span> は、現在の設定を取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setScriptAction($name)</span>
                    を使用すると、レンダリングするアクションスクリプトを指定できます。
                    <var class="varname">$name</var> は、スクリプト名から拡張子を除いたもの
                    (そして、<em class="emphasis">noController</em> が指定されていない限り、
                    コントローラのディレクトリ名も除いたもの) となります。
                    指定しなかった場合は、リクエストオブジェクト内のアクションに基づいた名前の
                    ビュースクリプトを探します。
                     <span class="methodname">getScriptAction()</span> は、現在の設定を取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setResponseSegment($name)</span>
                    を使用すると、レンダリング結果を出力する
                    レスポンスオブジェクトのセグメント名を指定できます。
                    指定しなかった場合は、デフォルトのセグメントにレンダリングします。
                     <span class="methodname">getResponseSegment()</span> は、現在の設定を取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">initView($path, $prefix, $options)</span>
                    は、ビューの基底パスを指定します。
                    また、ヘルパースクリプトとフィルタスクリプトの先頭につけるクラスプレフィックスや
                    <em class="emphasis">ViewRenderer</em> のオプションも設定します。
                    オプションには、
                    <em class="emphasis">neverRender</em>、<em class="emphasis">noRender</em>、
                    <em class="emphasis">noController</em>、<em class="emphasis">scriptAction</em>
                    および <em class="emphasis">responseSegment</em>
                    のいずれかのフラグを指定します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setRender($action = null, $name = null, $noController
                        = false)</span>
                    を使用すると、<em class="emphasis">scriptAction</em> や <em class="emphasis">responseSegment</em>
                    そして <em class="emphasis">noController</em> のいずれかまたは複数を
                    一度に指定できます。 <span class="methodname">direct()</span>
                    はこのメソッドのエイリアスで、コントローラ内から簡単にコールできます。
                </p>

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 現在のアクションスクリプトではなく 'foo' をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'foo'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// form.phtml の内容をレスポンスセグメント 'html' にレンダリングします。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// コントローラのビュースクリプト用サブディレクトリは使用しません。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'form'</span>, <span style="color: #ff0000;">'html'</span>, <span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


                <blockquote><p><b class="note">Note</b>: 
                         <span class="methodname">setRender()</span> および  <span class="methodname">direct()</span>
                        は、実際にはビュースクリプトをレンダリングしません。
                        実際にレンダリングを行うのは  <span class="methodname">postDispatch()</span>
                        や  <span class="methodname">render()</span> で、
                        それらのメソッドに対するヒントを指示するだけです。
                <br /></p></blockquote>
            </li>
        </ul>

        <p class="para">
            コンストラクタのオプションとして、
            ビューオブジェクトを渡したり <em class="emphasis">ViewRenderer</em>
            のオプションを渡したりできます。
            このオプションで指定できるのは、 <span class="methodname">initView()</span>
            で説明したフラグと同じものです。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$view</span>&nbsp; &nbsp; = <span style="color: #000000; font-weight: bold;">new</span> Zend_View<span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'encoding'</span> =&gt; <span style="color: #ff0000;">'UTF-8'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$options</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'noController'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span>, <span style="color: #ff0000;">'neverRender'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span> =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">new</span> Zend_Controller_Action_Helper_ViewRenderer<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$view</span>, <span style="color: #0000ff;">$options</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            さらに追加のメソッドがあり、
            ビューオブジェクトで使用するビューの基底パスを変更できます。
            また、ビュースクリプトが自動レンダリングを行う際に使用するパスも変更できます。
            これらのメソッドでは、以下のプレースホルダのいずれかあるいは複数が使用できます。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">:moduleDir</em> は、現在のモジュールの基底ディレクトリを指します
                    (規約では、これはモジュールのコントローラディレクトリの親ディレクトリとなります)。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    <em class="emphasis">:module</em> は、現在のモジュール名を指します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    <em class="emphasis">:controller</em> は、現在のコントローラ名を指します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    <em class="emphasis">:action</em> は、現在のアクション名を指します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                    <em class="emphasis">:suffix</em> は、ビュースクリプトのサフィックス
                    ( <span class="methodname">setViewSuffix()</span> で設定したもの) を指します。
                </p>
            </li>
        </ul>

        <p class="para">
            パス指定を制御するメソッドは次のとおりです。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">setViewBasePathSpec($spec)</span>
                    は、ビューオブジェクトを追加する際に使用する基底パスを
                    決める際に使用するパス指定を変更します。
                    デフォルトの設定は <var class="filename">:moduleDir/views</var> です。
                    現在の設定を取得するには
                     <span class="methodname">getViewBasePathSpec()</span> を使用します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setViewScriptPathSpec($spec)</span>
                    は、個々のビュースクリプトのパス
                    (からビュースクリプトの基底パスを除いた部分)
                    を決める際に使用するパス指定を変更します。
                    デフォルトの設定は <var class="filename">:controller/:action.:suffix</var> です。
                    現在の設定を取得するには
                     <span class="methodname">getViewScriptPathSpec()</span> を使用します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">setViewScriptPathNoControllerSpec($spec)</span>
                    は、<em class="emphasis">noController</em> が有効な場合に
                    個々のビュースクリプトのパス
                    (からビュースクリプトの基底パスを除いた部分)
                    を決める際に使用するパス指定を変更します。
                    デフォルトの設定は <var class="filename">:action.:suffix</var> です。
                    現在の設定を取得するには
                     <span class="methodname">getViewScriptPathNoControllerSpec()</span> を使用します。
                </p>
            </li>
        </ul>

        <p class="para">
            パス指定をよりきめ細かく行うには、
            <a href="zend.filter.inflector.html" class="link">Zend_Filter_Inflector</a>
            を使用します。実は、<em class="emphasis">ViewRenderer</em>
            はパスのマッピングを行う際に既にインフレクタを使用しています。
            インフレクタに手を入れたい (独自のインフレクタを使用したり、
            デフォルトのインフレクタに手を加えたりしたい) 場合は、
            以下のメソッドを使用します。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">getInflector()</span> は、インフレクタを取得します。
                    まだ  <span class="methodname">ViewRenderer</span> にインフレクタが存在しない場合は、
                    デフォルトの規則にもとづいたインフレクタを作成します。
                </p>

                <p class="para">
                    デフォルトでは、サフィックスやモジュールディレクトリへの参照に静的ルールを使用します。
                    また静的な対象を使用します。これにより、さまざまな
                    <em class="emphasis">ViewRenderer</em> のプロパティから
                    動的にインフレクタを変更できるようになります。
                </p>
            </li>

            <li class="listitem"><p class="para">
                     <span class="methodname">setInflector($inflector, $reference)</span> は、
                    <em class="emphasis">ViewRenderer</em> で使用する独自のインフレクタを設定します。
                    <var class="varname">$reference</var> が <b><tt>TRUE</tt></b> の場合は、
                    対象だけでなくサフィックスやモジュールディレクトリも
                    <em class="emphasis">ViewRenderer</em> のプロパティへの静的な参照とします。
            </p></li>
        </ul>

        <blockquote><p><b class="note">Note</b>: <span class="info"><b>デフォルトの検索方式</b><br /></span>
            

            
                <em class="emphasis">ViewRenderer</em> は、
                パスの正規化を行ってビュースクリプトによる検索を簡単にします。
                デフォルトのルールは次のようなものです。
            <br />

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">:module</em>:
                        MixedCase および camelCase 形式の単語がダッシュで分割され、
                        すべて小文字になります。たとえば
                        &quot;FooBarBaz&quot; は &quot;foo-bar-baz&quot; となります。
                    </p>

                    <p class="para">
                        内部的には、インフレクタはフィルタ
                        <span class="classname">Zend_Filter_Word_CamelCaseToDash</span> および
                        <span class="classname">Zend_Filter_StringToLower</span> を使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">:controller</em>:
                        MixedCase および camelCase 形式の単語がダッシュで分割され、
                        アンダースコアはディレクトリ区切り文字に変換され、
                        すべて小文字になります。たとえば
                        &quot;<span class="classname">FooBar</span>&quot; は &quot;foo-bar&quot; となり、そして &quot;<span class="classname">FooBar_Admin</span>&quot;
                        は &quot;<var class="filename">foo-bar/admin</var>&quot; となります。
                    </p>

                    <p class="para">
                        内部的には、インフレクタはフィルタ
                        <span class="classname">Zend_Filter_Word_CamelCaseToDash</span>、
                        <span class="classname">Zend_Filter_Word_UnderscoreToSeparator</span> および
                        <span class="classname">Zend_Filter_StringToLower</span> を使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">:action</em>:
                        MixedCase および camelCase 形式の単語がダッシュで分割され、
                        英数字以外の文字はダッシュに変換され、
                        すべて小文字になります。たとえば
                        &quot;fooBar&quot; は &quot;foo-bar&quot; となり、&quot;foo-barBaz&quot;
                        は &quot;foo-bar-baz&quot; となります。
                    </p>

                    <p class="para">
                        内部的には、インフレクタはフィルタ
                        <span class="classname">Zend_Filter_Word_CamelCaseToDash</span>、
                        <span class="classname">Zend_Filter_PregReplace</span> および
                        <span class="classname">Zend_Filter_StringToLower</span> を使用します。
                    </p>
                </li>
            </ul>
        </p></blockquote>

        <p class="para">
            <em class="emphasis">ViewRenderer</em> <acronym class="acronym">API</acronym> の最後に紹介するのは、
            実際にビュースクリプトのパスを決定するメソッドと
            ビューのレンダリングを行うメソッドです。以下をご覧ください。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">renderScript($script, $name)</span>
                    は、指定したパスのスクリプトをレンダリングします。
                    オプションで、パスセグメントの名前を指定することもできます。
                    このメソッドを使用する際には、<em class="emphasis">ViewRenderer</em>
                    はスクリプト名を自動的に決定することはありません。
                    そのかわりに、<var class="varname">$script</var> で指定された内容を直接
                    ビューオブジェクトの  <span class="methodname">render()</span> メソッドに渡します。
                </p>

                <blockquote><p><b class="note">Note</b>: 
                    レスポンスオブジェクトにビューがレンダリングされると、
                    自動的に <em class="emphasis">noRender</em> を設定します。
                    これにより、同じビュースクリプトを間違って複数回レンダリングしてしまうことを防ぎます。
                <br /></p></blockquote>

                <blockquote><p><b class="note">Note</b>: 
                    
                        デフォルトでは、
                         <span class="methodname">Zend_Controller_Action::renderScript()</span>
                        は <em class="emphasis">ViewRenderer</em> の
                         <span class="methodname">renderScript()</span> メソッドへのプロキシとなります。
                    <br />
                </p></blockquote>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getViewScript($action, $vars)</span>
                    は、渡されたアクションや <var class="varname">$vars</var>
                    で指定した変数の値に基づいてビュースクリプトのパスを作成します。
                    <var class="varname">$vars</var> 配列のキーは、パスを指定するためのキー
                    (&#039;moduleDir&#039;、&#039;module&#039;、&#039;controller&#039;、&#039;action&#039; および &#039;suffix&#039;)
                    のいずれかとなります。渡された変数の値をもとにしてパスを作成します。
                    なにも渡されなかった場合は、現在のリクエストの内容をもとにしてパスを作成します。
                </p>

                <p class="para">
                     <span class="methodname">getViewScript()</span>
                    は、<em class="emphasis">noController</em> フラグの内容によって
                    <em class="emphasis">viewScriptPathSpec</em> あるいは
                    <em class="emphasis">viewScriptPathNoControllerSpec</em> のいずれかを使用します。
                </p>

                <p class="para">
                    モジュール名やコントローラ名、アクション名にあらわれる
                    単語の区切りは、ダッシュ (&#039;-&#039;) に置き換えられます。
                    したがって、たとえばコントローラ名が &#039;<strong class="command">foo.bar</strong>&#039;
                    でアクション名が &#039;<strong class="command">baz:bat</strong>&#039; だったとすると、
                    デフォルトのパス指定をもとにしたビュースクリプトのパスは
                    &#039;<var class="filename">foo-bar/baz-bat.phtml</var>&#039; となります。
                </p>

                <blockquote><p><b class="note">Note</b>: 
                    
                        デフォルトでは、
                         <span class="methodname">Zend_Controller_Action::getViewScript()</span>
                        は <em class="emphasis">ViewRenderer</em> の
                         <span class="methodname">getViewScript()</span> メソッドへのプロキシとなります。
                    <br />
                </p></blockquote>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">render($action, $name, $noController)</span>
                    は、まず <var class="varname">$name</var> あるいは
                    <var class="varname">$noController</var> が指定されているかどうかを調べます。
                    指定されている場合は、ViewRenderer の対応するフラグ
                    (それぞれ responseSegment と noController) を設定します。
                    次に、<var class="varname">$action</var> 引数が指定されていれば、
                    それを  <span class="methodname">getViewScript()</span> に渡します。
                    最後に、取得したビュースクリプトのパスを
                     <span class="methodname">renderScript()</span> に渡します。
                </p>

                <blockquote><p><b class="note">Note</b>: 
                    
                         <span class="methodname">render()</span> を使用する際には、その副作用に注意しましょう。
                        レスポンスセグメント名や noController
                        フラグに指定した内容は、そのオブジェクト内で残り続けます。
                        さらに、レンダリングが完了した際に noRender
                        も設定されます。
                    <br />
                </p></blockquote>

                <blockquote><p><b class="note">Note</b>: 
                    
                        デフォルトでは、
                         <span class="methodname">Zend_Controller_Action::render()</span> は
                        <em class="emphasis">ViewRenderer</em> の  <span class="methodname">render()</span>
                        メソッドへのプロキシとなります。
                    <br />
                </p></blockquote>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">renderBySpec($action, $vars, $name)</span>
                    は、パス指定用の変数を渡してビュースクリプトのパスを決定します。
                    <var class="varname">$action</var> および <var class="varname">$vars</var> の内容を
                     <span class="methodname">getScriptPath()</span> に、そしてその結果得られたスクリプトのパスと
                    <var class="varname">$name</var> を  <span class="methodname">renderScript()</span> に渡します。
                </p>
            </li>
        </ul>
    </div>

    <div class="section" id="zend.controller.actionhelper.viewrenderer.basicusage" name="zend.controller.actionhelper.viewrenderer.basicusage"><div class="info"><h1 class="title">基本的な使用例</h1></div>
        

        <div class="example"><div class="info"><p><b>Example #9 基本的な使用法</b></p></div>
            

            <div class="example-contents"><p>
                最も基本的な使用法は、起動ファイル内で <em class="emphasis">ViewRenderer</em>
                を作成してヘルパーブローカに登録し、
                アクションメソッドで変数の値を設定するというものです。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 起動ファイル内で</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">getStaticHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'viewRenderer'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 'foo' モジュールの 'bar' コントローラ</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> Foo_BarController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// デフォルトで bar/index.phtml をレンダリングするので、特に何もする必要はありません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> indexAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 変数 'foo' の値を 'bar' に設定して bar/populate.phtml をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ビューオブジェクトは既に preDispatch() で定義されているので、既に使用可能です</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> populateAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">view</span>-&gt;<span style="color: #006600;">foo</span> = <span style="color: #ff0000;">'bar'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何もレンダリングせずに別のアクションに転送します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 転送先のアクションで何らかのレンダリングを行います</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> bazAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_forward<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'index'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何もレンダリングせず別の場所にリダイレクトします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> batAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_redirect<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/index'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <blockquote><p><b class="note">Note</b>: <span class="info"><b>命名規約: コントローラ名やアクション名の単語の区切り</b><br /></span>
            
            
                コントローラやアクションの名前が複数の単語からなるものである場合、
                ディスパッチャには、特定のパスや区切り文字を使用して単語を区切った
                <acronym class="acronym">URL</acronym> を指定しなければなりません。
                <em class="emphasis">ViewRenderer</em> は、コントローラ名の中にあるパス区切り文字を
                実際のパス区切り文字 (&#039;/&#039;) に置き換え、単語区切り文字をダッシュ
                (&#039;-&#039;) に置き換えてパスを作成します。したがって、
                アクション <var class="filename">/foo.bar/baz.bat</var> をコールすると
                <var class="filename">FooBarController.php</var> の
                 <span class="methodname">FooBarController::bazBatAction()</span> へディスパッチされ、
                <var class="filename">foo-bar/baz-bat.phtml</var> をレンダリングすることになります。
                また、アクション <var class="filename">/bar_baz/baz-bat</var> をコールすると
                <var class="filename">Bar/BazController.php</var> (パス区切り文字に注意) の
                 <span class="methodname">Bar_BazController::bazBatAction()</span>
                へディスパッチされ、<var class="filename">bar/baz/baz-bat.phtml</var>
                をレンダリングすることになります。
            <br />

            
                二番目の例では、モジュールはデフォルトモジュールのままであることに注意しましょう。
                しかし、パス区切り文字があるために、
                <var class="filename">Bar/BazController.php</var> にある
                <span class="classname">Bar_BazController</span> を受け取ることになります。
                ビューレンダラはコントローラのディレクトリ階層を模倣します。
            <br />
        </p></blockquote>

        <div class="example"><div class="info"><p><b>Example #10 自動レンダリングの無効化</b></p></div>
            

            <div class="example-contents"><p>
                アクションやコントローラによっては、自動レンダリングを無効にしたいこともあるでしょう。
                たとえば、HTML 以外 (<acronym class="acronym">XML</acronym> や <acronym class="acronym">JSON</acronym> など) を出力したい場合や
                単に何も出力したくない場合などです。
                そんな場合には以下のいずれかの方法を使用します。
                つまり、すべての自動レンダリングを無効にする
                ( <span class="methodname">setNeverRender()</span>) か、あるいは現在のアクションでだけ
                自動レンダリングを無効にする ( <span class="methodname">setNoRender()</span>) かです。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Bar モジュールの Baz コントローラクラス</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> Bar_BazController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> fooAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// このアクションでは自動レンダリングを行いません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span>-&gt;<span style="color: #006600;">setNoRender</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Bar モジュールの Bat コントローラクラス</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> Bar_BatController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> preDispatch<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// このコントローラのアクションでは決して自動レンダリングを行いません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span>-&gt;<span style="color: #006600;">setNoRender</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <blockquote><p><b class="note">Note</b>: 
            
                たいていの場合は、自動レンダリングを全体で無効にする
                ( <span class="methodname">setNeverRender()</span>) のは無意味です。
                なぜなら、<em class="emphasis">ViewRenderer</em> の唯一の存在意義が、
                ビューオブジェクトを自動的に設定することだからです。
            <br />
        </p></blockquote>

        <div class="example"><div class="info"><p><b>Example #11 別のビュースクリプトの選択</b></p></div>
            

            <div class="example-contents"><p>
                アクション名から自動的に決まるスクリプトではなく、
                それ以外のものをレンダリングしたくなる場合もあるでしょう。
                たとえば、add アクションと edit アクションのふたつを持つコントローラがあったとしましょう。
                どちらのアクションも同じ &#039;form&#039; ビューを表示しますが、
                そこに設定する値が異なります。
                そんな場合に、それぞれでスクリプト名を変えるのは簡単です。
                 <span class="methodname">setScriptAction()</span> や  <span class="methodname">setRender()</span>
                を使用するか、あるいはヘルパーをメソッドとして呼び出します。
                これは  <span class="methodname">setRender()</span> を起動します。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Foo モジュールの Bar コントローラクラス</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> Foo_BarController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> addAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 'bar/add.phtml' ではなく 'bar/form.phtml' をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'form'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> editAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 'bar/edit.phtml' ではなく 'bar/form.phtml' をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span>-&gt;<span style="color: #006600;">setScriptAction</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'form'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> processAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何かのチェックをした後で...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>!<span style="color: #0000ff;">$valid</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 'bar/process.phtml' ではなく 'bar/form.phtml' をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span>-&gt;<span style="color: #006600;">setRender</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'form'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #b1b100;">return</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// その他の処理を続けます...</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <div class="example"><div class="info"><p><b>Example #12 登録されているビューの変更</b></p></div>
            

            <div class="example-contents"><p>
                ビューオブジェクトの設定を変更したくなったとしましょう。
                たとえば、ヘルパーのパスやエンコーディングを変更したくなったらどうしますか?
                そんな場合は、コントローラに設定されているビューオブジェクトを変更するか、
                あるいは <em class="emphasis">ViewRenderer</em> の外部からビューオブジェクトを取得します。
                どちらも同じオブジェクトへの参照を取得することになります。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Foo モジュールの Bar コントローラクラス</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> Foo_BarController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> preDispatch<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ビューのエンコーディングを変更します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">view</span>-&gt;<span style="color: #006600;">setEncoding</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'UTF-8'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> bazAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ビューオブジェクトを取得し、エスケープ用のコールバックを 'htmlspecialchars' に設定します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$view</span> = <span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">viewRenderer</span>-&gt;<span style="color: #006600;">view</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$view</span>-&gt;<span style="color: #006600;">setEscape</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'htmlspecialchars'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>
    </div>

    <div class="section" id="zend.controller.actionhelper.viewrenderer.advancedusage" name="zend.controller.actionhelper.viewrenderer.advancedusage"><div class="info"><h1 class="title">高度な使用例</h1></div>
        

        <div class="example"><div class="info"><p><b>Example #13 パスの指定方法の変更</b></p></div>
            

            <div class="example-contents"><p>
                場合によっては、デフォルトのパス指定があなたのサイトに
                うまく当てはまらないこともあるでしょう。
                たとえば、すべてのテンプレートを単一のディレクトリ配下にまとめ、
                デザイナにはそのディレクトリに対するアクセス権だけを与えたいといった場合です
                (<a href="http://smarty.php.net/" class="link external">&raquo; Smarty</a>
                を使用する場合などにありがちです)。
                そんな場合は、ビューの基底パスをハードコーディングし、
                それをアクションのビュースクリプトのパスとして使用することになります。
            </p></div>

            <div class="example-contents"><p>
                この例では、ビューの基底パスを &#039;<var class="filename">/opt/vendor/templates</var>&#039;
                とし、ビュースクリプトのパスは &#039;<var class="filename">:moduleDir/:controller/:action.:suffix</var>&#039;
                となるようにします。<em class="emphasis">noController</em>
                フラグが設定されている場合は、サブディレクトリ (&#039;<var class="filename">:action.:suffix</var>&#039;)
                からではなくトップディレクトリからのパスとして探すことになります。
                最後に、ビュースクリプトのファイルの拡張子として
                &#039;tpl&#039; を設定します。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">/**</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;"> * 起動ファイル</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;"> */</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 別のビュー実装を使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$view</span> = <span style="color: #000000; font-weight: bold;">new</span> ZF_Smarty<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Controller_Action_Helper_ViewRenderer<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$view</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$viewRenderer</span>-&gt;<span style="color: #006600;">setViewBasePathSpec</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'/opt/vendor/templates'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">setViewScriptPathSpec</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">':module/:controller/:action.:suffix'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">setViewScriptPathNoControllerSpec</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">':action.:suffix'</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;-&gt;<span style="color: #006600;">setViewSuffix</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'tpl'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Controller_Action_HelperBroker::<span style="color: #006600;">addHelper</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$viewRenderer</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <div class="example"><div class="info"><p><b>Example #14 単一のアクションから複数のビュースクリプトをレンダリングする例</b></p></div>
            

            <div class="example-contents"><p>
                時には、複数のビュースクリプトをひとつのアクションで処理したいこともあるでしょう。
                これは、非常に直感的な方法で実現できます。単に
                 <span class="methodname">render()</span> を必要なだけコールすればいいのです。
            </p></div>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #000000; font-weight: bold;">class</span> SearchController <span style="color: #000000; font-weight: bold;">extends</span> Zend_Controller_Action</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> resultsAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// $this-&gt;model に現在のモデルが設定されているものとします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">view</span>-&gt;<span style="color: #006600;">results</span> =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">model</span>-&gt;<span style="color: #006600;">find</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$this</span>-&gt;_getParam<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'query'</span>, <span style="color: #ff0000;">''</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// render() は、デフォルトでは ViewRenderer へのプロキシとなります。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// まず form を、そして results をレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">render</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'form'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$this</span>-&gt;<span style="color: #006600;">render</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'results'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #000000; font-weight: bold;">public</span> <span style="color: #000000; font-weight: bold;">function</span> formAction<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何もしなくても、ViewRenderer が自動的にビュースクリプトをレンダリングします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>
    </div>
</div>
    </div>

    <div class="section" id="zend.controller.actionhelper.writingyourown" name="zend.controller.actionhelper.writingyourown"><div class="info"><h1 class="title">独自のヘルパーの作成</h1></div>
        

        <p class="para">
            アクションヘルパーは、抽象クラス
            <span class="classname">Zend_Controller_Action_Helper_Abstract</span>
            を継承して作成します。
            ここには、基本的なインターフェイスやヘルパーブローカが使用する必須機能などが含まれています。
            具体的には、次のようなメソッドです。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                     <span class="methodname">setActionController()</span>
                    を使用して、現在のアクションコントローラを設定します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">init()</span>
                    はヘルパーブローカによって起動時に実行され、
                    ヘルパーを初期化します。これは、
                    アクションチェイン内の複数のコントローラで同一のヘルパーを使用している場合に
                    状態をリセットする際などに便利です。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">preDispatch()</span>
                    はディスパッチアクションの前に実行されます。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">postDispatch()</span>
                    はディスパッチアクションが終了した後で実行されます。
                     <span class="methodname">preDispatch()</span> プラグインがアクションの処理をスキップした場合も、
                    これは実行されます。後始末などをここで行います。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getRequest()</span>
                    は現在のリクエストオブジェクトを取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getResponse()</span>
                    は現在のレスポンスオブジェクトを取得します。
                </p>
            </li>

            <li class="listitem">
                <p class="para">
                     <span class="methodname">getName()</span>
                    はヘルパーの名前を取得します。
                    クラス名にアンダースコアが含まれる場合は最後のアンダースコア以降の文字、
                    そうでない場合はクラス名全体を返します。たとえば、クラス名が
                    <span class="classname">Zend_Controller_Action_Helper_Redirector</span>
                    の場合は <em class="emphasis">Redirector</em> を、クラス名が
                    <span class="classname">FooMessage</span> の場合はそのままの名前を返します。
                </p>
            </li>
        </ul>

        <p class="para">
            オプションで、ヘルパークラスに  <span class="methodname">direct()</span>
            メソッドを実装することもできます。これを定義しておくと、
            ヘルパーブローカのメソッドであるかのようにそのヘルパーを扱えるようになります。
            これにより、一度だけ使用するようなヘルパーが扱いやすくなります。
            たとえば、<a href="zend.controller.actionhelpers.html#zend.controller.actionhelpers.redirector" class="link">redirector</a>
            の  <span class="methodname">direct()</span> は  <span class="methodname">goto()</span>
            のエイリアスとなっているので、このようにして使用できます。
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// /blog/view/item/id/42 にリダイレクトします</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$this</span>-&gt;_helper-&gt;<span style="color: #006600;">redirector</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'item'</span>, <span style="color: #ff0000;">'view'</span>, <span style="color: #ff0000;">'blog'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'id'</span> =&gt; <span style="color: #cc66cc;">42</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            内部的には、まずヘルパーブローカの  <span class="methodname">__call()</span>
            メソッドが <em class="emphasis">redirector</em> という名前のヘルパーを探し、
            それからそのヘルパーで  <span class="methodname">direct()</span>
            メソッドが定義されているかどうかを調べ、
            渡された引数でそのメソッドをコールしています。
        </p>

        <p class="para">
            独自のヘルパークラスを作成した場合は、
            上で説明したようにしてそれを利用できるようにしておきましょう。
        </p>
    </div>
</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.controller.action.html">アクションコントローラ</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.controller.html">Zend_Controller</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.controller.response.html">レスポンスオブジェクト</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.controller.html">Zend_Controller</a></li>
  <li><a href="zend.controller.quickstart.html">Zend_Controller クイックスタート</a></li>
  <li><a href="zend.controller.basics.html">Zend_Controller の基本</a></li>
  <li><a href="zend.controller.front.html">フロントコントローラ</a></li>
  <li><a href="zend.controller.request.html">リクエストオブジェクト</a></li>
  <li><a href="zend.controller.router.html">標準のルータ</a></li>
  <li><a href="zend.controller.dispatcher.html">ディスパッチャ</a></li>
  <li><a href="zend.controller.action.html">アクションコントローラ</a></li>
  <li class="active"><a href="zend.controller.actionhelpers.html">アクションヘルパー</a></li>
  <li><a href="zend.controller.response.html">レスポンスオブジェクト</a></li>
  <li><a href="zend.controller.plugins.html">プラグイン</a></li>
  <li><a href="zend.controller.modular.html">モジュラーディレクトリ構造の規約の使用</a></li>
  <li><a href="zend.controller.exceptions.html">MVC での例外</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>