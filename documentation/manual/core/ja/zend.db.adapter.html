<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Zend_Db_Adapter(日本語) - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.db.html">Zend_Db</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.db.html">Zend_Db</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.db.statement.html">Zend_Db_Statement(日本語)</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.db.adapter" class="section"><div class="info"><h1 class="title">Zend_Db_Adapter(日本語)</h1></div>

    

    <p class="para">
        <span class="classname">Zend_Db</span> とその関連クラス群は、Zend Framework
        において <acronym class="acronym">SQL</acronym> データベースとのインターフェイスを担当します。
        <span class="classname">Zend_Db_Adapter</span> は、<acronym class="acronym">PHP</acronym> アプリケーションから <acronym class="acronym">RDBMS</acronym>
        に接続する際に使用する基本クラスです。
        <acronym class="acronym">RDBMS</acronym> の種類に応じて、それぞれ個別のアダプタクラスがあります。
    </p>

    <p class="para">
        <span class="classname">Zend_Db</span> のアダプタは、
        ベンダ固有の <acronym class="acronym">PHP</acronym> 拡張モジュールを共通インターフェイスにとりまとめる役割を果たします。
        これにより、いちど書いた <acronym class="acronym">PHP</acronym> アプリケーションが
        ほんの少しの手間で複数 <acronym class="acronym">RDBMS</acronym> に対応するようになります。
    </p>

    <p class="para">
        アダプタクラスのインターフェイスは、
        <a href="http://jp.php.net/pdo" class="link external">&raquo; PHP Data Objects</a>
        拡張モジュールのインターフェイスと似ています。
        <span class="classname">Zend_Db</span> では、次の <acronym class="acronym">RDBMS</acronym> 用の <acronym class="acronym">PDO</acronym> ドライバに対するアダプタクラスを用意しています。
    </p>

    <ul class="itemizedlist">
        <li class="listitem">
            <p class="para">
                <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> および Informix Dynamic Server (<acronym class="acronym">IDS</acronym>) (<a href="http://jp.php.net/pdo-ibm" class="link external">&raquo; pdo_ibm</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>

        <li class="listitem">
            <p class="para">
                MariaDB (<a href="http://jp.php.net/pdo-mysql" class="link external">&raquo; pdo_mysql</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>

        <li class="listitem">
            <p class="para">
                MySQL (<a href="http://jp.php.net/pdo-mysql" class="link external">&raquo; pdo_mysql</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Microsoft <acronym class="acronym">SQL</acronym> Server (<a href="http://jp.php.net/pdo-dblib" class="link external">&raquo; pdo_dblib</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Oracle (<a href="http://jp.php.net/pdo-oci" class="link external">&raquo; pdo_oci</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                PostgreSQL (<a href="http://jp.php.net/pdo-pgsql" class="link external">&raquo; pdo_pgsql</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                SQLite (<a href="http://jp.php.net/pdo-sqlite" class="link external">&raquo; pdo_sqlite</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>

    </ul>

    <p class="para">
        さらに、<span class="classname">Zend_Db</span> では、
        以下の <acronym class="acronym">RDBMS</acronym> 用の拡張モジュールを使用するアダプタクラスも用意しています。
    </p>

    <ul class="itemizedlist">
        <li class="listitem">
            <p class="para">
                MariaDB (<a href="http://jp.php.net/mysqli" class="link external">&raquo; mysqli</a> <acronym class="acronym">PHP</acronym> 拡張モジュールを使用)
            </p>
        </li>

        <li class="listitem">
            <p class="para">
                MySQL (<a href="http://jp.php.net/mysqli" class="link external">&raquo; mysqli</a> を使用します)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Oracle (<a href="http://jp.php.net/oci8" class="link external">&raquo; oci8</a> を使用します)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> および <acronym class="acronym">DB2</acronym> i5 (<a href="http://jp.php.net/ibm_db2" class="link external">&raquo; ibm_db2</a> を使用します)
            </p>
        </li>
        <li class="listitem">
            <p class="para">
                Firebird (Interbase) (<a href="http://jp.php.net/ibase" class="link external">&raquo; php_interbase</a> を使用します)
            </p>
        </li>
    </ul>

    <blockquote><p><b class="note">Note</b>: 
        
            <span class="classname">Zend_Db</span> のアダプタは、どれも <acronym class="acronym">PHP</acronym> の拡張モジュールを使用しています。
            <span class="classname">Zend_Db</span> のアダプタを使用するには、
            対応する <acronym class="acronym">PHP</acronym> 拡張モジュールが使用できる環境でなければなりません。
            たとえば、<acronym class="acronym">PDO</acronym> 系の Zend_Db アダプタを使用するのなら、
            <acronym class="acronym">PDO</acronym> 拡張モジュールが必要で、
            また使用する <acronym class="acronym">RDBMS</acronym> 用の <acronym class="acronym">PDO</acronym> ドライバも必要となります。
        <br />
    </p></blockquote>

    <div class="section" id="zend.db.adapter.connecting" name="zend.db.adapter.connecting"><div class="info"><h1 class="title">アダプタを使用したデータベース接続</h1></div>

        

        <p class="para">
            ここでは、データベースアダプタのインスタンスを作成する方法を説明します。
            これは、<acronym class="acronym">PHP</acronym> アプリケーションから <acronym class="acronym">RDBMS</acronym>
            サーバへの接続を確立することに対応します。
        </p>

        <div class="section" id="zend.db.adapter.connecting.constructor" name="zend.db.adapter.connecting.constructor"><div class="info"><h1 class="title">Zend_Db アダプタのコンストラクタの使用</h1></div>

            

            <p class="para">
                コンストラクタを使用して、アダプタのインスタンスを作成できます。
                アダプタのコンストラクタが受け取る引数はひとつで、
                接続を確立するために必要なパラメータを配列で渡します。
            </p>

            <div class="example"><div class="info"><p><b>Example #1 アダプタのコンストラクタの使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Db_Adapter_Pdo_Mysql<span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.connecting.factory" name="zend.db.adapter.connecting.factory"><div class="info"><h1 class="title">Zend_Db のファクトリの使用</h1></div>

            

            <p class="para">
                コンストラクタを直接使用する以外の方法として、静的メソッド
                 <span class="methodname">Zend_Db::factory()</span> を使用することもできます。
                このメソッドは、必要に応じて
                <a href="zend.loader.load.html#zend.loader.load.class" class="link">Zend_Loader::loadClass()</a>
                を使用して動的にアダプタクラスを読み込みます。
            </p>

            <p class="para">
                最初の引数には、アダプタクラスのベース名を文字列で指定します。
                たとえば、文字列 &#039;<span class="classname">Pdo_Mysql</span>&#039; は <span class="classname">Zend_Db_Adapter_Pdo_Mysql</span>
                クラスに対応します。その次の引数は、
                アダプタのコンストラクタに指定するのと同じ形式の配列となります。
            </p>

            <div class="example"><div class="info"><p><b>Example #2 ファクトリメソッドの使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 次の文は不要です。Zend_Db_Adapter_Pdo_Mysql ファイルは</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Zend_Db の factory メソッドが読み込みます。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// require_once 'Zend/Db/Adapter/Pdo/Mysql.php';</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 自動的に Zend_Db_Adapter_Pdo_Mysql クラスを読み込み、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// そのインスタンスを作成します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                独自に <span class="classname">Zend_Db_Adapter_Abstract</span>
                の派生クラスを作成し、そのクラス名のプレフィックスが
                &quot;<span class="classname">Zend_Db_Adapter</span>&quot; でない場合に  <span class="methodname">factory()</span>
                でそのアダプタを読み込むには、
                作成したクラス名の先頭の部分をパラメータ配列のキー
                &#039;adapterNamespace&#039; で指定します。
            </p>

            <div class="example"><div class="info"><p><b>Example #3 自作のアダプタクラスをアダプタのファクトリメソッドで使用する方法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// アダプタのクラスファイルの読み込みは不要です</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Zend_Db の factory メソッドが読み込みます</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 自動的に MyProject_Db_Adapter_Pdo_Mysql クラスを読み込み、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// インスタンスを作成します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'adapterNamespace'</span> =&gt; <span style="color: #ff0000;">'MyProject_Db_Adapter'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.connecting.factory-config" name="zend.db.adapter.connecting.factory-config"><div class="info"><h1 class="title">Zend_Db ファクトリでの Zend_Config の使用</h1></div>

            

            <p class="para">
                 <span class="methodname">factory()</span> メソッドの引数として、
                <a href="zend.config.html" class="link">Zend_Config</a>
                のオブジェクトを渡すこともできます。
            </p>

            <p class="para">
                最初の引数に config オブジェクトを渡す場合は、そのプロパティに
                <span class="property">adapter</span> が含まれているものとします。
                そこに、アダプタクラス名を表す文字列を指定します。
                また、オプションで <span class="property">params</span> というプロパティも指定することができ、
                その配下のサブプロパティとしてアダプタのパラメータ名を指定します。
                これは、 <span class="methodname">factory()</span> メソッドの
                2 番目のパラメータを省略した場合にのみ読み込まれます。
            </p>

            <div class="example"><div class="info"><p><b>Example #4 アダプタのファクトリメソッドでの Zend_Config オブジェクトの使用</b></p></div>
                
                <div class="example-contents"><p>
                    次の例では、配列から <span class="classname">Zend_Config</span> オブジェクトを作成します。
                    それ以外にも、
                    <a href="zend.config.adapters.ini.html" class="link">Zend_Config_Ini</a>
                    や <a href="zend.config.adapters.xml.html" class="link">Zend_Config_Xml</a>
                    などを用いて外部ファイルからデータを読み込むこともできます。
                </p></div>
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$config</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Config<span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'database'</span> =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'adapter'</span> =&gt; <span style="color: #ff0000;">'Mysqli'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'params'</span>&nbsp; =&gt; <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'username'</span> =&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'password'</span> =&gt; <span style="color: #ff0000;">'secret'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$config</span>-&gt;<span style="color: #006600;">database</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                 <span class="methodname">factory()</span> メソッドの 2 番目の引数には、
                アダプタのパラメータに対応するエントリをもつ連想配列となります。
                この引数はオプションです。最初の引数が <span class="classname">Zend_Config</span>
                である場合は、そこにすべてのパラメータが含まれているものとみなし、
                2 番目の引数は無視されます。
            </p>

        </div>

        <div class="section" id="zend.db.adapter.connecting.parameters" name="zend.db.adapter.connecting.parameters"><div class="info"><h1 class="title">アダプタのパラメータ</h1></div>

            

            <p class="para">
                <span class="classname">Zend_Db</span> のアダプタクラスで使用できるパラメータを以下にまとめます。
            </p>

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">host</em>:
                        データベースサーバのホスト名あるいは IP アドレス。
                        データベースが <acronym class="acronym">PHP</acronym> アプリケーションと同じホスト上で動いている場合は、
                        &#039;localhost&#039; あるいは &#039;127.0.0.1&#039; を指定します。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">username</em>:
                        <acronym class="acronym">RDBMS</acronym> サーバへの接続時に使用する認証用アカウントの ID。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">password</em>:
                        <acronym class="acronym">RDBMS</acronym> サーバへの接続時に使用する認証用パスワード。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">dbname</em>:
                        <acronym class="acronym">RDBMS</acronym> サーバ上のデータベースインスタンス名。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">port</em>:
                        <acronym class="acronym">RDBMS</acronym> サーバによっては、管理者が指定した
                        ポート番号によるネットワーク接続を許可しているものもあります。
                        このパラメータを使用すると、<acronym class="acronym">PHP</acronym>
                        アプリケーションが接続時に使用するポート番号を指定できます。
                        これは <acronym class="acronym">RDBMS</acronym> サーバの設定にあわせなければなりません。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">charset</em>:
                        接続に使用する文字セットを指定します。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">options</em>:
                        このパラメータは、すべての <span class="classname">Zend_Db_Adapter</span>
                        クラスで共通のオプションを連想配列で指定します。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">driver_options</em>:
                        このパラメータは、各データベース拡張モジュールに固有の
                        追加オプションを連想配列で指定します。
                        典型的な使用例としては、<acronym class="acronym">PDO</acronym> ドライバの属性などがあります。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">adapterNamespace</em>:
                        アダプタクラスの名前の先頭が &#039;<span class="classname">Zend_Db_Adapter</span>&#039;
                        以外である場合に、それを指定します。これは、
                        Zend 以外が作成したアダプタクラスを
                         <span class="methodname">factory()</span> メソッドで使いたい場合に指定します。
                    </p>
                </li>
            </ul>

            <div class="example"><div class="info"><p><b>Example #5 ファクトリでの大文字小文字変換オプションの指定</b></p></div>
                
                <div class="example-contents"><p>
                    このオプションは、定数
                    <b><tt>Zend_Db::CASE_FOLDING</tt></b> で指定します。
                    これは、<acronym class="acronym">PDO</acronym> や <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> データベースドライバにおける
                    <b><tt>ATTR_CASE</tt></b> 属性に対応するもので、
                    結果セットの文字列キーの大文字小文字変換を指定します。
                    設定できる値は
                    <b><tt>Zend_Db::CASE_NATURAL</tt></b> (デフォルト)、
                    <b><tt>Zend_Db::CASE_UPPER</tt></b> および
                    <b><tt>Zend_Db::CASE_LOWER</tt></b> のいずれかです。
                </p></div>
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$options</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Db::<span style="color: #006600;">CASE_FOLDING</span> =&gt; Zend_Db::<span style="color: #006600;">CASE_UPPER</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'options'</span>&nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #0000ff;">$options</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Db2'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <div class="example"><div class="info"><p><b>Example #6 ファクトリでの自動クォートオプションの指定</b></p></div>
                
                <div class="example-contents"><p>
                    このオプションは、定数
                    <b><tt>Zend_Db::AUTO_QUOTE_IDENTIFIERS</tt></b> で指定します。
                    この値が <b><tt>TRUE</tt></b> (デフォルト) の場合は、
                    アダプタが生成する <acronym class="acronym">SQL</acronym> 文中のテーブル名やカラム名、
                    エイリアスといった識別子をすべてクォートします。これにより、
                    <acronym class="acronym">SQL</acronym> のキーワードや特殊文字を含む識別子を使用できるようになります。
                    この値が <b><tt>FALSE</tt></b> の場合は、
                    識別子の自動クォートは行いません。
                    クォートすべき文字を使用している場合は、自分で
                     <span class="methodname">quoteIdentifier()</span> メソッドをコールする必要があります。
                </p></div>
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$options</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Db::<span style="color: #006600;">AUTO_QUOTE_IDENTIFIERS</span> =&gt; <span style="color: #000000; font-weight: bold;">false</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'options'</span>&nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #0000ff;">$options</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <div class="example"><div class="info"><p><b>Example #7 ファクトリでの PDO ドライバのオプションの指定</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$pdoParams</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; PDO::<span style="color: #006600;">MYSQL_ATTR_USE_BUFFERED_QUERY</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'driver_options'</span> =&gt; <span style="color: #0000ff;">$pdoParams</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; -&gt;<span style="color: #006600;">getAttribute</span><span style="color: #66cc66;">&#40;</span>PDO::<span style="color: #006600;">MYSQL_ATTR_USE_BUFFERED_QUERY</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <div class="example"><div class="info"><p><b>Example #8 ファクトリでのシリアライズオプションの指定</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$options</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Db::<span style="color: #006600;">ALLOW_SERIALIZATION</span> =&gt; <span style="color: #000000; font-weight: bold;">false</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$params</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'options'</span>&nbsp; &nbsp; &nbsp; &nbsp; =&gt; <span style="color: #0000ff;">$options</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$params</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.connecting.getconnection" name="zend.db.adapter.connecting.getconnection"><div class="info"><h1 class="title">遅延接続の管理</h1></div>
            

            <p class="para">
                アダプタクラスのインスタンスを作成した時点では、
                まだ <acronym class="acronym">RDBMS</acronym> サーバへの接続は行われません。
                接続用のパラメータを内部で保持しておき、
                実際にクエリを実行することになった時点で初めて接続を確立します。
                これにより、アダプタオブジェクトをすばやく作成できるようになっています。
                つまり、そのリクエストの中で
                実際にデータベースクエリを発行するかどうかが確定していなくても、
                とりあえずアダプタのインスタンスを作成しておくということもできます。
            </p>

            <p class="para">
                強制的に <acronym class="acronym">RDBMS</acronym> との接続を確立する必要がある場合は、
                 <span class="methodname">getConnection()</span> メソッドを使用します。
                このメソッドは、対応する <acronym class="acronym">PHP</acronym> 拡張モジュール用の接続オブジェクトを返します。
                たとえば、<acronym class="acronym">PDO</acronym> ドライバ系のアダプタクラスを使った場合は、
                 <span class="methodname">getConnection()</span> は
                データベースとの接続を確立してから <acronym class="acronym">PDO</acronym> オブジェクトを返します。
            </p>

            <p class="para">
                データベースへの接続時に発生する例外、
                すなわち ID やパスワードの間違いなどを捕捉したい場合に、
                これは役立つでしょう。
                実際に接続を行うまで例外はスローされないので、
                どこか一か所に例外処理をまとめておいたほうが
                アプリケーションがシンプルになって便利でしょう。
            </p>

            <p class="para">
                さらに、アダプタをシリアライズしてたとえばセッション変数などに格納することもできます。
                これは、アダプタだけでなくアダプタを利用する側
                (<span class="classname">Zend_Db_Select</span> オブジェクトなど) にとっても有用です。
                デフォルトではアダプタのシリアライズが許可されています。
                シリアライズをしたくない場合は、上の例のように
                <b><tt>Zend_Db::ALLOW_SERIALIZATION</tt></b> オプションに <b><tt>FALSE</tt></b> を渡します。
                遅延接続の理念を尊重し、アンシリアライズされたアダプタの
                自動再接続は行いません。つまり、自分で
                 <span class="methodname">getConnection()</span> をコールしなければなりません。
                自動再接続を有効にするには、アダプタのオプションとして
                <b><tt>Zend_Db::AUTO_RECONNECT_ON_UNSERIALIZE</tt></b> に <b><tt>TRUE</tt></b>
                を渡します。
            </p>

            <div class="example"><div class="info"><p><b>Example #9 接続時の例外処理</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">try <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Pdo_Mysql'</span>, <span style="color: #0000ff;">$parameters</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> catch <span style="color: #66cc66;">&#40;</span>Zend_Db_Adapter_Exception <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// ID かパスワードが間違っている、あるいは RDBMS が起動していないなど……</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> catch <span style="color: #66cc66;">&#40;</span>Zend_Exception <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// factory() が指定したアダプタクラスを読み込めなかったなど……</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

            </div>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.example-database" name="zend.db.adapter.example-database"><div class="info"><h1 class="title">サンプルデータベース</h1></div>

        

        <p class="para">
            <span class="classname">Zend_Db</span> クラスのドキュメントでは、
            クラスやメソッドの使用法を説明するために単純なデータベースを使用します。
            これは、とあるソフトウェア開発プロジェクトにおけるバグ管理を想定したものです。
            次の 4 つのテーブルで構成されています。
        </p>

        <ul class="itemizedlist">
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">accounts</em> テーブルには、
                    バグ管理データベースを使用するユーザについての情報を格納します。
                </p>
            </li>
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">products</em> テーブルには、
                    バグを記録する対象となる製品についての情報を格納します。
                </p>
            </li>
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">bugs</em> テーブルには、
                    バグについての情報を格納します。
                    バグの状態や報告者、修正担当者、検証担当者などの情報が含まれます。
                </p>
            </li>
            <li class="listitem">
                <p class="para">
                    <em class="emphasis">bugs_products</em> テーブルには、
                    バグと製品の関連付け情報を格納します。
                    これは、いわゆる多対多のリレーションシップを実装するものです。
                    ひとつのバグが複数の製品に関連するものであることもあれば、
                    当然ひとつの製品には複数のバグが存在するからです。
                </p>
            </li>
        </ul>

        <p class="para">
            このサンプルデータベースを作成するための <acronym class="acronym">SQL</acronym>
            の擬似コードは、次のようになります。
            これらのテーブルは、<span class="classname">Zend_Db</span> 自体のユニットテストでも使用します。
        </p>

        <div class="programlisting sql"><div class="sqlcode"><div class="sql" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> accounts <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; account_name&nbsp; &nbsp; &nbsp; VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> products <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; product_id&nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; product_name&nbsp; &nbsp; &nbsp; VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> bugs <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_description&nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_status&nbsp; &nbsp; &nbsp; &nbsp; VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">20</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; reported_by&nbsp; &nbsp; &nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> accounts<span style="color: #66cc66;">&#40;</span>account_name<span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; assigned_to&nbsp; &nbsp; &nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> accounts<span style="color: #66cc66;">&#40;</span>account_name<span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; verified_by&nbsp; &nbsp; &nbsp; &nbsp;VARCHAR<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">100</span><span style="color: #66cc66;">&#41;</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> accounts<span style="color: #66cc66;">&#40;</span>account_name<span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">CREATE</span> <span style="color: #993333; font-weight: bold;">TABLE</span> bugs_products <span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; bug_id&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> bugs,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; product_id&nbsp; &nbsp; &nbsp; &nbsp; INTEGER <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">NULL</span> <span style="color: #993333; font-weight: bold;">REFERENCES</span> products,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <span style="color: #993333; font-weight: bold;">PRIMARY</span> <span style="color: #993333; font-weight: bold;">KEY</span>&nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #66cc66;">&#40;</span>bug_id, product_id<span style="color: #66cc66;">&#41;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            また、&#039;bugs&#039; テーブルには &#039;accounts&#039;
            テーブルを指す外部キー参照が複数含まれることにも注意しましょう。
            それぞれの外部キーは、そのバグに対して
            &#039;accounts&#039; テーブルの別々の行を参照することもあります。
        </p>

        <p class="para">
            サンプルデータベースの物理データモデルは、次の図のようになります。
        </p>

        <p class="para">
            <div class="inlinemediaobject"><div class="imageobject"><img src="images/d481d625821a97b9a5eb2cec99dca50e-zend.db.adapter.example-database.png" alt="zend.db.adapter.example-database.png" width="387" height="302" /></div></div>
        </p>

    </div>

    <div class="section" id="zend.db.adapter.select" name="zend.db.adapter.select"><div class="info"><h1 class="title">クエリ結果の読み込み</h1></div>

        

        <p class="para">
            ここでは、 <acronym class="acronym">SELECT</acronym> クエリを実行してその結果を取得するための
            アダプタのメソッドについて説明します。
        </p>

        <div class="section" id="zend.db.adapter.select.fetchall" name="zend.db.adapter.select.fetchall"><div class="info"><h1 class="title">結果セット全体の取得</h1></div>

            

            <p class="para">
                <acronym class="acronym">SQL</acronym> の <acronym class="acronym">SELECT</acronym> クエリの実行とその結果の取得を一度に行うには
                 <span class="methodname">fetchAll()</span> メソッドを使用します。
            </p>

            <p class="para">
                このメソッドの最初の引数には、 <acronym class="acronym">SELECT</acronym> 文を文字列で指定します。
                あるいは、文字列ではなく
                <a href="zend.db.select.html" class="link">Zend_Db_Select</a>
                クラスのオブジェクトを指定することもできます。
                オブジェクトを渡した場合は、アダプタの内部でそれを自動的に
                <acronym class="acronym">SELECT</acronym> 文の文字列に変換します。
            </p>

            <p class="para">
                 <span class="methodname">fetchAll()</span> でその次に指定する引数は、
                <acronym class="acronym">SQL</acronym> 文中のパラメータプレースホルダを置換する値の配列となります。
            </p>

            <div class="example"><div class="info"><p><b>Example #10 fetchAll() の使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = ?'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchAll</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$sql</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetch-mode" name="zend.db.adapter.select.fetch-mode"><div class="info"><h1 class="title">フェッチモードの変更</h1></div>

            

            <p class="para">
                デフォルトでは、 <span class="methodname">fetchAll()</span>
                は行の配列を返します。各行のデータは連想配列となります。
                連想配列のキーは、列名かあるいは SELECT
                クエリで指定した列の別名となります。
            </p>

            <p class="para">
                返り値の形式を別のものにするには
                 <span class="methodname">setFetchMode()</span> メソッドを使用します。
                対応しているモードは、以下の定数で表されるものです。
            </p>

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis"><b><tt>Zend_Db::FETCH_ASSOC</tt></b></em>:
                        データを、連想配列の配列として返します。
                        配列のキーは、カラム名を文字列で表したものとなります。
                        これは、<span class="classname">Zend_Db_Adapter</span> クラスのデフォルトのフェッチモードです。
                    </p>
                    <p class="para">
                        select で取得する一覧の中に同名のカラムが含まれている場合
                        (たとえば複数テーブルを <acronym class="acronym">JOIN</acronym> した場合など)
                        は、その名前のエントリはひとつしか含まれません。
                        <b><tt>FETCH_ASSOC</tt></b> モードを使用する場合は、
                        <acronym class="acronym">SELECT</acronym> クエリでカラムの別名を指定するなどして、
                        結果の配列におけるキーが一意になるようにしなければなりません。
                    </p>
                    <p class="para">
                        デフォルトでは、これらの文字列はデータベースドライバから返されるものをそのまま使用します。
                        通常は、これは <acronym class="acronym">RDBMS</acronym> サーバでのカラム名となるでしょう。
                        大文字小文字を指定するには、<b><tt>Zend_Db::CASE_FOLDING</tt></b>
                        オプションを使用します。これは、
                        アダプタのインスタンスを作成する際に使用します。
                        <a href="zend.db.adapter.html#zend.db.adapter.connecting.parameters.example1" class="link">この例</a>
                        を参照ください。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_NUM</em>:
                        データを、配列の配列で返します。
                        配列は数値添字形式となり、クエリで指定した順番での位置がキーとなります。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_BOTH</em>:
                        データを、配列の配列で返します。
                        配列のキーは、FETCH_ASSOC モードで用いる文字列と
                        FETCH_NUM モードで用いる数値の両方を含んだものとなります。
                        配列の要素数が、FETCH_ASSOC や FETCH_NUM
                        の場合の倍になることに注意しましょう。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_COLUMN</em>:
                        データを、値の配列で返します。
                        配列の各要素の値は、結果セットのあるひとつのカラムの値となります。
                        デフォルトでは、これは最初の (0 番目の) カラムとなります。
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">Zend_Db::FETCH_OBJ</em>:
                        データを、オブジェクトの配列で返します。
                        デフォルトのクラスは、<acronym class="acronym">PHP</acronym> の組み込みクラス stdClass
                        となります。結果セットのカラムは、このクラスのプロパティとしてアクセスできます。
                    </p>
                </li>
            </ul>

            <div class="example"><div class="info"><p><b>Example #11 setFetchMode() の使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchAll</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = ?'</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// $result はオブジェクトの配列となります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>-&gt;<span style="color: #006600;">bug_description</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetchassoc" name="zend.db.adapter.select.fetchassoc"><div class="info"><h1 class="title">連想配列形式での結果セットの取得</h1></div>

            

            <p class="para">
                 <span class="methodname">fetchAssoc()</span> メソッドは、
                フェッチモードの設定にかかわらず、
                最初のカラムを配列のインデックスとして使って、
                結果のデータを連想配列の配列で返します。
            </p>

            <div class="example"><div class="info"><p><b>Example #12 fetchAssoc() の使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchAssoc</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT bug_id, bug_description, bug_status FROM bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// $result は、フェッチモードの指定とは関係なく連想配列の配列となります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">'bug_description'</span><span style="color: #66cc66;">&#93;</span>; <span style="color: #808080; font-style: italic;">// Description of Bug #2</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">'bug_description'</span><span style="color: #66cc66;">&#93;</span>; <span style="color: #808080; font-style: italic;">// Description of Bug #1</span></div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetchcol" name="zend.db.adapter.select.fetchcol"><div class="info"><h1 class="title">結果セットの単一のカラムの取得</h1></div>

            

            <p class="para">
                 <span class="methodname">fetchCol()</span> メソッドは、
                フェッチモードの設定にかかわらず、
                結果のデータを値の配列で返します。
                これは、クエリの最初のカラムのみを返します。
                それ以外のカラムの内容は破棄されます。
                別のカラムが必要な場合は
                <a href="zend.db.statement.html#zend.db.statement.fetching.fetchcolumn" class="xref">結果セットからの単一のカラムの取得</a>
                を参照ください。
            </p>

            <div class="example"><div class="info"><p><b>Example #13 fetchCol() の使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchCol</span><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'SELECT bug_description, bug_id FROM bugs WHERE bug_id = ?'</span>, <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// bug_description を含み、bug_id は含みません</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.select.fetchpairs" name="zend.db.adapter.select.fetchpairs"><div class="info"><h1 class="title">結果セットからの キー/値 のペアの取得</h1></div>

            

            <p class="para">
                 <span class="methodname">fetchPairs()</span> メソッドは、データを キー/値
                のペア (連想配列) の配列で返します。
                この連想配列のキーは、 <acronym class="acronym">SELECT</acronym> クエリが返す最初のカラムの値となります。
                また、連想配列の値は、 <acronym class="acronym">SELECT</acronym> クエリが返す二番目のカラムの値となります。
                クエリから返されるその他のカラムは破棄されます。
            </p>

            <p class="para">
                <acronym class="acronym">SELECT</acronym> クエリをうまく設計し、最初のカラムの値が一意になるようにしなければなりません。
                もし最初のカラムに重複する値があれば、連想配列のエントリが上書きされてしまいます。
            </p>

            <div class="example"><div class="info"><p><b>Example #14 fetchPairs() の例</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchPairs</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT bug_id, bug_status FROM bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#93;</span>;</div></li></ol></div></div></div>

            </div>
        </div>

        <div class="section" id="zend.db.adapter.select.fetchrow" name="zend.db.adapter.select.fetchrow"><div class="info"><h1 class="title">結果セットからの単一の行の取得</h1></div>

            

            <p class="para">
                 <span class="methodname">fetchRow()</span> メソッドは、
                結果のデータを現在のフェッチモードで返します。
                ただ、返すのは結果セットから取得した最初の行のみです。
            </p>

            <div class="example"><div class="info"><p><b>Example #15 fetchRow() の使用</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">setFetchMode</span><span style="color: #66cc66;">&#40;</span>Zend_Db::<span style="color: #006600;">FETCH_OBJ</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT * FROM bugs WHERE bug_id = 2'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// $result はオブジェクトの配列ではなく、単なるオブジェクトとなります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span>-&gt;<span style="color: #006600;">bug_description</span>;</div></li></ol></div></div></div>

            </div>
        </div>

        <div class="section" id="zend.db.adapter.select.fetchone" name="zend.db.adapter.select.fetchone"><div class="info"><h1 class="title">結果セットからの単一のスカラー値の取得</h1></div>

            

            <p class="para">
                 <span class="methodname">fetchOne()</span> メソッドは
                 <span class="methodname">fetchRow()</span> と  <span class="methodname">fetchCol()</span>
                を組み合わせたようなものです。
                結果セットからの最初の行から、最初のカラムの値のみを返します。
                したがって、このメソッドの返り値は配列やオブジェクトではなく単一のスカラー値となります。
            </p>

            <div class="example"><div class="info"><p><b>Example #16 fetchOne() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">fetchOne</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'SELECT bug_status FROM bugs WHERE bug_id = 2'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// これは単なる文字列となります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$result</span>;</div></li></ol></div></div></div>

            </div>
        </div>

    </div>

    <div class="section" id="zend.db.adapter.write" name="zend.db.adapter.write"><div class="info"><h1 class="title">データベースへの変更の書き出し</h1></div>

        

        <p class="para">
            アダプタクラスを使用して、
            新しいデータをデータベースに書き込んだり
            既存のデータに変更を加えたりできます。
            ここでは、そのためのメソッドについて説明します。
        </p>

        <div class="section" id="zend.db.adapter.write.insert" name="zend.db.adapter.write.insert"><div class="info"><h1 class="title">データの挿入</h1></div>

            

            <p class="para">
                データベースのテーブルに新しい行を追加するには、
                 <span class="methodname">insert()</span> メソッドを使用します。
                最初の引数はテーブル名を表す文字列で、
                その次の引数はカラム名とデータの値を関連付けた連想配列となります。
            </p>

            <div class="example"><div class="info"><p><b>Example #17 テーブルへのデータの挿入</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'created_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-22'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_description'</span> =&gt; <span style="color: #ff0000;">'Something wrong'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'NEW'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                データの配列で指定しなかったカラムについてはデータベースに対して何も指示しません。
                つまり、<acronym class="acronym">SQL</acronym> の <acronym class="acronym">INSERT</acronym> 文で列を指定しなかった場合と同じ挙動となります。
                <acronym class="acronym">DEFAULT</acronym> 句が設定されていればその値が追加され、
                設定されていなければ <b><tt>NULL</tt></b> のままとなります。
            </p>

            <p class="para">
                デフォルトでは、データ配列の値を挿入する際にはパラメータを使用します。
                これにより、ある種のセキュリティ問題が発生する可能性を軽減します。
                データ配列で指定するデータについては、
                エスケープやクォート処理を考慮する必要はありません。
            </p>

            <p class="para">
                データ配列の中の値を <acronym class="acronym">SQL</acronym> の式として扱い、
                クォートしたくない場合もあるかもしれません。
                デフォルトでは、文字列として渡した値はすべて文字列リテラルとして扱われます。
                その値が <acronym class="acronym">SQL</acronym> の式であること、つまりクォートしてはいけないということを指定するには、
                文字列ではなく <span class="classname">Zend_Db_Expr</span> 型のオブジェクトをデータ配列に渡します。
            </p>

            <div class="example"><div class="info"><p><b>Example #18 テーブルへの式の挿入</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'created_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #000000; font-weight: bold;">new</span> Zend_Db_Expr<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'CURDATE()'</span><span style="color: #66cc66;">&#41;</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_description'</span> =&gt; <span style="color: #ff0000;">'Something wrong'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'NEW'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

        </div>

        <div class="section" id="zend.db.adapter.write.lastinsertid" name="zend.db.adapter.write.lastinsertid"><div class="info"><h1 class="title">生成された値の取得</h1></div>

            

            <p class="para">
                <acronym class="acronym">RDBMS</acronym> によっては、主キーの自動インクリメントをサポートしているものもあります。
                この方法で定義したテーブルに新しい行を <acronym class="acronym">INSERT</acronym> すると、
                主キーの値が自動的に生成されます。
                 <span class="methodname">insert()</span> メソッドの返り値は、最後に追加された ID
                では<em class="emphasis">ありません</em>。
                そのテーブルには自動インクリメントのカラムがないかもしれないからです。
                返り値は、変更された行数 (通常は 1 です) となります。
            </p>

            <p class="para">
                そのテーブルで自動インクリメントの主キーを定義している場合は、
                データを追加した後で  <span class="methodname">lastInsertId()</span>
                メソッドを使用できます。このメソッドは、
                現在のデータベース接続において最後に自動生成された値を返します。
            </p>

            <div class="example"><div class="info"><p><b>Example #19 自動インクリメントのキーにおける lastInsertId() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 自動インクリメントのカラムで最後に生成された値を返します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastInsertId</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                <acronym class="acronym">RDBMS</acronym> によっては、シーケンスをサポートしているものもあります。
                シーケンスを使用して、主キー用の一意な値を生成できます。
                シーケンスをサポートするために、 <span class="methodname">lastInsertId()</span>
                ではオプションの文字列引数を 2 つ受け取れるようにしています。
                これらの引数には、それぞれテーブル名とカラム名を指定します。
                シーケンスの名前は、このテーブル名とカラム名をつなげたものの後に
                &quot;_seq&quot; を付加したものとなります。これは、PostgreSQL
                が SERIAL 型のカラムに対して自動生成するシーケンス名の規約にもとづいています。
                たとえば、&quot;bugs&quot; テーブルの主キーカラムが
                &quot;bug_id&quot; である場合は、&quot;bugs_bug_id_seq&quot;
                という名前のシーケンスを使用することになります。
            </p>

            <div class="example"><div class="info"><p><b>Example #20 シーケンスにおける lastInsertId() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// シーケンス 'bugs_bug_id_seq' が最後に生成した値を返します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastInsertId</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #ff0000;">'bug_id'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// これは、シーケンス 'bugs_seq' が最後に生成した値を返します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastInsertId</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                もしこの命名規約とは異なる名前のシーケンスを使用している場合は、代わりに
                 <span class="methodname">lastSequenceId()</span> メソッドを使用します。
                このメソッドの引数には、シーケンスの名前を直接指定します。
            </p>

            <div class="example"><div class="info"><p><b>Example #21 lastSequenceId() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">insert</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// シーケンス 'bugs_id_gen' が最後に生成した値を返します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">lastSequenceId</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs_id_gen'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                シーケンスをサポートしていない <acronym class="acronym">RDBMS</acronym>、たとえば MariaDB や MySQL、
                Microsoft <acronym class="acronym">SQL</acronym> Server、SQLite などの場合、
                 <span class="methodname">lastInsertId()</span> メソッドの引数は無視されます。
                このメソッドの返り値は、現在の接続で最後に実行された
                <acronym class="acronym">INSERT</acronym> 操作が生成した値となります。また、これらの <acronym class="acronym">RDBMS</acronym> では
                 <span class="methodname">lastSequenceId()</span> メソッドの返り値は常に <b><tt>NULL</tt></b>
                となります。
            </p>

            <blockquote><p><b class="note">Note</b>: <span class="info"><b>&quot;SELECT MAX(id) FROM table&quot; じゃあダメなんですか?</b><br /></span>
                
                
                    たしかにこのクエリは、最後にテーブルに追加された主キーの値を返すこともあります。
                    しかしこれは、複数のクライアントがデータベースにレコードを追加するという環境では
                    安全ではありません。
                    つまり、データを追加してから  <span class="methodname">MAX(id)</span> の値を取得するまでの間に
                    他のクライアントが別のデータを追加する可能性があるということです。
                    この場合、クエリが返す結果はあなたが実際に追加した行の ID とは異なり、
                    誰か他の人が追加した行の ID となってしまいます。
                    しかも、もしそのような状況になっていたとしても
                    あなたにはそれを知ることはできません。
                <br />
                
                    たとえば &quot;repeatable read&quot; のようなトランザクション分離モードを使用すれば、
                    この危険性を減らせます。しかし、
                    このレベルのトランザクション分離をサポートしていない <acronym class="acronym">RDBMS</acronym>
                    もあります。また、そのアプリケーション自体がもっと緩いレベルの
                    トランザクション分離モードを想定して作成されているかもしれません。
                <br />
                
                    さらに、新しい主キーの値を生成する際に &quot;MAX(id)+1&quot;
                    のような式を使うのも同様に危険です。ふたつのクライアントから同時にこのクエリを実行すると、
                    どちらも同じ値を取得することになり、同じ値で <acronym class="acronym">INSERT</acronym>
                    を行なうことになってしまいます。
                <br />
                
                    どんな <acronym class="acronym">RDBMS</acronym> でも、一意な値を生成する機能や
                    最後に生成した値を返す機能は持っています。
                    この機能はトランザクション分離レベルとは無関係に機能するはずなので、
                    ふたつのクライアントで同じ値が重複してしまうことはありません。
                    また、他のクライアントで作成した値が
                    あなたの接続で「最後に生成した値」として返されることもありません。
                <br />
            </p></blockquote>

        </div>

        <div class="section" id="zend.db.adapter.write.update" name="zend.db.adapter.write.update"><div class="info"><h1 class="title">データの更新</h1></div>
            

            <p class="para">
                データベースのテーブルの行を更新するには、アダプタの
                 <span class="methodname">update()</span> メソッドを使用します。このメソッドへの引数は
                3 つです。まず最初はテーブルの名前、
                その次はカラム名と新しい値を関連づけた連想配列となります。
            </p>

            <p class="para">
                配列で指定した値は、文字列リテラルとして扱われます。
                データ配列で <acronym class="acronym">SQL</acronym> の式を扱う方法については
                <a href="zend.db.adapter.html#zend.db.adapter.write.insert" class="xref">データの挿入</a>
                を参照ください。
            </p>

            <p class="para">
                三番目の引数は、<acronym class="acronym">SQL</acronym> の式を文字列で指定します。
                これが、変更する行を絞り込むための条件となります。
                ここで指定した値や識別子に対しては、クォートやエスケープは行ないません。
                何らかの動的な値を使用する場合は、その内容が安全であることを確認するようにしましょう。
                <a href="zend.db.adapter.html#zend.db.adapter.quoting" class="xref">値や識別子のクォート</a>
                で説明しているメソッドを使用するといいでしょう。
            </p>

            <p class="para">
                このメソッドの返り値は、更新操作によって変更された行の数となります。
            </p>

            <div class="example"><div class="info"><p><b>Example #22 行の更新</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'updated_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-23'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">update</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span>, <span style="color: #ff0000;">'bug_id = 2'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                三番目の引数を省略した場合は、テーブルのすべての行が指定した値で更新されます。
            </p>

            <p class="para">
                三番目の引数に文字列の配列を指定すると、各要素の内容を
                <b><tt>AND</tt></b> 演算子で連結して使用します。
            </p>

            <p class="para">
                三番目の引数に配列の配列を提示すると、
                値は自動的に引用符で囲まれてキーに入れられます。
                そしてこれらは条件として結合され、
                <b><tt>AND</tt></b> 演算子で区切られます。
            </p>

            <div class="example"><div class="info"><p><b>Example #23 式の配列を指定することによる行の更新</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'updated_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-23'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">&quot;reported_by = 'goofy'&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">&quot;bug_status = 'OPEN'&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">update</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span>, <span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 実行される SQL は、このようになります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; UPDATE &quot;bugs&quot; SET &quot;update_on&quot; = '2007-03-23', &quot;bug_status&quot; = 'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; WHERE (&quot;reported_by&quot; = 'goofy') AND (&quot;bug_status&quot; = 'OPEN')</span></div></li></ol></div></div></div>

            </div>

            <div class="example"><div class="info"><p><b>Example #24 配列の配列を使う行の更新</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$data</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'updated_on'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'2007-03-23'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'bug_status'</span>&nbsp; &nbsp; &nbsp; =&gt; <span style="color: #ff0000;">'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">'reported_by = ?'</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">'goofy'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#91;</span><span style="color: #ff0000;">'bug_status = ?'</span><span style="color: #66cc66;">&#93;</span>&nbsp; = <span style="color: #ff0000;">'OPEN'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">update</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #0000ff;">$data</span>, <span style="color: #0000ff;">$where</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 実行される SQL は、このようになります</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; UPDATE &quot;bugs&quot; SET &quot;update_on&quot; = '2007-03-23', &quot;bug_status&quot; = 'FIXED'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">//&nbsp; WHERE (&quot;reported_by&quot; = 'goofy') AND (&quot;bug_status&quot; = 'OPEN')</span></div></li></ol></div></div></div>

            </div>
        </div>

        <div class="section" id="zend.db.adapter.write.delete" name="zend.db.adapter.write.delete"><div class="info"><h1 class="title">行の削除</h1></div>
            
            <p class="para">
                データベースのテーブルから行を削除するには
                 <span class="methodname">delete()</span> メソッドを使用します。このメソッドに渡す引数は 2 つで、
                最初の引数はテーブル名を表す文字列です。
            </p>

            <p class="para">
                二番目の引数は、<acronym class="acronym">SQL</acronym> の式を文字列で指定します。
                これが、削除する行を絞り込むための条件となります。
                ここで指定した値や識別子に対しては、クォートやエスケープは行ないません。
                何らかの動的な値を使用する場合は、その内容が安全であることを確認するようにしましょう。
                <a href="zend.db.adapter.html#zend.db.adapter.quoting" class="xref">値や識別子のクォート</a>
                で説明しているメソッドを使用するといいでしょう。
            </p>

            <p class="para">
                このメソッドの返り値は、削除操作によって変更された行の数となります。
　            </p>

            <div class="example"><div class="info"><p><b>Example #25 行の削除</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$n</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">delete</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'bugs'</span>, <span style="color: #ff0000;">'bug_id = 3'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                二番目の引数を省略した場合は、テーブルのすべての行を削除します。
            </p>

            <p class="para">
                二番目の引数に文字列の配列を指定すると、各要素の内容を
                <b><tt>AND</tt></b> 演算子で連結して使用します。
            </p>

            <p class="para">
                二番目の引数に配列の配列を提示すると、
                値は自動的に引用符で囲まれてキーに入れられます。
                そしてこれらは条件として結合され、
                <b><tt>AND</tt></b> 演算子で区切られます。
            </p>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.quoting" name="zend.db.adapter.quoting"><div class="info"><h1 class="title">値や識別子のクォート</h1></div>

        

        <p class="para">
            <acronym class="acronym">SQL</acronym> を作成する際には、<acronym class="acronym">PHP</acronym> の変数の値を
            <acronym class="acronym">SQL</acronym> の式で使用しなければならないこともあるでしょう。
            これは危険な処理です。なぜなら、<acronym class="acronym">PHP</acronym> の文字列の中には
            たとえばクォート記号のような特殊文字が含まれていることがあり、
            できあがる <acronym class="acronym">SQL</acronym> がおかしなものになってしまう可能性があるからです。
            たとえば、以下のコードで作成した <acronym class="acronym">SQL</acronym> は、クォート文字の対応がおかしいものになります。
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$name</span> = <span style="color: #ff0000;">&quot;O'Reilly&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE reported_by = '$name'&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 'O'Reilly'</span></div></li></ol></div></div></div>

        </p>

        <p class="para">
            さらに悪いことに、このようなコードを悪用されると
            あなたのアプリケーションが攻撃の被害を受けることになるかもしれません。
            <acronym class="acronym">PHP</acronym> の変数の値を HTTP パラメータなどで指定することができれば、
            <acronym class="acronym">SQL</acronym> クエリを操作して予期せぬことをされてしまう可能性があります
            (たとえば、その人の権限では見えないはずのデータを見られてしまうなど)。
            これは、アプリケーションのセキュリティ問題としては非常に有名な手法で、
            &quot;<acronym class="acronym">SQL</acronym> インジェクション&quot; と呼ばれています
            (<a href="http://ja.wikipedia.org/wiki/SQL%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3" class="link external">&raquo; 
            http://ja.wikipedia.org/wiki/SQL%E3%82%A4%E3%83%B3%E3%82%B8%E3%82%A7%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3</a>
            を参照ください)。
        </p>

        <p class="para">
            <span class="classname">Zend_Db</span> Adapter クラスの提供する便利な関数を使用すると、
            あなたの <acronym class="acronym">PHP</acronym> コードが <acronym class="acronym">SQL</acronym> インジェクション攻撃を受ける危険性を軽減できます。
            この攻撃を回避する方法は、<acronym class="acronym">PHP</acronym> のクォート文字のような特殊文字を
            正しくエスケープしてから <acronym class="acronym">SQL</acronym> に使用することです。
            これにより、不意に (あるいは故意に)
            <acronym class="acronym">SQL</acronym> に特殊文字が埋め込まれてしまうことを防ぎます。
        </p>

        <div class="section" id="zend.db.adapter.quoting.quote" name="zend.db.adapter.quoting.quote"><div class="info"><h1 class="title">quote() の使用法</h1></div>

            

            <p class="para">
                 <span class="methodname">quote()</span> メソッドは、引数として文字列を受け取ります。
                そしてその文字列の中の特殊文字をエスケープした上で、
                両端を区切り文字で囲んだものを返します。
                エスケープ処理は、使用している <acronym class="acronym">RDBMS</acronym>
                にあわせて適切に行われます。
                文字列の両端に使用する区切り文字は、標準の <acronym class="acronym">SQL</acronym>
                ではシングルクォート (&#039;) となります。
            </p>

            <div class="example"><div class="info"><p><b>Example #26 quote() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$name</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quote</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;O'Reilly&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$name</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// 'O\'Reilly'</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE reported_by = $name&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 'O\'Reilly'</span></div></li></ol></div></div></div>

            </div>

            <p class="para">
                 <span class="methodname">quote()</span> の返り値には、文字列の両端に区切り文字が追加されていることに注意しましょう。
                これは、たとえば
                <a href="http://jp.php.net/mysqli_real_escape_string" class="link external">&raquo; mysql_real_escape_string()</a>
                のようなエスケープ用関数の挙動とは異なります。
            </p>

            <p class="para">
                値をクォートするかしないかは、<acronym class="acronym">SQL</acronym> のデータ型によって異なります。
                たとえば、整数値をクォートしてしまうと
                数値型カラムや計算式で利用できなくなってしまうという
                <acronym class="acronym">RDBMS</acronym> もあります。つまり、次のような <acronym class="acronym">SQL</acronym>
                がエラーになってしまう実装があるということです。
                ここで、 <span class="property">intColumn</span> のデータ型は
                <b><tt>INTEGER</tt></b> であるものとします。

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">SELECT * FROM atable WHERE intColumn = <span style="color: #ff0000;">'123'</span></div></li></ol></div></div></div>

            </p>

            <p class="para">
                 <span class="methodname">quote()</span> メソッドでオプションの
                2 番目の引数を使用すると、
                <acronym class="acronym">SQL</acronym> のデータ型に応じてクォートするかどうかを選択できます。
            </p>

            <div class="example"><div class="info"><p><b>Example #27 quote() での SQL データ型の指定</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$value</span> = <span style="color: #ff0000;">'1234'</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">'SELECT * FROM atable WHERE intColumn = '</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp;. <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quote</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$value</span>, <span style="color: #ff0000;">'INTEGER'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            <p class="para">
                各 <span class="classname">Zend_Db_Adapter</span> クラスでは、その <acronym class="acronym">RDBMS</acronym>
                用の <acronym class="acronym">SQL</acronym> 数値データ型の名前がコード化されています。
                それら以外にも
                <b><tt>Zend_Db::INT_TYPE</tt></b> や
                <b><tt>Zend_Db::BIGINT_TYPE</tt></b>、そして
                <b><tt>Zend_Db::FLOAT_TYPE</tt></b>
                といった定数が用意されており、
                これらを使用すると <acronym class="acronym">RDBMS</acronym> に依存しないコードを書くことができます。
            </p>

            <p class="para">
                <span class="classname">Zend_Db_Table</span> は、テーブルのキーとなるカラムを使用する際には
                自動的に <acronym class="acronym">SQL</acronym> データ型を  <span class="methodname">quote()</span> に指定します。
            </p>

        </div>

        <div class="section" id="zend.db.adapter.quoting.quote-into" name="zend.db.adapter.quoting.quote-into"><div class="info"><h1 class="title">quoteInto() の使用法</h1></div>

            

            <p class="para">
                クォートを使用する場面としていちばんよくあるのが、
                <acronym class="acronym">PHP</acronym> の変数の値を <acronym class="acronym">SQL</acronym> の式や文中で使用するということです。
                 <span class="methodname">quoteInto()</span> メソッドを使用すると、この処理を一度でできるようになります。
                このメソッドが受け取る引数はふたつです。
                まず最初の引数としてプレースホルダ記号 (?)
                を含む文字列を指定し、次の引数で <acronym class="acronym">PHP</acronym> の変数などの値を指定します。
                ここで指定した値で、プレースホルダの部分を置き換えます。
            </p>

            <p class="para">
                プレースホルダ用の記号は、多くの <acronym class="acronym">RDBMS</acronym>
                でパラメータとして使用している記号と同じです。しかし、
                 <span class="methodname">quoteInto()</span> メソッドはあくまでパラメータをエミュレートしているだけです。
                このメソッドは単純に文字列の中に値を放り込み、
                特殊文字をエスケープして両端をクォートするという処理だけを行います。
                <acronym class="acronym">RDBMS</acronym> におけるパラメータのように、
                <acronym class="acronym">SQL</acronym> 文字列と値を分離して <acronym class="acronym">SQL</acronym> だけを事前に <acronym class="acronym">RDBMS</acronym>
                サーバでパースするといったことは行いません。
            </p>

            <div class="example"><div class="info"><p><b>Example #28 quoteInto() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quoteInto</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE reported_by = ?&quot;</span>, <span style="color: #ff0000;">&quot;O'Reilly&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 'O\'Reilly'</span></div></li></ol></div></div></div>

            </div>

            <p class="para">
                 <span class="methodname">quoteInto()</span> のオプションの
                3 番目のパラメータを使用すると、<acronym class="acronym">SQL</acronym> のデータ型を指定できます。
                数値型はクォートをせず、それ以外の型についてはクォートを行います。
            </p>

            <div class="example"><div class="info"><p><b>Example #29 quoteInto() での SQL データ型の指定</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #0000ff;">$db</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; -&gt;<span style="color: #006600;">quoteInto</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;SELECT * FROM bugs WHERE bug_id = ?&quot;</span>, <span style="color: #ff0000;">'1234'</span>, <span style="color: #ff0000;">'INTEGER'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM bugs WHERE reported_by = 1234</span></div></li></ol></div></div></div>

            </div>

        </div>
        <div class="section" id="zend.db.adapter.quoting.quote-identifier" name="zend.db.adapter.quoting.quote-identifier"><div class="info"><h1 class="title">quoteIdentifier() の使用法</h1></div>

            

            <p class="para">
                変数を使用する可能性があるのは、<acronym class="acronym">SQL</acronym> 文中の値だけとは限りません。
                <acronym class="acronym">SQL</acronym> 文中でのテーブル名やカラム名などの識別子として
                <acronym class="acronym">PHP</acronym> の変数を使用する場合も、同様にクォートする必要があります。
                デフォルトでは、<acronym class="acronym">SQL</acronym> の識別子に使用できる文字は
                <acronym class="acronym">PHP</acronym> などのプログラミング言語の規則と似ています。
                たとえば、識別子には空白文字や記号を使用することはできませんし、
                またアルファベット以外の文字も使えません。
                <acronym class="acronym">SQL</acronym> の文法上特別な意味を持つ単語として予約されているものも、
                そのままでは識別子として使用できません。
            </p>

            <p class="para">
                しかし、適切な区切り文字でクォートすれば、
                識別子として使用できる文字の幅が広がります。
                本来識別子として使用できない文字を含んでいても、
                適切な形式でクォートすることで <acronym class="acronym">SQL</acronym> の識別子として使用できるようになります。
                たとえば、空白や記号などを使うこともできますし、
                <acronym class="acronym">SQL</acronym> で予約語として指定されている単語であっても使用可能です。
            </p>

            <p class="para">
                 <span class="methodname">quoteIdentifier()</span> メソッドの働きは
                 <span class="methodname">quote()</span> と似ていますが、
                このメソッドは使用しているアダプタの型に応じた識別子区切り文字を付加します。
                たとえば、標準 <acronym class="acronym">SQL</acronym> ではダブルクォート
                (&quot;) を区切り文字として使用します。
                多くの <acronym class="acronym">RDBMS</acronym> がこれにしたがっています。
                MySQL の場合は、デフォルトではバッククォート
                (`) を使用します。
                 <span class="methodname">quoteIdentifier()</span> メソッドはまた、
                文字列引数内の特殊文字のエスケープも行います。
            </p>

            <div class="example"><div class="info"><p><b>Example #30 quoteIdentifier() の使用法</b></p></div>
                
                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// テーブル名に、SQL の予約語を使用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$tableName</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">quoteIdentifier</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;order&quot;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$sql</span> = <span style="color: #ff0000;">&quot;SELECT * FROM $tableName&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$sql</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// SELECT * FROM &quot;order&quot;</span></div></li></ol></div></div></div>

            </div>

            <p class="para">
                クォートしていない場合とは異なり、
                クォートした識別子は大文字小文字を区別するようになります。
                したがって、クォートした識別子を使用する場合は
                大文字小文字の指定も含めて識別子をきちんと記述する必要があります。
            </p>

            <p class="para">
                たいていの場合は <span class="classname">Zend_Db</span> クラスで自動的に <acronym class="acronym">SQL</acronym>
                を生成することになるでしょう。デフォルトでは、
                すべての識別子が自動的にクォートされます。
                この挙動を変更するには、オプション
                <b><tt>Zend_Db::AUTO_QUOTE_IDENTIFIERS</tt></b>
                を変更します。これは、アダプタのインスタンスを作成する際に指定します。
                <a href="zend.db.adapter.html#zend.db.adapter.connecting.parameters.example2" class="xref">ファクトリでの自動クォートオプションの指定</a>
                を参照ください。
            </p>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.transactions" name="zend.db.adapter.transactions"><div class="info"><h1 class="title">データベースのトランザクションの制御</h1></div>

        

        <p class="para">
            データベースには「トランザクション」と呼ばれる論理的な作業単位があります。
            複数のテーブルにまたがる操作などを一括して更新 (コミット) したり、
            一括して取消 (ロールバック) したりできるようになります。
            データベースドライバがトランザクションを暗黙的にサポートしている場合は、
            すべてのクエリがトランザクション内で実行されます。
            これを<em class="emphasis">自動コミット</em>モードといいます。
            このモードでは、あらゆるクエリを実行する前に
            ドライバが自動的にトランザクションを開始し、
            実行が完了したら自動的にトランザクションをコミットします。
            デフォルトでは、すべての <span class="classname">Zend_Db</span>
            アダプタクラスは自動コミットモードで動作します。
        </p>

        <p class="para">
            一方、トランザクションの始点と終点を自分で指定することにより、
            複数の <acronym class="acronym">SQL</acronym> クエリをひとつのトランザクション内ですることもできます。
            トランザクションを開始する際には  <span class="methodname">beginTransaction()</span>
            メソッドを使用します。それ以降に実行した <acronym class="acronym">SQL</acronym>
            文は、明示的に指定するまではすべて同じトランザクション内で動作します。
        </p>

        <p class="para">
            トランザクションを終了するには、 <span class="methodname">commit()</span>
            あるいは  <span class="methodname">rollBack()</span> のいずれかを使用します。
             <span class="methodname">commit()</span> メソッドは、
            そのトランザクションでの変更内容をコミットします。
            つまり、そのトランザクションで行った変更が、
            他のトランザクションからも見えるようにするということです。
        </p>

        <p class="para">
             <span class="methodname">rollBack()</span> メソッドはその反対の動作をします。
            このメソッドは、そのトランザクションでの変更内容をすべて破棄します。
            変更は一切なかったことになり、トランザクションを開始する前の状態にデータを戻します。
            しかし、あるトランザクションをロールバックしたとしても、
            その間に他のトランザクションで行った変更には何の影響も与えません。
        </p>

        <p class="para">
            トランザクションを終了すると、<span class="classname">Zend_Db_Adapter</span>
            は再び自動コミットモードに戻ります。
            手動でのトランザクション管理を使用したい場合は、
             <span class="methodname">beginTransaction()</span> をもう一度コールします。
        </p>

        <div class="example"><div class="info"><p><b>Example #31 一貫性を保持するためのトランザクション管理</b></p></div>
            
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// トランザクションを明示的に開始します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">beginTransaction</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">try <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// いくつかクエリを実行します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">query</span><span style="color: #66cc66;">&#40;</span>...<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">query</span><span style="color: #66cc66;">&#40;</span>...<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">query</span><span style="color: #66cc66;">&#40;</span>...<span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// すべて成功したら、トランザクションをコミットして</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// すべての変更を一度に適用します</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">commit</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> catch <span style="color: #66cc66;">&#40;</span>Exception <span style="color: #0000ff;">$e</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// いずれかのクエリが失敗して例外が発生したら、</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// もし他に成功しているクエリがあったとしても</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// それも含めてすべての処理をロールバックします。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// すべて適用されるか、ひとつも適用されないかのいずれかです。</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">rollBack</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$e</span>-&gt;<span style="color: #006600;">getMessage</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

    </div>

    <div class="section" id="zend.db.adapter.list-describe" name="zend.db.adapter.list-describe"><div class="info"><h1 class="title">テーブルの情報の取得</h1></div>

        

        <p class="para">
             <span class="methodname">listTables()</span> メソッドは文字列の配列を返します。
            この配列には、データベース内のすべてのテーブルの名前が格納されています。
        </p>

        <p class="para">
             <span class="methodname">describeTable()</span> メソッドは、
            テーブルのメタデータを格納した連想配列を返します。
            このメソッドの最初の引数に、テーブル名を文字列で指定します。
            二番目の引数はオプションで、そのテーブルが存在するスキーマの名前を指定します。
        </p>

        <p class="para">
            連想配列のキーは、テーブルのカラムの名前となります。
            各キーに関連付けられた値も連想配列で、以下のキーが存在します。
        </p>

        <table class="doctable table"><div class="info"><caption><b>describeTable() が返す連想配列のフィールド</b></caption></div>
            
            
                <thead valign="middle">
                    <tr valign="middle">
                        <th>キー</th>
                        <th>型</th>
                        <th>説明</th>
                    </tr>

                </thead>

                <tbody valign="middle" class="tbody">
                    <tr valign="middle">
                        <td align="left"><b><tt>SCHEMA_NAME</tt></b></td>
                        <td align="left">(string)</td>
                        <td align="left">このテーブルが属するデータベーススキーマの名前。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>TABLE_NAME</tt></b></td>
                        <td align="left">(string)</td>
                        <td align="left">このカラムが属するテーブルの名前。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>COLUMN_NAME</tt></b></td>
                        <td align="left">(string)</td>
                        <td align="left">カラム名。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>COLUMN_POSITION</tt></b></td>
                        <td align="left">(integer)</td>
                        <td align="left">テーブル内でのそのカラムの位置。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>DATA_TYPE</tt></b></td>
                        <td align="left">(string)</td>
                        <td align="left">RDBMS で定義されている、そのカラムのデータ型。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>DEFAULT</tt></b></td>
                        <td align="left">(string)</td>
                        <td align="left">もし存在すれば、そのカラムのデフォルト値。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>NULLABLE</tt></b></td>
                        <td align="left">(boolean)</td>
                        <td align="left">そのカラムが <acronym class="acronym">SQL</acronym> の <b><tt>NULL</tt></b> を許可している場合は <b><tt>TRUE</tt></b> 、
                        <b><tt>NOT</tt></b> <b><tt>NULL</tt></b> 制約が指定されている場合は <b><tt>FALSE</tt></b>。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>LENGTH</tt></b></td>
                        <td align="left">(integer)</td>
                        <td align="left"><acronym class="acronym">RDBMS</acronym> で定義されている、そのカラムの長さ (サイズ)。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>SCALE</tt></b></td>
                        <td align="left">(integer)</td>
                        <td align="left"><acronym class="acronym">SQL</acronym> の NUMERIC 型あるいは <b><tt>DECIMAL</tt></b> 型での桁数。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>PRECISION</tt></b></td>
                        <td align="left">(integer)</td>
                        <td align="left"><acronym class="acronym">SQL</acronym> の NUMERIC 型あるいは <b><tt>DECIMAL</tt></b> 型での精度。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>UNSIGNED</tt></b></td>
                        <td align="left">(boolean)</td>
                        <td align="left">整数系の型で、符号なし (<b><tt>UNSIGNED</tt></b>) である場合に <b><tt>TRUE</tt></b>。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>PRIMARY</tt></b></td>
                        <td align="left">(boolean)</td>
                        <td align="left">そのカラムが主キーの一部である場合に <b><tt>TRUE</tt></b>。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>PRIMARY_POSITION</tt></b></td>
                        <td align="left">(integer)</td>
                        <td align="left">主キーカラムの中での順序 (最初は 1)。</td>
                    </tr>

                    <tr valign="middle">
                        <td align="left"><b><tt>IDENTITY</tt></b></td>
                        <td align="left">(boolean)</td>
                        <td align="left">そのカラムが自動生成の値を使用している場合に <b><tt>TRUE</tt></b>。</td>
                    </tr>

                </tbody>
            
        </table>


        <blockquote><p><b class="note">Note</b>: <span class="info"><b>各 RDBMS における IDENTITY メタデータフィールドの対応</b><br /></span>
            
            
                IDENTITY メタデータフィールドの名前は、サロゲートキーを表す
                &#039;慣用的な&#039; 名前として選択されたものです。
                このフィールドは、それぞれの <acronym class="acronym">RDBMS</acronym> においては以下のような名前で知られています。
            <br />
            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <b><tt>IDENTITY</tt></b> - DB2, MSSQL
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <b><tt>AUTO_INCREMENT</tt></b> - MySQL/MariaDB
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <b><tt>SERIAL</tt></b> - PostgreSQL
                    </p>
                </li>
                <li class="listitem">
                    <p class="para">
                        <b><tt>SEQUENCE</tt></b> - Oracle
                    </p>
                </li>
            </ul>
        </p></blockquote>

        <p class="para">
            指定したテーブル名とスキーマ名に対応するテーブルが存在しない場合は、
             <span class="methodname">describeTable()</span> は空の配列を返します。
        </p>

    </div>

    <div class="section" id="zend.db.adapter.closing" name="zend.db.adapter.closing"><div class="info"><h1 class="title">接続の終了</h1></div>

        

        <p class="para">
            通常は、データベースとの接続を閉じる必要はありません。
            リクエストの処理が終了した時点で、<acronym class="acronym">PHP</acronym>
            が自動的にリソースの後始末を行うからです。
            データベース関連の拡張モジュールは、
            リソースオブジェクトへの参照がなくなった時点で接続を閉じるように設計されています。
        </p>

        <p class="para">
            しかし、実行時間が長くかかり、
            多くのデータベース接続を扱うような <acronym class="acronym">PHP</acronym>
            スクリプトの場合は、自分で接続を閉じる必要があるかもしれません。
            これにより、<acronym class="acronym">RDBMS</acronym> サーバが限界に達してしまうことを防ぎます。
            データベース接続を明示的に閉じるには、アダプタの
             <span class="methodname">closeConnection()</span> メソッドを使用します。
        </p>

        <p class="para">
            リリース 1.7.2 以降では、現在 <acronym class="acronym">RDBMS</acronym> に接続しているかどうかを
             <span class="methodname">isConnected()</span> メソッドで取得できます。
            これは、コネクションリソースが初期化されたまままだ閉じられていないことを確認します。
            現在のところ、たとえばサーバ側で接続が切断された場合などは検出することができません。
            内部的に、接続を閉じる際にこれを使用しています。
            接続を複数回閉じてもエラーにはなりません。
            1.7.2 より前でも <acronym class="acronym">PDO</acronym> アダプタは同じ挙動でしたが、それ以外のアダプタは違いました。
        </p>

        <div class="example"><div class="info"><p><b>Example #32 データベースとの接続の解除</b></p></div>
            
            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">closeConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <blockquote><p><b class="note">Note</b>: <span class="info"><b>Zend_Db は持続的な接続をサポートしていますか？</b><br /></span>
            
            
                はい。<span class="classname">Zend_Db</span> のアダプタの設定
                (driver_configuration ではありません) で、
                <span class="property">persistent</span> フラグを <b><tt>TRUE</tt></b> に設定することで対応します。
            <br />

            <div class="example"><div class="info"><p><b>Example #33 Oracle アダプタでの持続的接続の使用</b></p></div>
                

                <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$db</span> = Zend_Db::<span style="color: #006600;">factory</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'Oracle'</span>, <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">&#40;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'host'</span>&nbsp; &nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'127.0.0.1'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'username'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'webuser'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'password'</span>&nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'xxxxxxxx'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'dbname'</span>&nbsp; &nbsp; &nbsp;=&gt; <span style="color: #ff0000;">'test'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #ff0000;">'persistent'</span> =&gt; <span style="color: #000000; font-weight: bold;">true</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

            </div>

            
                持続的な接続を使用すると、<acronym class="acronym">RDBMS</acronym> サーバに余計な接続がたまってしまうことに注意しましょう。
                接続作成時のオーバーヘッドが減ることによるパフォーマンスの向上よりも、
                それによって引き起こされる問題のほうが多くなりえます。
            <br />

            
                データベース接続は、その状態を管理しています。
                つまり、<acronym class="acronym">RDBMS</acronym> サーバのオブジェクトの中には
                セッションスコープで存在するものがあるということです。
                セッションスコープで管理される情報の例としては、
                ロックやユーザ変数、一時テーブル、直近に実行したクエリの情報
                (変更された行数、自動生成された ID) などが挙げられます。
                持続的な接続を使用すると、
                別の <acronym class="acronym">PHP</acronym> リクエストが作成したデータに
                誤ってアクセスしてしまう危険が生じてしまいます。
            <br />

            
                現在、<span class="classname">Zend_Db</span> が持続的接続をサポートしているのは
                Oracle、DB2 そして <acronym class="acronym">PDO</acronym> アダプタ
                (<acronym class="acronym">PHP</acronym> が指定します) のみです。
            <br />
        </p></blockquote>

    </div>

    <div class="section" id="zend.db.adapter.other-statements" name="zend.db.adapter.other-statements"><div class="info"><h1 class="title">その他のステートメントの実行</h1></div>

        

        <p class="para">
            <acronym class="acronym">PHP</acronym> のデータベース関連拡張モジュールが提供する接続オブジェクトを、
            直接操作したくなることがあるかもしれません。
            <span class="classname">Zend_Db_Adapter_Abstract</span> が対応していないような
            そのデータベース固有の機能を使用したい場合などです。
        </p>

        <p class="para">
            <span class="classname">Zend_Db</span> で <acronym class="acronym">SQL</acronym> 文を実行する場合は、
            常にプリペア/実行の二段階に分けて処理されます。
            しかし、データベースの機能の中には
            プリペアドステートメントに対応していないようなものもあります。
            たとえば、CREATE や ALTER のような DDL は、
            MySQL ではプリペアドステートメントとすることができません。
            また、MySQL 5.1.17 より前のバージョンでは
            <a href="http://dev.mysql.com/doc/refman/5.1/en/query-cache-how.html" class="link external">&raquo; MySQL
            クエリキャッシュ</a>
            の機能を活用することができません。
        </p>

        <p class="para">
            たいていの拡張モジュールには、
            プリペアドステートメントではなく直接 <acronym class="acronym">SQL</acronym>
            を実行するためのメソッドが用意されています。
            たとえば <acronym class="acronym">PDO</acronym> なら  <span class="methodname">exec()</span> がそれにあたります。
            接続オブジェクトに直接アクセスするには、
             <span class="methodname">getConnection()</span> を使用します。
        </p>

        <div class="example"><div class="info"><p><b>Example #34 PDO アダプタによる、プリペアド形式ではないクエリの実行</b></p></div>
            

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$result</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getConnection</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">exec</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'DROP TABLE bugs'</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <p class="para">
            同様にして、
            拡張モジュールが提供するその他のメソッドやプロパティにも
            アクセスできます。ただ、注意が必要です。
            このようなことをすると、あなたの作成したアプリケーションが特定の
            <acronym class="acronym">RDBMS</acronym> 用の拡張モジュールに依存してしまうようになります。
        </p>

        <p class="para">
            将来のバージョンの <span class="classname">Zend_Db</span> では、
            データベースの拡張モジュールがサポートする機能への
            メソッドエントリポイントを追加できるようにする予定です。
            これは、過去のバージョンとの互換性を損なうことはありません。
        </p>

    </div>

    <div class="section" id="zend.db.adapter.server-version" name="zend.db.adapter.server-version"><div class="info"><h1 class="title">サーバのバージョンの取得</h1></div>
        

        <p class="para">
            リリース 1.7.2 以降では、サーバのバージョンを取得できます。これは、
            <acronym class="acronym">PHP</acronym> の  <span class="methodname">version_compare()</span> で使用できる形式となります。
            情報が取得できない場合は <b><tt>NULL</tt></b> が返されます。
        </p>

        <div class="example"><div class="info"><p><b>Example #35 サーバのバージョンを取得してからクエリを実行する</b></p></div>
            

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$version</span> = <span style="color: #0000ff;">$db</span>-&gt;<span style="color: #006600;">getServerVersion</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>!<a href="http://www.php.net/is_null"><span style="color: #000066;">is_null</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$version</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><a href="http://www.php.net/version_compare"><span style="color: #000066;">version_compare</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$version</span>, <span style="color: #ff0000;">'5.0.0'</span>, <span style="color: #ff0000;">'&gt;='</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何かを行います</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// 何か別のことを行います</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// サーバのバージョンを取得できませんでした</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>
    </div>

    <div class="section" id="zend.db.adapter.adapter-notes" name="zend.db.adapter.adapter-notes"><div class="info"><h1 class="title">各アダプタ固有の注意点</h1></div>

        

        <p class="para">
            ここでは、使用するアダプタごとに
            注意すべき点をまとめます。
        </p>

        <div class="section" id="zend.db.adapter.adapter-notes.ibm-db2" name="zend.db.adapter.adapter-notes.ibm-db2"><div class="info"><h1 class="title">IBM DB2</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、名前を
                        &#039;Db2&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の ibm_db2 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <acronym class="acronym">IBM</acronym> <acronym class="acronym">DB2</acronym> は、シーケンスも自動インクリメントのキーも
                        両方サポートしています。
                        したがって、 <span class="methodname">lastInsertId()</span>
                        への引数は指定してもしなくてもかまいません。引数を省略した場合は、
                        自動インクリメントのキーが最後に生成した値を返します。
                        引数を指定した場合は、
                        &#039;<em class="emphasis">テーブル名</em>_<em class="emphasis">カラム名</em>_seq&#039;
                        という名前のシーケンスが最後に生成した値を返します。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.mysqli" name="zend.db.adapter.adapter-notes.mysqli"><div class="info"><h1 class="title">MySQLi</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;Mysqli&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の mysqli 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        MySQL 及び MariaDB はシーケンスをサポートしていません。したがって、
                         <span class="methodname">lastInsertId()</span> に引数を指定してもそれは無視されます。
                        返り値は、常に自動インクリメントのキーの最後の値となります。
                         <span class="methodname">lastSequenceId()</span> メソッドの返り値は
                        <b><tt>NULL</tt></b> となります。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.oracle" name="zend.db.adapter.adapter-notes.oracle"><div class="info"><h1 class="title">Oracle</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;Oracle&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の oci8 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Oracle は自動インクリメントのキーをサポートしていません。
                        したがって、 <span class="methodname">lastInsertId()</span> や
                         <span class="methodname">lastSequenceId()</span>
                        にはシーケンス名を指定する必要があります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Oracle 拡張モジュールは位置指定によるパラメータをサポートしていません。
                        名前つきパラメータを使用する必要があります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        現在、Oracle アダプタでは <b><tt>Zend_Db::CASE_FOLDING</tt></b>
                        オプションをサポートしていません。Oracle
                        でこの機能を使用したい場合は、<acronym class="acronym">PDO</acronym> OCI
                        アダプタを使用する必要があります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        デフォルトでは、LOB フィールドは OCI-Lob オブジェクトで返されます。
                        すべてのリクエストでこれを文字列として取得したい場合は、
                        ドライバのオプション &#039;<span class="property">lob_as_string</span>&#039; を使用します。
                        特定のリクエストでだけそうしたい場合は、アダプタあるいはステートメントで
                         <span class="methodname">setLobAsString(boolean)</span> を使用します。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.sqlsrv" name="zend.db.adapter.adapter-notes.sqlsrv"><div class="info"><h1 class="title">Microsoft SQL Server</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;Sqlsrv&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の sqlsrv 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Microsoft <acronym class="acronym">SQL</acronym> Server 2005 以降のみサポートされます。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Microsoft <acronym class="acronym">SQL</acronym> Server はシーケンスをサポートしていません。
                        したがって、 <span class="methodname">lastInsertId()</span> に指定した主キー引数は無視されます。
                        テーブル名を指定した場合は自動インクリメントキーで最後に生成した値を返し、
                        そうでない場合は最後に実行した挿入クエリが返した ID を返します。
                         <span class="methodname">lastSequenceId()</span> メソッドの返り値は
                        <b><tt>NULL</tt></b> となります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <span class="classname">Zend_Db_Adapter_Sqlsrv</span> は、
                        <acronym class="acronym">SQL</acronym> Server データベースに接続した直後に
                        <b><tt>QUOTED_IDENTIFIER ON</tt></b> を設定します。
                        これは、ドライバで使用する識別子区切り文字を、標準
                        <acronym class="acronym">SQL</acronym> 形式 (<em class="emphasis">&quot;</em>)
                        に設定するものです。<acronym class="acronym">SQL</acronym> Server
                        は独自形式の角括弧構文を使用していますが、
                        それは使わないようになります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        オプション配列のキーに <span class="property">driver_options</span>
                        を指定できます。この値は <a href="http://msdn.microsoft.com/ja-jp/library/cc296161(SQL.90).aspx" class="link external">&raquo; http://msdn.microsoft.com/ja-jp/library/cc296161(SQL.90).aspx</a>
                        に書かれているものとなります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                         <span class="methodname">setTransactionIsolationLevel()</span>
                        で、現在の接続の分離レベルを設定できます。値は
                        <b><tt>SQLSRV_TXN_READ_UNCOMMITTED</tt></b>、
                        <b><tt>SQLSRV_TXN_READ_COMMITTED</tt></b>、
                        <b><tt>SQLSRV_TXN_REPEATABLE_READ</tt></b>、
                        <b><tt>SQLSRV_TXN_SNAPSHOT</tt></b> あるいは
                        <b><tt>SQLSRV_TXN_SERIALIZABLE</tt></b> のいずれかとなります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Zend Framework 1.9 以降は、Microsoft の
                        <acronym class="acronym">PHP</acronym> <acronym class="acronym">SQL</acronym> Server 拡張モジュール
                        1.0.1924.0 以降と <acronym class="acronym">MSSQL</acronym> Server Native
                        Client バージョン 9.00.3042.00 以降をサポートします。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-ibm" name="zend.db.adapter.adapter-notes.pdo-ibm"><div class="info"><h1 class="title">PDO for IBM DB2 and Informix Dynamic Server (IDS)</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;<span class="classname">Pdo_Ibm</span>&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の pdo および pdo_ibm 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        PDO_IBM 拡張モジュールのバージョン 1.2.2 以降が必要です。
                        これより古いバージョンを使っている場合は、PDO_IBM
                        拡張モジュールを <acronym class="acronym">PECL</acronym> で更新する必要があります。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-mssql" name="zend.db.adapter.adapter-notes.pdo-mssql"><div class="info"><h1 class="title">PDO Microsoft SQL Server</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;<span class="classname">Pdo_Mssql</span>&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の pdo および pdo_dblib 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Microsoft <acronym class="acronym">SQL</acronym> Server はシーケンスをサポートしていません。
                        したがって、
                         <span class="methodname">lastInsertId()</span> に引数を指定してもそれは無視されます。
                        返り値は、常に自動インクリメントのキーの最後の値となります。
                         <span class="methodname">lastSequenceId()</span> メソッドの返り値は
                        <b><tt>NULL</tt></b> となります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        unicode 文字列を UCS-2 以外のエンコーディング (UTF-8 など)
                        で使用する場合は、アプリケーションのコード内での変換処理
                        あるいはバイナリカラムへのデータ格納が必要となります。
                        詳細な情報は
                        <a href="http://support.microsoft.com/kb/232580" class="link external">&raquo; Microsoft&#039;s Knowledge Base</a>
                        を参照ください。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <span class="classname">Zend_Db_Adapter_Pdo_Mssql</span> は、SQL Server
                        に接続した直後に <b><tt>QUOTED_IDENTIFIER ON</tt></b>
                        を設定します。これにより、<acronym class="acronym">SQL</acronym> の識別子をクォートする際に
                        標準の区切り文字 (&quot;) を使用するようになります。
                        <acronym class="acronym">SQL</acronym> Server の独自仕様である角括弧によるクォートは使用しません。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        オプションの配列で、キーとして <span class="property">pdoType</span>
                        を指定できます。この値は &quot;mssql&quot; (デフォルト)、
                        &quot;dblib&quot;、&quot;freetds&quot; あるいは &quot;sybase&quot; のいずれかとなります。
                        このオプションは、 <acronym class="acronym">DSN</acronym> 文字列を作成する際に使用する
                        <acronym class="acronym">DSN</acronym> プレフィックスに影響を与えます。&quot;freetds&quot; および
                        &quot;sybase&quot; を指定した場合のプレフィックスは
                        &quot;sybase:&quot; となります。これは
                        <a href="http://www.freetds.org/" class="link external">&raquo; FreeTDS</a>
                        系のライブラリで用いられるものです。
                        このドライバで使用できる <acronym class="acronym">DSN</acronym> プレフィックスの詳細は
                        <a href="http://jp.php.net/manual/ja/ref.pdo-dblib.connection.php" class="link external">&raquo; 
                        http://jp.php.net/manual/ja/ref.pdo-dblib.connection.php</a>
                        を参照ください。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-mysql" name="zend.db.adapter.adapter-notes.pdo-mysql"><div class="info"><h1 class="title">PDO MySQL</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;<span class="classname">Pdo_Mysql</span>&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の pdo および pdo_mysql 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        MySQL 及び MariaDB はシーケンスをサポートしていません。したがって、
                         <span class="methodname">lastInsertId()</span> に引数を指定してもそれは無視されます。
                        返り値は、常に自動インクリメントのキーの最後の値となります。
                         <span class="methodname">lastSequenceId()</span> メソッドの返り値は
                        <b><tt>NULL</tt></b> となります。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-oci" name="zend.db.adapter.adapter-notes.pdo-oci"><div class="info"><h1 class="title">PDO Oracle</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;<span class="classname">Pdo_Oci</span>&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の pdo および pdo_oci 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Oracle は自動インクリメントのキーをサポートしていません。
                        したがって、 <span class="methodname">lastInsertId()</span> や
                         <span class="methodname">lastSequenceId()</span>
                        にはシーケンス名を指定する必要があります。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-pgsql" name="zend.db.adapter.adapter-notes.pdo-pgsql"><div class="info"><h1 class="title">PDO PostgreSQL</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;<span class="classname">Pdo_Pgsql</span>&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の pdo および pdo_pgsql 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        PostgreSQL は、シーケンスも自動インクリメントのキーも
                        両方サポートしています。
                        したがって、 <span class="methodname">lastInsertId()</span>
                        への引数は指定してもしなくてもかまいません。引数を省略した場合は、
                        自動インクリメントのキーが最後に生成した値を返します。
                        引数を指定した場合は、
                        &#039;<em class="emphasis">テーブル名</em>_<em class="emphasis">カラム名</em>_seq&#039;
                        という名前のシーケンスが最後に生成した値を返します。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.pdo-sqlite" name="zend.db.adapter.adapter-notes.pdo-sqlite"><div class="info"><h1 class="title">PDO SQLite</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタを  <span class="methodname">factory()</span> で指定する場合は、
                        名前を &#039;<span class="classname">Pdo_Sqlite</span>&#039; とします。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の pdo および pdo_sqlite 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        SQLite はシーケンスをサポートしていません。したがって、
                         <span class="methodname">lastInsertId()</span> に引数を指定してもそれは無視されます。
                        返り値は、常に自動インクリメントのキーの最後の値となります。
                         <span class="methodname">lastSequenceId()</span> メソッドの返り値は
                        <b><tt>NULL</tt></b> となります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        SQLite2 データベースに接続するには、
                        <span class="classname">Pdo_Sqlite</span> アダプタのインスタンスを作成する際に
                        パラメータの配列で
                        <strong class="command">&#039;sqlite2&#039; =&gt; true</strong> を指定します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        メモリ上の SQLite データベースに接続するには、
                        <span class="classname">Pdo_Sqlite</span> アダプタのインスタンスを作成する際に
                        パラメータの配列で
                        <strong class="command">&#039;dbname&#039; =&gt; &#039;:memory:&#039;</strong> を指定します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <acronym class="acronym">PHP</acronym> 用の SQLite ドライバの古いバージョンでは、
                        結果セットで短いカラム名を使用するための
                        PRAGMA コマンドがサポートされていないようです。
                        join クエリを実行した際の結果セットのカラム名が
                        &quot;テーブル名.カラム名&quot; 形式になる場合は、
                        <acronym class="acronym">PHP</acronym> のバージョンをアップグレードする必要があります。
                    </p>
                </li>
            </ul>
        </div>

        <div class="section" id="zend.db.adapter.adapter-notes.firebird" name="zend.db.adapter.adapter-notes.firebird"><div class="info"><h1 class="title">Firebird/Interbase</h1></div>
            

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        このアダプタは、<acronym class="acronym">PHP</acronym> の php_interbase 拡張モジュールを使用します。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Firebird (interbase) は自動インクリメントのキーをサポートしていません。
                        シーケンスの名前を
                         <span class="methodname">lastInsertId()</span> あるいは
                         <span class="methodname">lastSequenceId()</span> に指定する必要があります。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        現在、Firebird (interbase) アダプタでは <b><tt>Zend_Db::CASE_FOLDING</tt></b>
                        オプションをサポートしていません。
                        クォートしていない識別子は、自動的に大文字で返されます。
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        アダプタ名は <span class="classname">ZendX_Db_Adapter_Firebird</span> です。
                    </p>

                    <p class="para">
                        パラメータ adapterNamespace の値を <span class="classname">ZendX_Db_Adapter</span> とすることを覚えておきましょう。
                    </p>

                    <p class="para">
                        <acronym class="acronym">PHP</acronym> にバンドルされている <var class="filename">gds32.dll</var> (あるいは linux 環境でそれに相当するもの) をアップデートし、
                        サーバと同じバージョンにしておくことを推奨します。
                        Firebird で <var class="filename">gds32.dll</var> に相当するものは <var class="filename">fbclient.dll</var> です。
                    </p>

                    <p class="para">
                        デフォルトでは、すべての識別子 (テーブル名やフィールド) は大文字で返されます。
                    </p>
                </li>
            </ul>
        </div>

    </div>

</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.db.html">Zend_Db</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.db.html">Zend_Db</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.db.statement.html">Zend_Db_Statement(日本語)</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.db.html">Zend_Db</a></li>
  <li class="active"><a href="zend.db.adapter.html">Zend_Db_Adapter(日本語)</a></li>
  <li><a href="zend.db.statement.html">Zend_Db_Statement(日本語)</a></li>
  <li><a href="zend.db.profiler.html">Zend_Db_Profiler(日本語)</a></li>
  <li><a href="zend.db.select.html">Zend_Db_Select(日本語)</a></li>
  <li><a href="zend.db.table.html">Zend_Db_Table(日本語)</a></li>
  <li><a href="zend.db.table.row.html">Zend_Db_Table_Row(日本語)</a></li>
  <li><a href="zend.db.table.rowset.html">Zend_Db_Table_Rowset(日本語)</a></li>
  <li><a href="zend.db.table.relationships.html">導入</a></li>
  <li><a href="zend.db.table.definition.html">Zend_Db_Table_Definition(日本語)</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>