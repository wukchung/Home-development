<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Google Tabellenkalkulation verwenden - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.gdata.health.html">Verwenden von Google Health</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.gdata.html">Zend_Gdata</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.gdata.gapps.html">Google Apps Provisionierung verwenden</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.gdata.spreadsheets" class="section"><div class="info"><h1 class="title">Google Tabellenkalkulation verwenden</h1></div>
    

    <p class="para">
        Die Google Tabellenkalkulations Daten <acronym class="acronym">API</acronym> erlaubt es Client Anwendungen
        Inhalte von Tabellenkalkulationen zu sehen und Inhalte von Tabellenkalkulationen in der form
        von Google Daten <acronym class="acronym">API</acronym> Feeds zu aktualisieren. Die eigene Client Anwendung
        kann eine Liste von Tabellenkalkulationen eines Benutzer anfragen, Inhalte eines bestehenden
        Arbeitsblatts der Tabellenkalkulation bearbeiten oder löschen, und den Inhalt eines
        bestehenden Arbeitsblatt der Tabellenkalkulation abfragen.
    </p>

    <p class="para">
        Siehe <a href="http://code.google.com/apis/spreadsheets/overview.html" class="link external">&raquo; http://code.google.com/apis/spreadsheets/overview.html</a>
        für weitere Informationen über die Google&#039;s Tabellenkalkulations <acronym class="acronym">API</acronym>.
    </p>

    <div class="section" id="zend.gdata.spreadsheets.creating" name="zend.gdata.spreadsheets.creating"><div class="info"><h1 class="title">Eine Tabellenkalkulation erstellen</h1></div>
        

        <p class="para">
            Die Tabellenkalkulations Daten <acronym class="acronym">API</acronym> bietet aktuell noch keinen Weg um
            eine Tabellenkalkulation programmtechnisch zu erstellen oder zu löschen.
        </p>
    </div>

    <div class="section" id="zend.gdata.spreadsheets.listspreadsheets" name="zend.gdata.spreadsheets.listspreadsheets"><div class="info"><h1 class="title">Eine Liste von Tabellenkalkulationen erhalten</h1></div>
        

        <p class="para">
            Man kann eine Liste von Tabellenkalkulationen für einen bestimmten Benutzer erhalten
            indem die  <span class="methodname">getSpreadsheetFeed()</span> Methode des
            Tabellenkalkulationsservices verwendet wird. Der Service wird ein
            <span class="classname">Zend_Gdata_Spreadsheets_SpreadsheetFeed</span> Objekt zurückgeben das
            eine Liste von Tabellenkalkulationen enthält die mit dem authentifizierten Benutzer
            authentifiziert sind.
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$service</span> = Zend_Gdata_Spreadsheets::<span style="color: #006600;">AUTH_SERVICE_NAME</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$client</span> = Zend_Gdata_ClientLogin::<span style="color: #006600;">getHttpClient</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$user</span>, <span style="color: #0000ff;">$pass</span>, <span style="color: #0000ff;">$service</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$spreadsheetService</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$client</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$feed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getSpreadsheetFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

    </div>

     <div class="section" id="zend.gdata.spreadsheets.listworksheets" name="zend.gdata.spreadsheets.listworksheets"><div class="info"><h1 class="title">Eine Liste von Arbeitsblättern erhalten</h1></div>
        

        <p class="para">
            Eine gegebene Tabellenkalkulation kann mehrere Arbeitsblätter enthalten. Für jedes
            Arbeitsblass gibt es einen Arbeitsblatt Metafeed der alle Arbeitsblätter in dieser
            Tabellenkalkulation auflistet.
        </p>

        <p class="para">
            Mit der Schlüssel der Tabellenkalkulation von der &lt;id&gt; des
            <span class="classname">Zend_Gdata_Spreadsheets_SpreadsheetEntry</span> Objekts das man bereits
            empfangen hat, kann mein einen Feed holen der eine Liste von Arbeitsblättern enthält die
            mit dieser Tabellenkalkulation assoziiert sind.
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets_DocumentQuery<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setSpreadsheetKey</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$spreadsheetKey</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$feed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getWorksheetFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            Der sich ergebende <span class="classname">Zend_Gdata_Spreadsheets_WorksheetFeed</span>
            Objektfeed repräsentiert die Antwort des Servers. Neben anderen Dingen enthält dieser
            Feed eine Liste von <span class="classname">Zend_Gdata_Spreadsheets_WorksheetEntry </span>
            Objekten (<strong class="command">$feed-&gt;entries</strong>), wobei jedes ein einzelnes Arbeitsblatt
            repräsentiert.
        </p>
    </div>

    <div class="section" id="zend.gdata.spreadsheets.listfeeds" name="zend.gdata.spreadsheets.listfeeds"><div class="info"><h1 class="title">Mit listen-basierenden Feeds interagieren</h1></div>
        

        <p class="para">
            Ein gegebenes Arbeitsblatt enthält generell mehrere Zeilen, wobei jede mehrere Zellen
            enthält. Man kann Daten vom Arbeitsblatt entweder als listen-basierenden Feed anfragen,
            in dem jeder Eintrag eine Zeile repräsentiert, oder als zellen-basierenden Feed, in dem
            jeder Eintrag eine einzelne Zelle repräsentiert. Für Informationen über
            zellen-basierende Feeds kann auch unter <a href="zend.gdata.spreadsheets.html#zend.gdata.spreadsheets.cellfeeds" class="link">Interaktion mit zellen-basierenden
                Feeds</a> nachgesehen werden.
        </p>

        <p class="para">
            Die folgenden Sektionen beschreiben wie man einen Listen basierender Feed erhält, eine
            Zeile zu einem Arbeitsblatt hinzufügt, und Abfragen mit verschiedenen Abfrage Parametern
            sendet.
        </p>

        <p class="para">
            Der Listenfeed macht einige Annahmen darüber wie die Daten in der Tabellenkalkulation
            ausgelegt sind.
        </p>

        <p class="para">
            Im speziellen, behandelt der Listenfeed die erste Zeile des Arbeitsblattes als
            Kopfzeile; Tabellenkalkulationen erstellen dynamisch <acronym class="acronym">XML</acronym> Elemente
            welche nach dem Inhalt der Kopfzeilen-Zellen benannt sind. Benutzer welche Gdata Feeds
            anbieten wollen, sollten keine andere Daten als Spaltenheader in der ersten Zeile eines
            Arbeitsblattes ablegen.
        </p>

        <p class="para">
            Der Listenfeed enthält alle Zeilen nach der ersten Zeile bis zur ersten leeren Zeile.
            Die erste leere Zeile terminiert das Datenset. Wenn angenommene Daten nicht in einem
            Feed erscheinen, muß das Arbeitsblatt manuell darauf geprüft werden ob eine unerwartete
            leere Zeile in der Mitte der Daten vorhanden ist. Im speziellen wird der Listenfeed,
            wenn die zweite Zeile der Tabellenkalkulation leer ist, keine Daten enthalten.
        </p>

        <p class="para">
            Eine Zeile in einem Listenfeed ist soviele Spalten breit wie das Arbeitsblatt selbst.
        </p>

        <div class="section" id="zend.gdata.spreadsheets.listfeeds.get" name="zend.gdata.spreadsheets.listfeeds.get"><div class="info"><h1 class="title">Einen listen-basierenden Feed erhalten</h1></div>
            

            <p class="para">
                Um einen Listenfeed eines Arbeitsblattes zu erhalten, kann die
                 <span class="methodname">getListFeed()</span> Methode des Tabellenkalkulations Services
                verwendet werden.
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets_ListQuery<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setSpreadsheetKey</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$spreadsheetKey</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setWorksheetId</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$worksheetId</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$listFeed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getListFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Das sich ergebende <span class="classname">Zend_Gdata_Spreadsheets_ListFeed</span> Objekt
                <var class="varname">$listfeed</var> repräsentiert eine Antwort vom Server. Neben anderen
                Dingen enthält dieser Feed ein Array von
                <span class="classname">Zend_Gdata_Spreadsheets_ListEntry</span> Objekten
                (<strong class="command">$listFeed-&gt;entries</strong>), wobei jedes eine einzelne Zeile in einem
                Arbeitsblatt repräsentiert.
            </p>

            <p class="para">
                Jeder <span class="classname">Zend_Gdata_Spreadsheets_ListEntry</span> enthält ein Array,
                <span class="property">custom</span>, welches die Daten für die Zeile enthält. Dieses Array
                kann extrahiert und angezeigt werden:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$rowData</span> = <span style="color: #0000ff;">$listFeed</span>-&gt;<span style="color: #006600;">entries</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>-&gt;<span style="color: #006600;">getCustom</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">foreach</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$rowData</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$customEntry</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$customEntry</span>-&gt;<span style="color: #006600;">getColumnName</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> . <span style="color: #ff0000;">&quot; = &quot;</span> . <span style="color: #0000ff;">$customEntry</span>-&gt;<span style="color: #006600;">getText</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>


            <p class="para">
                Eine alternative Version dieses Arrays, <span class="property">customByName</span>, erlaubt
                den direkten Zugriff zu dem Eintrag einer Zelle durch den Namen. Das ist üblich,
                wenn man versucht auf einen speziellen Header zuzugreifen:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$customEntry</span> = <span style="color: #0000ff;">$listFeed</span>-&gt;<span style="color: #006600;">entries</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>-&gt;<span style="color: #006600;">getCustomByName</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'my_heading'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #0000ff;">$customEntry</span>-&gt;<span style="color: #006600;">getColumnName</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span> . <span style="color: #ff0000;">&quot; = &quot;</span> . <span style="color: #0000ff;">$customEntry</span>-&gt;<span style="color: #006600;">getText</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <div class="section" id="zend.gdata.spreadsheets.listfeeds.reverse" name="zend.gdata.spreadsheets.listfeeds.reverse"><div class="info"><h1 class="title">Umgekehrt-sortierte Zeilen</h1></div>
            

            <p class="para">
                Standardmäßig werden die Zeilen im Feed in der gleichen Reihenfolge angezeigt wie in
                den entsprechenden Zeilen im GUI; das ist die Reihenfolge anhand der Zeilennummer.
                Um Zeilen in einer umgekehrten Reihenfolge zu erhalten, muß die reverse Eigenschaft
                des <span class="classname">Zend_Gdata_Spreadsheets_ListQuery</span> Objektes auf
                <b><tt>TRUE</tt></b> gesetzt werden:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets_ListQuery<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setSpreadsheetKey</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$spreadsheetKey</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setWorksheetId</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$worksheetId</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setReverse</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'true'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$listFeed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getListFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Es ist zu beachten, das wenn nach einer speziellen Spalte sortiert (oder umgekehrt
                sortiert) werden soll, statt nach der Position im Arbeitsblatt, kann der
                <span class="property">orderby</span> Wert des
                <span class="classname">Zend_Gdata_Spreadsheets_ListQuery</span> Objekts auf
                <em class="emphasis">column:&lt;Der Header dieser Spalte&gt;</em> gesetzt werden.
            </p>
        </div>

        <div class="section" id="zend.gdata.spreadsheets.listfeeds.sq" name="zend.gdata.spreadsheets.listfeeds.sq"><div class="info"><h1 class="title">Eine strukturierte Abfrage senden</h1></div>
            

            <p class="para">
                Der <span class="property">sq</span> Wert von
                <span class="classname">Zend_Gdata_Spreadsheets_ListQuery</span> kann gesetzt werden um
                einen Feed mit Einträgen zu erzeugen die ein spezielles Kriterium erfüllen.
                Angenommen, man hat ein Arbeitsblatt das personelle Daten enthält, in denen jede
                Zeile Informationen über eine einzelne Person repräsentiert, und man will alle
                Zeilen empfangen will in denen der Name der Person &quot;John&quot; ist, und das Alter der
                Person über 25. Um das tu tun, muß <span class="property">sq</span> wie folgt gesetzt werden:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets_ListQuery<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setSpreadsheetKey</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$spreadsheetKey</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setWorksheetId</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$worksheetId</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setSpreadsheetQuery</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'name=John and age&gt;25'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$listFeed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getListFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>

        <div class="section" id="zend.gdata.spreadsheets.listfeeds.addrow" name="zend.gdata.spreadsheets.listfeeds.addrow"><div class="info"><h1 class="title">Hinzufügen einer Zeile</h1></div>
            

            <p class="para">
                Zeilen können zu einer Tabellenkalkulation hinzugefügt werden durch Verendung der
                 <span class="methodname">insertRow()</span> Methode des Tabellenkalkulations Services.
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$insertedListEntry</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">insertRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$rowData</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$spreadsheetKey</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$worksheetId</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Der <var class="varname">$rowData</var> Parameter enthält ein Array von Spaltenschlüssel zu
                Datenwerten. Die Methode gibt ein
                <span class="classname">Zend_Gdata_Spreadsheets_SpreadsheetsEntry</span> Objekt zurück
                welches die eingefügte Zeile repräsentiert.
            </p>

            <p class="para">
                Die Tabellenkalkulation fügt die neue Zeile unmittelbar nach der letzten Zeile ein
                die in dem listen-basierenden Feed erscheint, was bedeutet unmittelbar vor der
                ersten komplett leeren Zeile.
            </p>
        </div>

        <div class="section" id="zend.gdata.spreadsheets.listfeeds.editrow" name="zend.gdata.spreadsheets.listfeeds.editrow"><div class="info"><h1 class="title">Eine Zeile bearbeiten</h1></div>
            

            <p class="para">
                Sobald ein <span class="classname">Zend_Gdata_Spreadsheets_ListEntry</span> Objekt geholt
                wird, können diese Zeilen durch die Verwendung der
                 <span class="methodname">updateRow()</span> Methode des Tabellenkalkulations Services
                aktualisiert werden.
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$updatedListEntry</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">updateRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$oldListEntry</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$newRowData</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Der <var class="varname">$oldListEntry</var> Parameter enthält den Listeneintrag der
                aktualisiert werden soll. <var class="varname">$newRowData</var> enthält ein Array von
                Spaltenschlüssel zu Datenwerten, die als neue Zeilendaten verwendet werden. Diese
                Methode gibt ein <span class="classname">Zend_Gdata_Spreadsheets_SpreadsheetsEntry</span>
                Objekt zurück welches die aktualisierte Zeile repräsentiert.
            </p>
        </div>

        <div class="section" id="zend.gdata.spreadsheets.listfeeds.deleterow" name="zend.gdata.spreadsheets.listfeeds.deleterow"><div class="info"><h1 class="title">Eine Zeile löschen</h1></div>
            

            <p class="para">
                Um eine Zeile zu löschen muß einfach  <span class="methodname">deleteRow()</span> auf dem
                <span class="classname">Zend_Gdata_Spreadsheets</span> Objekt mit dem bestehenden Eintrag
                aufgerufen werden, der gelöscht werden soll:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">deleteRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$listEntry</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Alternativ kann die  <span class="methodname">delete()</span> Methode des Eintrags selbst
                aufgerufen werden:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$listEntry</span>-&gt;<span style="color: #006600;">delete</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>

        </div>
    </div>

    <div class="section" id="zend.gdata.spreadsheets.cellfeeds" name="zend.gdata.spreadsheets.cellfeeds"><div class="info"><h1 class="title">Mit zellen-basierenden Feeds interagieren</h1></div>
        

        <p class="para">
            In einem zellen-basierenden Feed repräsentiert jeder Eintrag eine einzelne Zelle.
        </p>

        <p class="para">
            Es wird nicht empfohlen mit beiden, einem zellen-basierenden Feed und einem
            listen-basierenden Feed für das gleiche Arbeitsblatt zur selben Zeit zu interagieren.
        </p>

        <div class="section" id="zend.gdata.spreadsheets.cellfeeds.get" name="zend.gdata.spreadsheets.cellfeeds.get"><div class="info"><h1 class="title">Einen zellen-basierenden Feed erhalten</h1></div>
            

            <p class="para">
                Um einen Zellen Feed des Arbeitsblatt zu erhalten muß die
                 <span class="methodname">getCellFeed()</span> Methode des Tabellenkalkulations Services
                verwendet werden.
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets_CellQuery<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setSpreadsheetKey</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$spreadsheetKey</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setWorksheetId</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$worksheetId</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$cellFeed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getCellFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Im resultierenden <span class="classname">Zend_Gdata_Spreadsheets_CellFeed</span> Objekt
                repräsentiert <var class="varname">$cellFeed</var> eine Antwort vom Server. Neben anderen
                Dingen enthält dieser Feed ein Array von
                <span class="classname">Zend_Gdata_Spreadsheets_CellEntry</span> Objekten
                (<strong class="command">$cellFeed&gt;entries</strong>), von denen jeder eine einzelne Zelle in einem
                Arbeitsblatt repräsentiert. Diese Information kann angezeigt werden:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">foreach</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$cellFeed</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$cellEntry</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <span style="color: #0000ff;">$row</span> = <span style="color: #0000ff;">$cellEntry</span>-&gt;<span style="color: #006600;">cell</span>-&gt;<span style="color: #006600;">getRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <span style="color: #0000ff;">$col</span> = <span style="color: #0000ff;">$cellEntry</span>-&gt;<span style="color: #006600;">cell</span>-&gt;<span style="color: #006600;">getColumn</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <span style="color: #0000ff;">$val</span> = <span style="color: #0000ff;">$cellEntry</span>-&gt;<span style="color: #006600;">cell</span>-&gt;<span style="color: #006600;">getText</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; <a href="http://www.php.net/echo"><span style="color: #000066;">echo</span></a> <span style="color: #ff0000;">&quot;$row, $col = $val<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

        </div>

        <div class="section" id="zend.gdata.spreadsheets.cellfeeds.cellrangequery" name="zend.gdata.spreadsheets.cellfeeds.cellrangequery"><div class="info"><h1 class="title">Eine Zellen-Bereichs Abfrage senden</h1></div>
            

            <p class="para">
                Angenommen man will die Zellen der ersten Spalte des Arbeitsblattes empfangen. Man
                kann einen Zellen Feed abfragen der nur diese Spalte enthält und geht hierbei wie
                folgt vor:
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Gdata_Spreadsheets_CellQuery<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setMinCol</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setMaxCol</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span>-&gt;<span style="color: #006600;">setMinRow</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$feed</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">getCellsFeed</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Das fragt alle Daten in der Spalte 1, beginnend mit der Zeile 2, ab.
            </p>
        </div>

        <div class="section" id="zend.gdata.spreadsheets.cellfeeds.updatecell" name="zend.gdata.spreadsheets.cellfeeds.updatecell"><div class="info"><h1 class="title">Den Inhalt einer Zelle ändern</h1></div>
            

            <p class="para">
                Um den Inhalt einer Zelle zu ändern, muß  <span class="methodname">updateCell()</span> mit
                der Zeile, Spalte und dem neuen Wert der Zelle, aufgerufen werden.
            </p>

            <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$updatedCell</span> = <span style="color: #0000ff;">$spreadsheetService</span>-&gt;<span style="color: #006600;">updateCell</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$row</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$col</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$inputValue</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$spreadsheetKey</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span style="color: #0000ff;">$worksheetId</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


            <p class="para">
                Die neuen Daten werden in der spezifizierten Zelle im Arbeitsblatt plaziert. Wenn
                die spezifizierte Zelle bereits Daten enthält, werden diese überschrieben. Beachte:
                 <span class="methodname">updateCell()</span> muß verwedet werden um Daten in einer Zelle zu
                verändern, selbst wenn diese Zelle leer ist.
            </p>
        </div>
    </div>
</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.gdata.health.html">Verwenden von Google Health</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.gdata.html">Zend_Gdata</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.gdata.gapps.html">Google Apps Provisionierung verwenden</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.gdata.html">Zend_Gdata</a></li>
  <li><a href="zend.gdata.introduction.html">Einf&uuml;hrung</a></li>
  <li><a href="zend.gdata.authsub.html">Authentifizierung mit AuthSub</a></li>
  <li><a href="zend.gdata.books.html">Die Buchsuche Daten API verwenden</a></li>
  <li><a href="zend.gdata.clientlogin.html">Authentifizieren mit ClientLogin</a></li>
  <li><a href="zend.gdata.calendar.html">Google Kalender verwenden</a></li>
  <li><a href="zend.gdata.docs.html">Verwenden der Google Dokumente Listen Daten API</a></li>
  <li><a href="zend.gdata.health.html">Verwenden von Google Health</a></li>
  <li class="active"><a href="zend.gdata.spreadsheets.html">Google Tabellenkalkulation verwenden</a></li>
  <li><a href="zend.gdata.gapps.html">Google Apps Provisionierung verwenden</a></li>
  <li><a href="zend.gdata.gbase.html">Google Base verwenden</a></li>
  <li><a href="zend.gdata.photos.html">Picasa Web Alben verwenden</a></li>
  <li><a href="zend.gdata.youtube.html">Verwenden der YouTube Daten API</a></li>
  <li><a href="zend.gdata.exception.html">Gdata Ausnahmen auffangen</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>