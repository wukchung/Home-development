<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>Die besten Anwendungen - Zend Framework Manual</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td width="85%">
            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.search.lucene.advanced.html">Erweitert</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.search.lucene.html">Zend_Search_Lucene</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.serializer.html">Zend_Serializer</a></div>
                    </td>
                </tr>
            </table>
<hr />
<div id="zend.search.lucene.best-practice" class="section"><div class="info"><h1 class="title">Die besten Anwendungen</h1></div>
    

    <div class="section" id="zend.search.lucene.best-practice.field-names" name="zend.search.lucene.best-practice.field-names"><div class="info"><h1 class="title">Feldnamen</h1></div>
        

        <p class="para">
            Es gibt keine Begrenzungen für Feldnamen in <span class="classname">Zend_Search_Lucene</span>.
        </p>

        <p class="para">
            Trotzdem ist es eine gute Idee die &#039;<em class="emphasis">id</em>&#039; und
            &#039;<em class="emphasis">score</em>&#039; Namen nicht zu verwenden um Doppeldeutigkeiten in den Namen
            der <span class="classname">QueryHit</span> Eigenschaften zu verhindern.
        </p>

        <p class="para">
            Die <span class="classname">Zend_Search_Lucene_Search_QueryHit</span> <span class="property">id</span>
            und <span class="property">score</span> Eigenschaften referieren immer zur internen Lucene
            Dokumenten Id und Treffer- <a href="zend.search.lucene.searching.html#zend.search.lucene.searching.results-scoring" class="link">Anzahl</a>. Wenn ein
            indiziertes Dokument die gleichen Felder gespeichert hat, muß die
             <span class="methodname">getDocument()</span> Methode verwendet werden um auf Sie zuzugreifen:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$hits</span> = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">find</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">foreach</span> <span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$hits</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$hit</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Das 'title' Dokumentfeld erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$title</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">title</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Das 'contents' Dokumentfeld erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$contents</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">contents</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Die interne Lucene Dokument ID erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$id</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">id</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Die Anzahl der Abfragetreffer erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$score</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">score</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Das 'id' Dokumentfeld erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$docId</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">getDocument</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">id</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Das 'score' Dokumentfeld erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$docId</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">getDocument</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">score</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #808080; font-style: italic;">// Ein anderer Weg um das 'title' Dokumentfeld zu erhalten</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$title</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">getDocument</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>-&gt;<span style="color: #006600;">title</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.search.lucene.best-practice.indexing-performance" name="zend.search.lucene.best-practice.indexing-performance"><div class="info"><h1 class="title">Geschwindigkeit von Indezes</h1></div>
        

        <p class="para">
            Die Geschwindigkeit von Indezes ist ein Kompromiss zwischen verwendeten Ressourcen, der
            Zeit für das Indizieren und die Qualität des Index.
        </p>

        <p class="para">
            Die Qualität des Index wird komplett eruiert durch die Anzahl an Indexsegmenten.
        </p>

        <p class="para">
            Jedes Indexsegment ist ein komplett unabhängiger Teil von Daten. Deshalb benötigt ein
            Index der mehr Segmente hat, auch mehr Speicher und mehr Zeit für das Suchen.
        </p>

        <p class="para">
            Indexoptimierung ist ein Prozess der mehrere Segmente in ein neues zusammenfügt. Ein
            komplett optimierter Index enthält nur ein Segment.
        </p>

        <p class="para">
            Komplette Indexoptimierung kann mit der  <span class="methodname">optimize()</span> Methode
            durchgeführt werden:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$index</span> = Zend_Search_Lucene::<span style="color: #006600;">open</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$indexPath</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">optimize</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            Index Optimierung arbeitet mit Daten Streams und benötigt nicht viel Speicher dafür aber
            Prozessorzessourcen und Zeit.
        </p>

        <p class="para">
            Lucene Index Segmente sind nicht aktualisierbar durch Ihre Natur (eine Aktualisierung
            erfordert das die Segment Datei komplett neu geschrieben wird). Deshalb erzeugt das
            Hinzufügen neuer Dokumente zu einem Index auch immer ein neues Segment. Das verkleinert
            natürlich die Qualität des Index.
        </p>

        <p class="para">
            Der automatische Optimierungsprozess des Index wird nach jeder Erstellung eines Segments
            durchgeführt und besteht darin das Teilsegmente zusammengeführt werden.
        </p>

        <p class="para">
            Es gibt drei Optionen um das Verhalten der automatischen Optimierung zu beeinflussen
            (siehe das Kapitel <a href="zend.search.lucene.index-creation.html#zend.search.lucene.index-creation.optimization" class="link">Index
                Optimierung</a>):

            <ul class="itemizedlist">
                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">MaxBufferedDocs</em> ist die Anzahl an Dokumenten die im
                        Speicher gepuffert werden bevor ein neues Segment erstellt und auf die
                        Festplatte geschrieben wird.
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">MaxMergeDocs</em> ist die maximale Anzahl an Dokumenten die
                        durch den automatischen Optimierungsprozess in ein neues Segment
                        zusamengeführt werden.
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        <em class="emphasis">MergeFactor</em> ermittelt wie oft die automatische
                        Optimierung durchgeführt wird.
                    </p>
                </li>
            </ul>

            <blockquote><p><b class="note">Note</b>: 
                
                    Alle diese Optionen sind Objekteigenschaften von
                    <span class="classname">Zend_Search_Lucene</span>, aber keine Indexeigenschaften. Sie
                    beeinflussen nur das Verhalten des aktuellen
                    <span class="classname">Zend_Search_Lucene</span> Objekts und können sich für
                    verschiedene Skripte unterscheiden.
                <br />
            </p></blockquote>
        </p>

        <p class="para">
            <em class="emphasis">MaxBufferedDocs</em> hat keinen Effekt wenn nur ein Dokument pro
            Skriptausführung indiziert wird. Auf der anderen Seite ist das sehr wichtig für die
            Indizierung per Batch. Größere Werte erhöhen die Geschwindigkeit des Indizierens,
            benötigen aber auch mehr Speicher.
        </p>

        <p class="para">
            Es gibt einfach keinen Weg um den besten Wert für den
            <em class="emphasis">MaxBufferedDocs</em> Parameter zu berechnen weil es von der
            durchschnittlichen Größe des Dokuments abhängt, dem verwendeten Analysator und dem
            erlaubten Speicher.
        </p>

        <p class="para">
            Ein guter Weg um den richtigen Wert herauszufinden, ist die Durchführung von
            verschiedenen Tests mit den größten Dokumenten von denen man erwartet das Sie indiziert
            werden.

            <a href="#fnid1" name="fn1"><sup>[1]</sup></a>
                
                     <span class="methodname">memory_get_usage()</span> <span class="methodname">memory_get_peak_usage()</span>
            

            Es ist eine gute Praxis nicht mehr als die Hälfte des erlaubten Speichers zu verwenden.
        </p>

        <p class="para">
            <em class="emphasis">MaxMergeDocs</em> limitiert die Größe des Segments (in Dokumenten).
            Es begrenzt also die Zeit für die automatische Optimierung indem es garantiert das die
             <span class="methodname">addDocument()</span> Methode nur eine bestimmte Anzahl oft ausgeführt
            wird. Das ist für interaktive Anwendungen sehr wichtig.
        </p>

        <p class="para">
            Das Verkleinern des <em class="emphasis">MaxMergeDocs</em> Parameters kann auch die
            Geschwindigkeit des Batchinzieierens beeinflussen. Automatische Optimierung des Index
            ist ein iterativer Prozess und wird Schritt für Schritt durchgeführt. Kleine Segmente
            werden in größere zusammengeführt, und irgendwann werden Sie in sogar noch größere
            zusammengeführt und so weiter. Komplette Optimierung des Index wird durchgeführt wenn
            nur mehr ein großes Segment überbleibt.
        </p>

        <p class="para">
            Kleinere Segmente verkleinern generell die Qualität des Index. Viele kleine Segmente
            können auch zu einem &quot;Too many open files&quot; Fehler führen, ausgelöst durch die
            Beschränkungen des Betriebsystems.

            <a href="#fnid2" name="fn2"><sup>[2]</sup></a>
                
                    <span class="classname">Zend_Search_Lucene</span>
            
        </p>

        <p class="para">
            Generell sollte die Optimierung des Index für einen interaktiven Modus des Indizierens
            im Hintergrund durchgeführt werden und <em class="emphasis">MaxMergeDocs</em> sollte für die
            nicht zu klein für die Indizierung per Batch sein.
        </p>

        <p class="para">
            <em class="emphasis">MergeFactor</em> beeinflußt die Frequenz der automatischen Optimierung.
            Kleinere Werte erhöhen die Qualität des nicht optimierten Index. Größere Werte erhöhen
            die Geschwindigkeit des Indizierens, aber auch die Anzahl an Segmenten. Das wiederum
            kann wieder zu einem &quot;Too many open files&quot; Fehler führen.
        </p>

        <p class="para">
            <em class="emphasis">MergeFactor</em> gruppiert Indexsegmente anhand Ihrer Größe:

            <ol type="1">
                <li class="listitem">
                    <p class="para">
                        Nicht größer als <em class="emphasis">MaxBufferedDocs</em>.
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Größer als <em class="emphasis">MaxBufferedDocs</em>, aber nicht größer als
                        <em class="emphasis">MaxBufferedDocs</em>*<em class="emphasis">MergeFactor</em>.
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">
                        Größer als
                        <em class="emphasis">MaxBufferedDocs</em>*<em class="emphasis">MergeFactor</em>, aber
                        nicht größer als
                        <em class="emphasis">MaxBufferedDocs</em>*<em class="emphasis">MergeFactor</em>*<em class="emphasis">MergeFactor</em>.
                    </p>
                </li>

                <li class="listitem">
                    <p class="para">...</p>
                </li>
            </ol>
        </p>

        <p class="para">
            <span class="classname">Zend_Search_Lucene</span> prüft wärend jedem Aufruf von
             <span class="methodname">addDocument()</span> ob das Zusammenführen von Segmentgruppen dazu
            führt das neu erstellte Segmente in die nächste Gruppe verschoben werden. Wenn ja, wird
            das Zusammenführen durchgeführt.
        </p>

        <p class="para">
            Also kann ein Index mit N Gruppen
            <em class="emphasis">MaxBufferedDocs</em> + (N-1)*<em class="emphasis">MergeFactor</em> Segmente
            und zumindest
            <em class="emphasis">MaxBufferedDocs</em>*<em class="emphasis">MergeFactor</em><sup class="superscript">(N-1)</sup>
            Dokumente enthalten.
        </p>

        <p class="para">
            Das gibt eine gute Annäherung für die Anzahl an Segmenten im Index:
        </p>

        <p class="para">
            <em class="emphasis">NumberOfSegments</em> &lt;= <em class="emphasis">MaxBufferedDocs</em> +
            <em class="emphasis">MergeFactor</em>*log
            <sub class="subscript"><em class="emphasis">MergeFactor</em></sub>
            (<em class="emphasis">NumberOfDocuments</em>/<em class="emphasis">MaxBufferedDocs</em>)
        </p>

        <p class="para">
            <em class="emphasis">MaxBufferedDocs</em> wird durch den erlaubten Speicher eruiert. Das
            erlaubt es dem gewünschten Faktor für das Zusammenführen eine erwünschte Anzahl an
            Segmenten zu erhalten.
        </p>

        <p class="para">
            Das Tunen des <em class="emphasis">MergeFactor</em> Parameters ist effektiver für die
            Geschwindigkeit der Indizierens per Batch als <em class="emphasis">MaxMergeDocs</em>. Aber es
            ist auch gröber. Deshalb sollte die obige Annäherung für das Tunen des
            <em class="emphasis">MergeFactor</em>&#039;s verwendet werden und anschließend mit
            <em class="emphasis">MaxMergeDocs</em> herumgespielt werden um die beste Geschwindigkeit für
            die Indizieren per Batch zu erhalten.
        </p>
    </div>

    <div class="section" id="zend.search.lucene.best-practice.shutting-down" name="zend.search.lucene.best-practice.shutting-down"><div class="info"><h1 class="title">Index wärend des Herunterfahrens</h1></div>
        

        <p class="para">
            Die <span class="classname">Zend_Search_Lucene</span> Instanz führt einiges an Arbeit während
            des Herunterfahrens durch, wenn Dokumente zum Index hinzugefügt aber nicht in ein neues
            Segment geschrieben wurden.
        </p>

        <p class="para">
            Das kann auch einen automatischen Optimierungsprozess anwerfen.
        </p>

        <p class="para">
            Das Indexobjekt wird automatisch geschlossen wenn es, und alle zurückgegebenen QueryHit
            Objekte, ausserhalb des Sichtbereichs sind.
        </p>

        <p class="para">
            Wenn das Indexobjekt in einer globalen Variable gespeichert wird, wird es nur am Ende
            der Skriptausführung zerstört

            <a href="#fnid3" name="fn3"><sup>[3]</sup></a>
                <acronym class="acronym">PHP</acronym>
            .
        </p>

        <p class="para">
            Die Behandlung von <acronym class="acronym">PHP</acronym> Ausnahmen wird in diesem Moment auch
            Herunterfahren.
        </p>

        <p class="para">
            Das beeinflußt den normalen Shutdown Prozess des Index nicht, kann aber eine akurate
            Diagnostik von Fehlern verhindern wenn ein Fehler wärend des herunterfahrens
            stattfindet.
        </p>

        <p class="para">
            Es gibt zwei Wege mit denen dieses Problem verhindert werden kann.
        </p>

        <p class="para">
            Der erste ist, dass das Herausgehen aus dem Sichtbereich erzwungen wird:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$index</span> = Zend_Search_Lucene::<span style="color: #006600;">open</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$indexPath</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/unset"><span style="color: #000066;">unset</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$index</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            Und der zweite ist, das eine commit Operation vor dem Ausführungsende des Skripts
            durchgeführt wird:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$index</span> = Zend_Search_Lucene::<span style="color: #006600;">open</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$indexPath</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">commit</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            Diese Möglichkeit wird auch im Kapitel &quot;<a href="zend.search.lucene.advanced.html#zend.search.lucene.advanced.static" class="link">Fortgeschrittene Verwendung von Indezes
                als statische Eigenschaften</a>&quot; beschrieben.
        </p>
    </div>

    <div class="section" id="zend.search.lucene.best-practice.unique-id" name="zend.search.lucene.best-practice.unique-id"><div class="info"><h1 class="title">Dokumente anhand der eindeutigen Id erhalten</h1></div>
        

        <p class="para">
            Eine übliche Praxis ist es eindeutige Dokument Id&#039;s im Index zu speichern. Beispiele
            beinhalten URL, Pfad, Datenbank Id.
        </p>

        <p class="para">
            <span class="classname">Zend_Search_Lucene</span> bietet eine
             <span class="methodname">termDocs()</span> Methode um Dokumente zu empfangen die spezielle
            Terme enthalten.
        </p>

        <p class="para">
            Das ist effizienter als die Verwendung der  <span class="methodname">find()</span> Methode:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Dokumente mit find() empfangen durch verwenden eines Abfragestrings</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #0000ff;">$idFieldName</span> . <span style="color: #ff0000;">':'</span> . <span style="color: #0000ff;">$docId</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$hits</span>&nbsp; = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">find</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">foreach</span> <span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$hits</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$hit</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$title</span>&nbsp; &nbsp; = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">title</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$contents</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">contents</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; ...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Dokumente mit der find() Methode empfangen durch verwenden der Anfrage API</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$term</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Search_Lucene_Index_Term<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$docId</span>, <span style="color: #0000ff;">$idFieldName</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Search_Lucene_Search_Query_Term<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$term</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$hits</span>&nbsp; = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">find</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">foreach</span> <span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$hits</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$hit</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$title</span>&nbsp; &nbsp; = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">title</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$contents</span> = <span style="color: #0000ff;">$hit</span>-&gt;<span style="color: #006600;">contents</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; ...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">// Dokumente mit der termDocs() Methode empfangen</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$term</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Search_Lucene_Index_Term<span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$docId</span>, <span style="color: #0000ff;">$idFieldName</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$docIds</span>&nbsp; = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">termDocs</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$term</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #b1b100;">foreach</span> <span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$docIds</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$id</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span></div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$doc</span> = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">getDocument</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$id</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$title</span>&nbsp; &nbsp; = <span style="color: #0000ff;">$doc</span>-&gt;<span style="color: #006600;">title</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; <span style="color: #0000ff;">$contents</span> = <span style="color: #0000ff;">$doc</span>-&gt;<span style="color: #006600;">contents</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; ...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #66cc66;">&#125;</span></div></li></ol></div></div></div>

    </div>

    <div class="section" id="zend.search.lucene.best-practice.memory-usage" name="zend.search.lucene.best-practice.memory-usage"><div class="info"><h1 class="title">Speicherverwendung</h1></div>
        

        <p class="para">
            <span class="classname">Zend_Search_Lucene</span> ist ein relativ speicherintensives Modul.
        </p>

        <p class="para">
            Es verwendet Speicher um Informationen zu Cachen, das Suchen zu optimieren und das
            Indizieren zu beschleunigen.
        </p>

        <p class="para">
            Der benötigte Speicher ist für unterschiedliche Modi verschieden.
        </p>

        <p class="para">
            Der Verzeichnisindex der Ausdrücke wird während der Suche geladen. Das ist aktuelle
            jeder 128 <sup class="superscript">te</sup> Ausdruck des kompletten Verzeichnisses.

            <a href="#fnid4" name="fn4"><sup>[4]</sup></a>
                <span class="classname">Zend_Search_Lucene</span><acronym class="acronym">API</acronym>
            
        </p>

        <p class="para">
            Deswegen ist der Speicherverbrauch erhöht wenn man eine große Anzahl an eindeutigen
            Ausdrücke hat. Das kann passieren wenn man ungeteilte Phrasen als Feld Werte verwendet,
            oder ein großes Volumen von nicht-textuellen Informationen hat.
        </p>

        <p class="para">
            Ein nicht optimierter Index besteht aus verschiedenen Segmenten. Er erhöht auch den
            Speicherverbrauch. Segmente sind voneinander unabhängig, sodas jedes Segment sein
            eigenes Verzeichnis an Ausdrücken enthält und den Verzeichnisindex der Ausdrücke. Wenn
            der Index aus <em class="emphasis">N</em> Segmenten besteht kann der Speicherverbrauch im
            schlimmsten Fall <em class="emphasis">N</em> mal so groß sein. Eine Optimierung des Index
            kann durchgeführt werden um alle Segmente in eines zusammenzuführen um diesen
            Speicherverbrauch zu verhindern.
        </p>

        <p class="para">
            Indizierung verwendet den gleichen Speicher wie das Suchen und zusätzlich Speicher für
            das Puffern von Dokumenten. Die Größe des Speichers der hierfür verwendet wird kann mit
            dem <em class="emphasis">MaxBufferedDocs</em> Parameter verwaltet werden.
        </p>

        <p class="para">
            Index Optimierung (komplett oder teilweise) verwendet stream-artiges Bearbeiten von
            Daten und benötigt nicht viel Speicher.
        </p>
    </div>

    <div class="section" id="zend.search.lucene.best-practice.encoding" name="zend.search.lucene.best-practice.encoding"><div class="info"><h1 class="title">Verschlüsselung</h1></div>
        

        <p class="para">
            <span class="classname">Zend_Search_Lucene</span> arbeitet intern mit UTF-8 Strings. Das
            bedeutet also das alle von <span class="classname">Zend_Search_Lucene</span> zurückgegebenen
            Strings UTF-8 verschlüsselt sind.
        </p>

        <p class="para">
            Man sollte sich keine Gedanken über Verschlüsselung machen solange man mit reinen
            <acronym class="acronym">ASCII</acronym> Daten arbeitet, sollte aber vorsichtig sein wenn das nicht der
            Fall ist.
        </p>

        <p class="para">
            Eine falsche Verschlüsselung kann Fehlernotizen wärend der Konvertierung oder den
            Verlust von Daten verursachen.
        </p>

        <p class="para">
            <span class="classname">Zend_Search_Lucene</span> bietet einen breite Palette von Möglichkeiten
            für die Verschlüsselung von indizierten Dokumenten und analysierten Abfragen.
        </p>

        <p class="para">
            Verschlüsselung kann explizit als optionaler Parameter bei den Felderstellung Methoden
            spezifiziert werden:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$doc</span> = <span style="color: #000000; font-weight: bold;">new</span> Zend_Search_Lucene_Document<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$doc</span>-&gt;<span style="color: #006600;">addField</span><span style="color: #66cc66;">&#40;</span>Zend_Search_Lucene_Field::<span style="color: #006600;">Text</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'title'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$title</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'iso-8859-1'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$doc</span>-&gt;<span style="color: #006600;">addField</span><span style="color: #66cc66;">&#40;</span>Zend_Search_Lucene_Field::<span style="color: #006600;">UnStored</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'contents'</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">$contents</span>,</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #ff0000;">'utf-8'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;</div></li></ol></div></div></div>


        <p class="para">
            Das ist der beste Weg um Problemen bei der verwendeten Verschlüsselung vorzubeugen.
        </p>

        <p class="para">
            Wenn der optionale Parameter der Verschlüsselung unterdrückt wird, wird das aktuelle
            Gebietsschema verwendet. Das aktuelle Gebietsschema kann Daten zur
            Zeichenverschlüsselung, zusätzlich zur Spezifikation der Sprache, enthalten.
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/setlocale"><span style="color: #000066;">setlocale</span></a><span style="color: #66cc66;">&#40;</span>LC_ALL, <span style="color: #ff0000;">'fr_FR'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/setlocale"><span style="color: #000066;">setlocale</span></a><span style="color: #66cc66;">&#40;</span>LC_ALL, <span style="color: #ff0000;">'de_DE.iso-8859-1'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><a href="http://www.php.net/setlocale"><span style="color: #000066;">setlocale</span></a><span style="color: #66cc66;">&#40;</span>LC_ALL, <span style="color: #ff0000;">'ru_RU.UTF-8'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li></ol></div></div></div>


        <p class="para">
            Der selbe Weg wird verwendet um die Verschlüsselung beim Abfragestring zu setzen.
        </p>

        <p class="para">
            Wenn die Verschlüsselung nicht definiert wird, wird das aktuelle Gebietsschema verwendet
            um die Verschlüsselung zu ermitteln.
        </p>

        <p class="para">
            Verschlüsselung kann als optionaler Parameter übergeben werden, wenn die Abfrage
            explizit vor der Suche geparsed wird:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$query</span> =</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp; Zend_Search_Lucene_Search_QueryParser::<span style="color: #006600;">parse</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$queryStr</span>, <span style="color: #ff0000;">'iso-8859-5'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$hits</span> = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">find</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$query</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li></ol></div></div></div>


        <p class="para">
            Die Standardverschlüsselung kann auch mit der
             <span class="methodname">setDefaultEncoding()</span> Methode spezifiziert werden:
        </p>

        <div class="programlisting php"><div class="phpcode"><div class="php" style="font-family: monospace;"><ol><li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Zend_Search_Lucene_Search_QueryParser::<span style="color: #006600;">setDefaultEncoding</span><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'iso-8859-1'</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #0000ff;">$hits</span> = <span style="color: #0000ff;">$index</span>-&gt;<span style="color: #006600;">find</span><span style="color: #66cc66;">&#40;</span><span style="color: #0000ff;">$queryStr</span><span style="color: #66cc66;">&#41;</span>;</div></li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;"><div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">...</div></li></ol></div></div></div>


        <p class="para">
            Ein leerer String impliziert das &#039;aktuelle Gebietsschema&#039;.
        </p>

        <p class="para">
            Wenn die richtige Verschlüsselung spezifiziert wurde, kann Sie vom Analysator richtig
            bearbeitet werden. Das aktuelle Verhalten hängt vom verwendeten Analysator ab. Siehe
            das Kapitel <a href="zend.search.lucene.charset.html" class="link">Zeichensatz</a> der
            Dokumentation für Details.
        </p>
    </div>

    <div class="section" id="zend.search.lucene.best-practice.maintenance" name="zend.search.lucene.best-practice.maintenance"><div class="info"><h1 class="title">Index Wartung</h1></div>
        

        <p class="para">
            Es sollte klar sein das <span class="classname">Zend_Search_Lucene</span>, genauso wie jede
            andere Lucene Implementation, keine &quot;Datenbank&quot; ersetzt.
        </p>

        <p class="para">
            Indizes sollten nicht als Datenspeicher verwendet werden. Sie bieten keine partiellen
            Backup/Wiederherstellungs Funktionen, Journal, Logging, Transactions und viele
            andere Features die mit Datenbank Management Systemen assoziiert werden.
        </p>

        <p class="para">
            Trotzdem versucht <span class="classname">Zend_Search_Lucene</span> Indizes jederzeit in einem
            gültigen Status zu halten.
        </p>

        <p class="para">
            Index Backup/Wiederherstellung sollte durch Kopieren des Inhalts des Index
            Verzeichnisses durchgeführt werden.
        </p>

        <p class="para">
            Wenn der Index durch irgendeinen Grund beschädigt wird, sollte der beschädigte Index
            wiederhergestellt oder komplett neu gebaut werden.
        </p>

        <p class="para">
            Es ist also eine gute Idee von großen Indizes ein Backup zu machen und ein Änderungslog
            zu speichern um manuelle Wiederherstellung + Roll-Forward Operationen durchzuführen wenn
            es notwendig ist. Diese Praxis reduziert die Wiederherstellungszeit des Index
            dramatisch.
        </p>
    </div>
<div class="footnote"><a name="fnid1" href="#fn1"><sup>[1]</sup></a><span class="para footnote"> und
                     können verwendet werden um die
                    Verwendung des Speichers zu kontrollieren.
                </span></div>
<div class="footnote"><a name="fnid2" href="#fn2"><sup>[2]</sup></a><span class="para footnote"> hält jedes Segment offen um die
                    Geschwindigkeit des Suchens zu erhöhen.
                </span></div>
<div class="footnote"><a name="fnid3" href="#fn3"><sup>[3]</sup></a><span class="para footnote">
                    Das kann auch vorkommen wenn der Index oder die QueryHit Instanzen in zyklischen
                    Datenstrukturen referenziert werden, weil  Objekte mit
                    zyklischen Referenzen nur am Ende der Skriptausführung beseitigt.
                </span></div>
<div class="footnote"><a name="fnid4" href="#fn4"><sup>[4]</sup></a><span class="para footnote">
                    Das Lucene Dateiformat erlaubt es diese Zahl zu ändern, aber
                     bietet keine Möglichkeit das über
                    seine  durchzuführen. Trotzdem gibt es die Möglichkeit
                    diesen Wert zu ändern wenn er mit einer anderen Lucene Implementation
                    vorbereitet wird.
                </span></div>
</div>
        <hr />

            <table width="100%">
                <tr>
                    <td width="25%" style="text-align: left;">
                    <a href="zend.search.lucene.advanced.html">Erweitert</a>
                    </td>

                    <td width="50%" style="text-align: center;">
                        <div class="up"><span class="up"><a href="zend.search.lucene.html">Zend_Search_Lucene</a></span><br />
                        <span class="home"><a href="manual.html">Programmer's Reference Guide</a></span></div>
                    </td>

                    <td width="25%" style="text-align: right;">
                        <div class="next" style="text-align: right; float: right;"><a href="zend.serializer.html">Zend_Serializer</a></div>
                    </td>
                </tr>
            </table>
</td>
        <td style="font-size: smaller;" width="15%"> <style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="manual.html">Programmer's Reference Guide</a></li>
  <li class="header up"><a href="reference.html">Zend Framework Reference</a></li>
  <li class="header up"><a href="zend.search.lucene.html">Zend_Search_Lucene</a></li>
  <li><a href="zend.search.lucene.overview.html">&Uuml;berblick</a></li>
  <li><a href="zend.search.lucene.index-creation.html">Indexerstellung</a></li>
  <li><a href="zend.search.lucene.searching.html">Einen Index durchsuchen</a></li>
  <li><a href="zend.search.lucene.query-language.html">Abfragesprache</a></li>
  <li><a href="zend.search.lucene.query-api.html">Abfrage Erzeugungs API</a></li>
  <li><a href="zend.search.lucene.charset.html">Zeichens&auml;tze</a></li>
  <li><a href="zend.search.lucene.extending.html">Erweiterbarkeit</a></li>
  <li><a href="zend.search.lucene.java-lucene.html">Zusammenarbeit Mit Java Lucene</a></li>
  <li><a href="zend.search.lucene.advanced.html">Erweitert</a></li>
  <li class="active"><a href="zend.search.lucene.best-practice.html">Die besten Anwendungen</a></li>
 </ul>
 </td>
    </tr>
</table>
</body>
</html>